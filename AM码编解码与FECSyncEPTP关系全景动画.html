<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMç ã€FECã€SyncEã€PTPå…³ç³»åŠ¨ç”»æ¼”ç¤º</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: #fff;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .controls {
            text-align: center;
            margin-bottom: 30px;
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 30px;
            font-size: 16px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .main-diagram {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            margin-bottom: 30px;
        }

        .pipeline {
            display: flex;
            flex-direction: column;
            gap: 40px;
        }

        .direction-label {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .direction-arrow {
            font-size: 36px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .stage {
            display: flex;
            align-items: center;
            gap: 20px;
            position: relative;
        }

        .stage-box {
            flex: 1;
            background: rgba(255, 255, 255, 0.15);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            padding: 25px;
            position: relative;
            transition: all 0.3s;
            min-height: 180px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .stage-box.active {
            background: rgba(255, 215, 0, 0.3);
            border-color: #ffd700;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
            transform: scale(1.05);
        }

        .stage-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #ffd700;
            text-align: center;
        }

        .stage-content {
            font-size: 14px;
            line-height: 1.6;
            color: #fff;
        }

        .stage-content ul {
            list-style: none;
            padding-left: 0;
        }

        .stage-content li {
            padding: 5px 0;
            padding-left: 20px;
            position: relative;
        }

        .stage-content li:before {
            content: "â–¸";
            position: absolute;
            left: 0;
            color: #4facfe;
        }

        .arrow {
            font-size: 48px;
            color: #4facfe;
            animation: slideRight 2s infinite;
            flex-shrink: 0;
        }

        .arrow-up {
            font-size: 48px;
            color: #4facfe;
            animation: slideUp 2s infinite;
            flex-shrink: 0;
        }

        @keyframes slideRight {
            0%, 100% { transform: translateX(0); opacity: 0.5; }
            50% { transform: translateX(10px); opacity: 1; }
        }

        @keyframes slideUp {
            0%, 100% { transform: translateY(0); opacity: 0.5; }
            50% { transform: translateY(-10px); opacity: 1; }
        }

        .data-packet {
            position: absolute;
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.8);
            z-index: 100;
            display: none;
        }

        .data-packet.moving {
            display: block;
            animation: movePacket 4s linear;
        }

        @keyframes movePacket {
            0% { left: 0; }
            100% { left: calc(100% - 30px); }
        }

        .highlight-box {
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            border: 3px solid transparent;
            border-radius: 18px;
            pointer-events: none;
        }

        .highlight-box.synce {
            border-color: #f5576c;
            animation: glow-synce 2s infinite;
        }

        .highlight-box.ptp {
            border-color: #00f2fe;
            animation: glow-ptp 2s infinite;
        }

        .highlight-box.fec {
            border-color: #f093fb;
            animation: glow-fec 2s infinite;
        }

        .highlight-box.am {
            border-color: #ffd700;
            animation: glow-am 2s infinite;
        }

        @keyframes glow-synce {
            0%, 100% { box-shadow: 0 0 5px #f5576c; }
            50% { box-shadow: 0 0 20px #f5576c, 0 0 30px #f5576c; }
        }

        @keyframes glow-ptp {
            0%, 100% { box-shadow: 0 0 5px #00f2fe; }
            50% { box-shadow: 0 0 20px #00f2fe, 0 0 30px #00f2fe; }
        }

        @keyframes glow-fec {
            0%, 100% { box-shadow: 0 0 5px #f093fb; }
            50% { box-shadow: 0 0 20px #f093fb, 0 0 30px #f093fb; }
        }

        @keyframes glow-am {
            0%, 100% { box-shadow: 0 0 5px #ffd700; }
            50% { box-shadow: 0 0 20px #ffd700, 0 0 30px #ffd700; }
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            margin-top: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .legend-color {
            width: 30px;
            height: 30px;
            border-radius: 5px;
            border: 2px solid white;
        }

        .legend-color.synce { background: #f5576c; }
        .legend-color.ptp { background: #00f2fe; }
        .legend-color.fec { background: #f093fb; }
        .legend-color.am { background: #ffd700; }

        .info-panel {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            margin-top: 30px;
        }

        .info-title {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #ffd700;
        }

        .info-content {
            font-size: 16px;
            line-height: 1.8;
            display: none;
        }

        .info-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: left;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .comparison-table th {
            background: rgba(255, 215, 0, 0.3);
            font-weight: bold;
        }

        .comparison-table tr:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .layer-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.6);
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }

        .layer-phy { background: rgba(255, 87, 108, 0.8); }
        .layer-link { background: rgba(0, 242, 254, 0.8); }
        .layer-mac { background: rgba(240, 147, 251, 0.8); }

        .vertical-flow {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin: 30px 0;
        }

        .vertical-arrow {
            font-size: 36px;
            color: #4facfe;
            animation: slideDown 2s infinite;
        }

        @keyframes slideDown {
            0%, 100% { transform: translateY(0); opacity: 0.5; }
            50% { transform: translateY(10px); opacity: 1; }
        }

        .highlight-note {
            background: rgba(255, 215, 0, 0.2);
            border-left: 4px solid #ffd700;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            font-size: 14px;
        }

        @media (max-width: 1200px) {
            .stage {
                flex-direction: column;
            }
            
            .arrow {
                transform: rotate(90deg);
            }
        }

        .timeline {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 20px 0;
            padding: 0 20px;
            position: relative;
        }

        .timeline::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        }

        .timeline-point {
            width: 20px;
            height: 20px;
            background: #667eea;
            border-radius: 50%;
            border: 3px solid white;
            position: relative;
            z-index: 1;
            cursor: pointer;
            transition: all 0.3s;
        }

        .timeline-point:hover {
            transform: scale(1.3);
            background: #ffd700;
        }

        .timeline-point.active {
            background: #ffd700;
            box-shadow: 0 0 20px #ffd700;
        }

        .code-block {
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            margin: 10px 0;
            overflow-x: auto;
        }

        .emphasis {
            color: #ffd700;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”„ AMç ç¼–è§£ç ä¸FEC/SyncE/PTPå…³ç³»å…¨æ™¯åŠ¨ç”»</h1>
        
        <div class="controls">
            <button class="btn btn-primary" onclick="startAnimation('full')">â–¶ï¸ å®Œæ•´æµç¨‹</button>
            <button class="btn btn-secondary" onclick="highlightModule('synce')">ğŸ”´ SyncEæå–</button>
            <button class="btn btn-secondary" onclick="highlightModule('ptp')">ğŸ”µ PTPæ‰“æˆ³</button>
            <button class="btn btn-secondary" onclick="highlightModule('fec')">ğŸŸ£ FECå¤„ç†</button>
            <button class="btn btn-secondary" onclick="highlightModule('am')">ğŸŸ¡ AMå¤„ç†</button>
            <button class="btn btn-success" onclick="resetAnimation()">ğŸ”„ é‡ç½®</button>
        </div>

        <div class="main-diagram">
            <!-- å‘é€ç«¯ -->
            <div class="pipeline">
                <div class="direction-label">
                    <span>ğŸ“¤ å‘é€ç«¯ï¼ˆTXï¼‰</span>
                    <span class="direction-arrow">â†’</span>
                </div>

                <!-- MACå±‚ -->
                <div class="stage">
                    <div class="stage-box" id="tx-mac">
                        <div class="layer-indicator layer-mac">Layer 2 - MAC</div>
                        <div class="stage-title">MACå±‚</div>
                        <div class="stage-content">
                            <ul>
                                <li>æ¥æ”¶ä»¥å¤ªç½‘å¸§</li>
                                <li>æ·»åŠ å‰å¯¼ç (Preamble)</li>
                                <li>æ·»åŠ SFDæ ‡è®°</li>
                                <li><span class="emphasis">PTP TXæ—¶é—´æˆ³ç‚¹</span></li>
                            </ul>
                            <div class="code-block">
                                Packet: [Preamble][SFD][Data]<br>
                                PTP: è®°å½•å‘é€æ—¶åˆ» t_tx
                            </div>
                        </div>
                    </div>
                    <div class="arrow">â†’</div>
                    <div class="stage-box" id="tx-pcs">
                        <div class="layer-indicator layer-link">Layer 1 - PCS</div>
                        <div class="stage-title">PCSç¼–ç å±‚</div>
                        <div class="stage-content">
                            <ul>
                                <li>64B/66Bç¼–ç </li>
                                <li><span class="emphasis">æ’å…¥AMç (æ¯16k Block)</span></li>
                                <li>ç”Ÿæˆ66bit Blockæµ</li>
                                <li>æ•°æ®åŠ æ‰°(Scrambling)</li>
                            </ul>
                            <div class="code-block">
                                AM Pattern: 0x90_76_47_C5<br>
                                æ’å…¥é¢‘ç‡: æ¯200Î¼sä¸€æ¬¡
                            </div>
                        </div>
                    </div>
                </div>

                <div class="vertical-arrow">â†“</div>

                <!-- FECå±‚ -->
                <div class="stage">
                    <div class="stage-box" id="tx-fec">
                        <div class="layer-indicator layer-link">Layer 1 - FEC</div>
                        <div class="stage-title">FECç¼–ç </div>
                        <div class="stage-content">
                            <ul>
                                <li>RS(544,514) å‰å‘çº é”™</li>
                                <li>æ·»åŠ 30ä¸ªæ ¡éªŒç¬¦å·</li>
                                <li><span class="emphasis">AMç é€ä¼ (ä¸ç¼–ç )</span></li>
                                <li>å¢å¼ºæŠ—å¹²æ‰°èƒ½åŠ›</li>
                            </ul>
                            <div class="highlight-note">
                                âš ï¸ å…³é”®ï¼šAMç ä¸å‚ä¸FECç¼–ç ï¼<br>
                                ä¿æŒAM patternä¸å˜ï¼Œç”¨äºæ¥æ”¶ç«¯å¯¹é½
                            </div>
                        </div>
                    </div>
                    <div class="arrow">â†’</div>
                    <div class="stage-box" id="tx-pma">
                        <div class="layer-indicator layer-phy">Layer 1 - PMA</div>
                        <div class="stage-title">PMAæ˜ å°„</div>
                        <div class="stage-content">
                            <ul>
                                <li>åˆ†é…åˆ°å¤šä¸ªLane</li>
                                <li>Bitäº¤ç»‡(Bit Muxing)</li>
                                <li>Lane 0,1,2,3...</li>
                                <li>å¹¶è¡Œä¼ è¾“å‡†å¤‡</li>
                            </ul>
                            <div class="code-block">
                                Lane 0: Block 0,4,8...<br>
                                Lane 1: Block 1,5,9...<br>
                                ...
                            </div>
                        </div>
                    </div>
                </div>

                <div class="vertical-arrow">â†“</div>

                <!-- SerDeså‘é€ -->
                <div class="stage">
                    <div class="stage-box" id="tx-serdes">
                        <div class="layer-indicator layer-phy">Layer 1 - PHY</div>
                        <div class="stage-title">SerDes TX</div>
                        <div class="stage-content">
                            <ul>
                                <li>å¹¶ä¸²è½¬æ¢(PISO)</li>
                                <li><span class="emphasis">æ—¶é’Ÿä¿¡å·åµŒå…¥æ•°æ®</span></li>
                                <li>PAM4/NRZè°ƒåˆ¶</li>
                                <li>ç”µä¿¡å· â†’ å…‰ä¿¡å·</li>
                            </ul>
                            <div class="highlight-note">
                                âš¡ SyncEæºå¤´ï¼šç²¾ç¡®æ—¶é’Ÿç¼–ç åˆ°bit transition
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ä¼ è¾“ä»‹è´¨ -->
            <div style="text-align: center; margin: 40px 0;">
                <div style="background: linear-gradient(90deg, #667eea 0%, #764ba2 50%, #667eea 100%); height: 4px; border-radius: 2px; position: relative;">
                    <div class="data-packet" id="flying-packet"></div>
                </div>
                <div style="margin-top: 15px; font-size: 20px; font-weight: bold; color: #ffd700;">
                    ğŸ“¡ å…‰çº¤/é“œç¼†ä¼ è¾“ ğŸ“¡
                </div>
            </div>

            <!-- æ¥æ”¶ç«¯ -->
            <div class="pipeline">
                <div class="direction-label">
                    <span>ğŸ“¥ æ¥æ”¶ç«¯ï¼ˆRXï¼‰</span>
                    <span class="direction-arrow">â†</span>
                </div>

                <!-- SerDesæ¥æ”¶ -->
                <div class="stage">
                    <div class="stage-box" id="rx-serdes">
                        <div class="layer-indicator layer-phy">Layer 1 - PHY</div>
                        <div class="stage-title">SerDes RX</div>
                        <div class="stage-content">
                            <ul>
                                <li>å…‰ä¿¡å· â†’ ç”µä¿¡å·</li>
                                <li><span class="emphasis">CDRæ—¶é’Ÿæ¢å¤</span></li>
                                <li>ä¸²å¹¶è½¬æ¢(SIPO)</li>
                                <li>å„Laneç‹¬ç«‹æ¥æ”¶</li>
                            </ul>
                            <div class="highlight-note">
                                ğŸ”´ <span class="emphasis">SyncEæå–ç‚¹ï¼</span><br>
                                ä»CDR PLLè¾“å‡ºæå–recovered_clock<br>
                                ä½ç½®ï¼š<strong>AMå¯¹é½ä¹‹å‰</strong>
                            </div>
                        </div>
                    </div>
                    <div class="arrow">â†’</div>
                    <div class="stage-box" id="rx-pma">
                        <div class="layer-indicator layer-phy">Layer 1 - PMA</div>
                        <div class="stage-title">PMAè§£æ˜ å°„</div>
                        <div class="stage-content">
                            <ul>
                                <li>Bitå»äº¤ç»‡</li>
                                <li><span class="emphasis">æ£€æµ‹AMç ä½ç½®</span></li>
                                <li>æµ‹é‡Laneé—´skew</li>
                                <li>å‡†å¤‡Deskew FIFO</li>
                            </ul>
                            <div class="code-block">
                                æ£€æµ‹: 0x90_76_47_C5<br>
                                Lane 0 AMä½ç½®: offset_0<br>
                                Lane 1 AMä½ç½®: offset_1<br>
                                Skew = |offset_1 - offset_0|
                            </div>
                        </div>
                    </div>
                </div>

                <div class="vertical-arrow">â†“</div>

                <!-- Deskew -->
                <div class="stage">
                    <div class="stage-box" id="rx-deskew">
                        <div class="layer-indicator layer-link">Layer 1 - Deskew</div>
                        <div class="stage-title">AM Deskewå¯¹é½</div>
                        <div class="stage-content">
                            <ul>
                                <li><span class="emphasis">åŸºäºAMç å¯¹é½å„Lane</span></li>
                                <li>FIFOæ·±åº¦åŠ¨æ€è°ƒæ•´</li>
                                <li>è¡¥å¿ä¼ è¾“å»¶è¿Ÿå·®å¼‚</li>
                                <li>è¾“å‡ºåŒæ­¥çš„Blockæµ</li>
                            </ul>
                            <div class="code-block">
                                Lane 0 FIFO: delay = 0<br>
                                Lane 1 FIFO: delay = 5ns<br>
                                Lane 2 FIFO: delay = 3ns<br>
                                ...<br>
                                â†’ æ‰€æœ‰Lane AMå¯¹é½
                            </div>
                        </div>
                    </div>
                    <div class="arrow">â†’</div>
                    <div class="stage-box" id="rx-fec">
                        <div class="layer-indicator layer-link">Layer 1 - FEC</div>
                        <div class="stage-title">FECè§£ç </div>
                        <div class="stage-content">
                            <ul>
                                <li>RS(544,514)çº é”™</li>
                                <li>æ£€æµ‹å¹¶ä¿®å¤é”™è¯¯</li>
                                <li><span class="emphasis">ç§»é™¤AMç </span></li>
                                <li>è¾“å‡ºçº¯å‡€æ•°æ®</li>
                            </ul>
                            <div class="highlight-note">
                                AMç ä½œç”¨å·²å®Œæˆï¼Œæ­¤å¤„ç§»é™¤
                            </div>
                        </div>
                    </div>
                </div>

                <div class="vertical-arrow">â†“</div>

                <!-- PCSè§£ç  -->
                <div class="stage">
                    <div class="stage-box" id="rx-pcs">
                        <div class="layer-indicator layer-link">Layer 1 - PCS</div>
                        <div class="stage-title">PCSè§£ç å±‚</div>
                        <div class="stage-content">
                            <ul>
                                <li>64B/66Bè§£ç </li>
                                <li>è§£æ‰°(Descrambling)</li>
                                <li>æ¢å¤ä»¥å¤ªç½‘å¸§</li>
                                <li>Blockæµ â†’ Byteæµ</li>
                            </ul>
                        </div>
                    </div>
                    <div class="arrow">â†’</div>
                    <div class="stage-box" id="rx-mac">
                        <div class="layer-indicator layer-mac">Layer 2 - MAC</div>
                        <div class="stage-title">MACå±‚</div>
                        <div class="stage-content">
                            <ul>
                                <li>æ£€æµ‹SFD</li>
                                <li><span class="emphasis">PTP RXæ—¶é—´æˆ³ç‚¹</span></li>
                                <li>CRCæ ¡éªŒ</li>
                                <li>ä¸Šä¼ ä»¥å¤ªç½‘å¸§</li>
                            </ul>
                            <div class="code-block">
                                PTP: è®°å½•æ¥æ”¶æ—¶åˆ» t_rx<br>
                                ä½ç½®: <strong>AMå¯¹é½ä¹‹å</strong>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- å›¾ä¾‹ -->
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color synce"></div>
                <span>SyncEæ—¶é’Ÿæå–ï¼ˆAMå¯¹é½å‰ï¼‰</span>
            </div>
            <div class="legend-item">
                <div class="legend-color ptp"></div>
                <span>PTPæ—¶é—´æˆ³ï¼ˆAMå¯¹é½åï¼‰</span>
            </div>
            <div class="legend-item">
                <div class="legend-color fec"></div>
                <span>FECç¼–è§£ç </span>
            </div>
            <div class="legend-item">
                <div class="legend-color am"></div>
                <span>AMç å¤„ç†</span>
            </div>
        </div>

        <!-- è¯¦ç»†ä¿¡æ¯é¢æ¿ -->
        <div class="info-panel">
            <div class="info-title">ğŸ“‹ è¯¦ç»†è¯´æ˜</div>
            
            <div class="info-content" id="info-synce">
                <h3>ğŸ”´ SyncEæ—¶é’Ÿæå–</h3>
                <p><strong>æå–ä½ç½®ï¼š</strong>SerDes RXçš„CDRè¾“å‡ºï¼ˆAM Deskewä¹‹å‰ï¼‰</p>
                <p><strong>æå–å†…å®¹ï¼š</strong>è¿ç»­çš„ç‰©ç†å±‚æ—¶é’Ÿä¿¡å·ï¼ˆrecovered_clockï¼‰</p>
                <p><strong>å…³é”®ç‰¹ç‚¹ï¼š</strong></p>
                <ul>
                    <li>âœ… ç›´æ¥ä»CDRçš„PLLè¾“å‡º</li>
                    <li>âœ… ä¿ç•™äº†å‘é€ç«¯æ—¶é’Ÿçš„é¢‘ç‡ä¿¡æ¯</li>
                    <li>âœ… æŠ–åŠ¨å°ï¼ˆ~10ps RMSï¼‰</li>
                    <li>âœ… ç²¾åº¦é«˜ï¼ˆÂ±16 ppb Option 1ï¼‰</li>
                    <li>âœ… ä¸å—AMå¯¹é½å½±å“</li>
                </ul>
                <p><strong>ä¸ºä»€ä¹ˆå¿…é¡»åœ¨AMå¯¹é½å‰ï¼Ÿ</strong></p>
                <ul>
                    <li>AMå¯¹é½åçš„ä¿¡å·ç»è¿‡FIFOç¼“å†²ï¼Œå¼•å…¥äº†é‡åŒ–å™ªå£°å’Œæ·±åº¦æ³¢åŠ¨</li>
                    <li>FIFOæ·±åº¦å˜åŒ–ä¼šå¯¼è‡´ç­‰æ•ˆçš„æ—¶é’Ÿé¢‘ç‡æŠ–åŠ¨</li>
                    <li>CDRç›´æ¥æå–ä¿è¯äº†æ—¶é’Ÿçš„çº¯å‡€æ€§</li>
                </ul>
                <table class="comparison-table">
                    <tr>
                        <th>ç‰¹æ€§</th>
                        <th>AMå¯¹é½å‰ï¼ˆCDRï¼‰</th>
                        <th>AMå¯¹é½åï¼ˆç†è®ºï¼‰</th>
                    </tr>
                    <tr>
                        <td>æŠ–åŠ¨</td>
                        <td>8-20 ps</td>
                        <td>50-150 ps âŒ</td>
                    </tr>
                    <tr>
                        <td>é¢‘ç‡ç¨³å®šåº¦</td>
                        <td>Â±3 ppb</td>
                        <td>Â±50 ppb âŒ</td>
                    </tr>
                    <tr>
                        <td>ç¬¦åˆG.8262</td>
                        <td>âœ… å®Œå…¨ç¬¦åˆ</td>
                        <td>âŒ ä¸ç¬¦åˆ</td>
                    </tr>
                </table>
            </div>

            <div class="info-content" id="info-ptp">
                <h3>ğŸ”µ PTP (IEEE 1588) æ—¶é—´æˆ³</h3>
                <p><strong>æ‰“æˆ³ä½ç½®ï¼š</strong>MACå±‚ï¼Œæ£€æµ‹åˆ°SFDæ—¶ï¼ˆAM Deskewä¹‹åï¼‰</p>
                <p><strong>æµ‹é‡å†…å®¹ï¼š</strong>æ•°æ®åŒ…åˆ°è¾¾/å‘é€çš„ç²¾ç¡®æ—¶é—´</p>
                <p><strong>å…³é”®ç‰¹ç‚¹ï¼š</strong></p>
                <ul>
                    <li>âœ… åœ¨æ•°æ®æµç¨³å®šå¯¹é½åæ‰“æˆ³</li>
                    <li>âœ… æ‰€æœ‰Laneå·²å®ŒæˆDeskew</li>
                    <li>âœ… æ¶ˆé™¤äº†Laneé—´ä¼ è¾“å»¶è¿Ÿå·®å¼‚</li>
                    <li>âœ… æ—¶é—´æˆ³å‡†ç¡®æ€§é«˜ï¼ˆÂ±1-2nsï¼‰</li>
                    <li>âœ… åæ˜ çœŸå®çš„æ•°æ®åŒ…æ—¶é—´</li>
                </ul>
                <p><strong>ä¸ºä»€ä¹ˆå¿…é¡»åœ¨AMå¯¹é½åï¼Ÿ</strong></p>
                <ul>
                    <li>å¦‚æœåœ¨å¯¹é½å‰æ‰“æˆ³ï¼Œä¸åŒLaneçš„skewä¼šå¼•å…¥è¯¯å·®ï¼ˆå¯è¾¾æ•°ånsï¼‰</li>
                    <li>AM Deskewæ¶ˆé™¤äº†å„Laneçš„ä¼ è¾“å»¶è¿Ÿå·®å¼‚</li>
                    <li>å¯¹é½åçš„æ•°æ®æµæ˜¯çœŸæ­£çš„"æ•°æ®åŒ…æ—¶é—´"</li>
                </ul>
                <div class="code-block">
                    TXæ—¶é—´æˆ³ï¼šæ£€æµ‹SFD â†’ è®°å½• t_tx<br>
                    RXæ—¶é—´æˆ³ï¼šæ£€æµ‹SFD â†’ è®°å½• t_rx<br>
                    ä¼ è¾“å»¶è¿Ÿï¼šdelay = (t_rx - t_tx) - è·¯å¾„å»¶è¿Ÿè¡¥å¿
                </div>
            </div>

            <div class="info-content" id="info-fec">
                <h3>ğŸŸ£ FEC (Forward Error Correction) å‰å‘çº é”™</h3>
                <p><strong>ç¼–ç ä½ç½®ï¼š</strong>å‘é€ç«¯PCSä¹‹å</p>
                <p><strong>è§£ç ä½ç½®ï¼š</strong>æ¥æ”¶ç«¯AM Deskewä¹‹å</p>
                <p><strong>ç¼–ç æ–¹æ¡ˆï¼š</strong>RS(544,514) Reed-Solomonç ï¼ˆ400Gï¼‰</p>
                <p><strong>ä¸AMç çš„å…³ç³»ï¼š</strong></p>
                <ul>
                    <li>âš ï¸ <strong>AMç ä¸å‚ä¸FECç¼–ç ï¼</strong></li>
                    <li>AMç åœ¨FECç¼–ç å‰å·²æ’å…¥ï¼Œä¿æŒpatternä¸å˜</li>
                    <li>FECä»…å¯¹æ•°æ®Blockè¿›è¡Œç¼–ç ï¼ŒAMç é€ä¼ </li>
                    <li>æ¥æ”¶ç«¯å…ˆç”¨AMç å¯¹é½ï¼Œå†è¿›è¡ŒFECè§£ç </li>
                </ul>
                <p><strong>å¤„ç†æµç¨‹ï¼š</strong></p>
                <div class="code-block">
                    å‘é€ç«¯ï¼š<br>
                    [Data Blocks] â†’ PCSç¼–ç  â†’ æ’å…¥AM â†’ <strong>FECç¼–ç (è·³è¿‡AM)</strong> â†’ è¾“å‡º<br>
                    <br>
                    æ¥æ”¶ç«¯ï¼š<br>
                    è¾“å…¥ â†’ æ£€æµ‹AM â†’ Deskewå¯¹é½ â†’ <strong>FECè§£ç </strong> â†’ ç§»é™¤AM â†’ PCSè§£ç 
                </div>
                <p><strong>ä¸ºä»€ä¹ˆAMç ä¸å‚ä¸FECï¼Ÿ</strong></p>
                <ul>
                    <li>AMç å¿…é¡»ä¿æŒå›ºå®špattern (0x90_76_47_C5)ï¼Œç”¨äºå¿«é€Ÿæ£€æµ‹</li>
                    <li>å¦‚æœFECç¼–ç AMï¼Œpatternä¼šæ”¹å˜ï¼Œæ— æ³•è¯†åˆ«</li>
                    <li>AMç çš„ä½œç”¨æ˜¯ç‰©ç†å±‚å¯¹é½ï¼Œåœ¨FECä¹‹å‰å°±éœ€è¦ä½¿ç”¨</li>
                </ul>
            </div>

            <div class="info-content" id="info-am">
                <h3>ğŸŸ¡ AM (Alignment Marker) å¯¹é½æ ‡è®°</h3>
                <p><strong>æ’å…¥ä½ç½®ï¼š</strong>å‘é€ç«¯PCSç¼–ç å±‚</p>
                <p><strong>æ£€æµ‹ä½ç½®ï¼š</strong>æ¥æ”¶ç«¯PMAè§£æ˜ å°„å±‚</p>
                <p><strong>å¯¹é½ä½ç½®ï¼š</strong>æ¥æ”¶ç«¯Deskew FIFO</p>
                <p><strong>AMç ç»“æ„ï¼ˆ400GBASE-Rï¼‰ï¼š</strong></p>
                <div class="code-block">
                    AM Pattern:<br>
                    Byte 0: 0x90 (å›ºå®š)<br>
                    Byte 1: 0x76 (å›ºå®š)<br>
                    Byte 2: 0x47 (å›ºå®šï¼Œç”¨äºè¯¯ç æ£€æµ‹)<br>
                    Byte 3: 0xC5 (å›ºå®šï¼Œç”¨äºè¯¯ç æ£€æµ‹)<br>
                    Byte 4-19: Laneç¼–å· (æ¯ä¸ªLaneä¸åŒ)<br>
                    <br>
                    æ’å…¥é¢‘ç‡: æ¯16,384ä¸ª66b Blockä¸€æ¬¡ (çº¦200Î¼s)
                </div>
                <p><strong>AMç çš„ä½œç”¨ï¼š</strong></p>
                <ul>
                    <li>ğŸ¯ <strong>Laneå¯¹é½ï¼š</strong>æµ‹é‡å„Lane AMåˆ°è¾¾æ—¶é—´å·®ï¼ˆskewï¼‰</li>
                    <li>ğŸ“ <strong>Deskewï¼š</strong>é€šè¿‡FIFOè¡¥å¿å»¶è¿Ÿï¼Œä½¿æ‰€æœ‰Laneçš„AMåŒæ—¶åˆ°è¾¾</li>
                    <li>ğŸ” <strong>Laneè¯†åˆ«ï¼š</strong>æ¯ä¸ªLaneçš„AMåŒ…å«å”¯ä¸€ç¼–å·</li>
                    <li>ğŸ›¡ï¸ <strong>è¯¯ç æ£€æµ‹ï¼š</strong>é€šè¿‡å›ºå®špatternæ£€æµ‹ä¼ è¾“é”™è¯¯</li>
                </ul>
                <p><strong>Deskewè¿‡ç¨‹ï¼š</strong></p>
                <div class="code-block">
                    1. æ£€æµ‹å„Lane AMåˆ°è¾¾æ—¶é—´:<br>
                       Lane 0: t0 = 100.000 ns<br>
                       Lane 1: t1 = 100.005 ns (æ™š5ns)<br>
                       Lane 2: t2 = 99.998 ns  (æ—©2ns)<br>
                    <br>
                    2. è®¡ç®—FIFOå»¶è¿Ÿ:<br>
                       Lane 0: delay = 0<br>
                       Lane 1: delay = 5 ns (è¡¥å¿æ™šåˆ°)<br>
                       Lane 2: delay = -2 ns (ç­‰å¾…å…¶ä»–Lane)<br>
                    <br>
                    3. å¯¹é½åæ‰€æœ‰Lane AMåŒæ—¶è¾“å‡º:<br>
                       æ‰€æœ‰Lane: t = 100.005 ns (ç»Ÿä¸€)
                </div>
                <p><strong>ä¸å…¶ä»–åŠŸèƒ½çš„å…³ç³»ï¼š</strong></p>
                <table class="comparison-table">
                    <tr>
                        <th>åŠŸèƒ½</th>
                        <th>ä¸AMçš„å…³ç³»</th>
                        <th>æ—¶åº</th>
                    </tr>
                    <tr>
                        <td>SyncE</td>
                        <td>æ— å…³ï¼ˆAMå¯¹é½å‰æå–ï¼‰</td>
                        <td>AMæ£€æµ‹ä¹‹å‰</td>
                    </tr>
                    <tr>
                        <td>PTP</td>
                        <td>ä¾èµ–ï¼ˆéœ€AMå¯¹é½åæ‰“æˆ³ï¼‰</td>
                        <td>AMå¯¹é½ä¹‹å</td>
                    </tr>
                    <tr>
                        <td>FEC</td>
                        <td>é€ä¼ ï¼ˆAMä¸å‚ä¸ç¼–ç ï¼‰</td>
                        <td>AMå¯¹é½åè§£ç </td>
                    </tr>
                </table>
            </div>

            <div class="info-content" id="info-full">
                <h3>ğŸ”„ å®Œæ•´æ•°æ®æµç¨‹æ€»è§ˆ</h3>
                <p><strong>å‘é€ç«¯æµç¨‹ï¼š</strong></p>
                <ol>
                    <li><strong>MACå±‚ï¼š</strong>ä»¥å¤ªç½‘å¸§ + Preamble + SFD â†’ <span class="emphasis">PTP TXæ—¶é—´æˆ³</span></li>
                    <li><strong>PCSç¼–ç ï¼š</strong>64B/66Bç¼–ç  â†’ <span class="emphasis">æ’å…¥AMç </span> â†’ Scrambling</li>
                    <li><strong>FECç¼–ç ï¼š</strong>RS(544,514)çº é”™ç¼–ç ï¼ˆAMç é€ä¼ ï¼‰</li>
                    <li><strong>PMAï¼š</strong>åˆ†é…åˆ°å¤šä¸ªLaneï¼ŒBit Muxing</li>
                    <li><strong>SerDes TXï¼š</strong>å¹¶ä¸²è½¬æ¢ â†’ <span class="emphasis">æ—¶é’ŸåµŒå…¥ä¿¡å·</span> â†’ PAM4è°ƒåˆ¶ â†’ å…‰ä¿¡å·</li>
                </ol>
                <p><strong>ä¼ è¾“ï¼š</strong>å…‰çº¤/é“œç¼†</p>
                <p><strong>æ¥æ”¶ç«¯æµç¨‹ï¼š</strong></p>
                <ol>
                    <li><strong>SerDes RXï¼š</strong>å…‰ä¿¡å· â†’ ç”µä¿¡å· â†’ <span class="emphasis">CDRæ¢å¤æ—¶é’Ÿ (SyncEæå–ç‚¹)</span> â†’ ä¸²å¹¶è½¬æ¢</li>
                    <li><strong>PMAï¼š</strong><span class="emphasis">æ£€æµ‹AMç </span> â†’ æµ‹é‡Lane skew â†’ Bit Demuxing</li>
                    <li><strong>Deskewï¼š</strong><span class="emphasis">åŸºäºAMå¯¹é½å„Lane</span> â†’ FIFOè¡¥å¿å»¶è¿Ÿ</li>
                    <li><strong>FECè§£ç ï¼š</strong>RS(544,514)çº é”™ â†’ ç§»é™¤AMç </li>
                    <li><strong>PCSè§£ç ï¼š</strong>Descrambling â†’ 64B/66Bè§£ç </li>
                    <li><strong>MACå±‚ï¼š</strong>æ£€æµ‹SFD â†’ <span class="emphasis">PTP RXæ—¶é—´æˆ³</span> â†’ CRCæ ¡éªŒ</li>
                </ol>
                <div class="highlight-note">
                    <strong>å…³é”®æ—¶åºå…³ç³»ï¼š</strong><br>
                    1ï¸âƒ£ SyncEæå– < AMæ£€æµ‹ < AMå¯¹é½ < FECè§£ç  < PTPæ‰“æˆ³<br>
                    2ï¸âƒ£ SyncEå’ŒAMå¯¹é½ç›¸äº’ç‹¬ç«‹<br>
                    3ï¸âƒ£ PTPå¿…é¡»åœ¨AMå¯¹é½åï¼Œæ¶ˆé™¤Lane skew<br>
                    4ï¸âƒ£ FECå¯¹AMç é€ä¼ ï¼Œä¸æ”¹å˜pattern
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentHighlight = null;

        function startAnimation(type) {
            resetAnimation();
            
            // å¯åŠ¨æ•°æ®åŒ…åŠ¨ç”»
            const packet = document.getElementById('flying-packet');
            packet.classList.add('moving');
            
            // æŒ‰é¡ºåºæ¿€æ´»å„ä¸ªé˜¶æ®µ
            const stages = [
                'tx-mac', 'tx-pcs', 'tx-fec', 'tx-pma', 'tx-serdes',
                'rx-serdes', 'rx-pma', 'rx-deskew', 'rx-fec', 'rx-pcs', 'rx-mac'
            ];
            
            stages.forEach((id, index) => {
                setTimeout(() => {
                    document.getElementById(id).classList.add('active');
                    setTimeout(() => {
                        document.getElementById(id).classList.remove('active');
                    }, 500);
                }, index * 400);
            });

            // æ˜¾ç¤ºå®Œæ•´æµç¨‹è¯´æ˜
            setTimeout(() => {
                showInfo('full');
            }, stages.length * 400);
        }

        function highlightModule(module) {
            resetAnimation();
            currentHighlight = module;

            // ç§»é™¤æ‰€æœ‰é«˜äº®
            document.querySelectorAll('.highlight-box').forEach(box => box.remove());

            let stageIds = [];
            
            switch(module) {
                case 'synce':
                    stageIds = ['rx-serdes'];
                    addHighlight('rx-serdes', 'synce');
                    showInfo('synce');
                    break;
                case 'ptp':
                    stageIds = ['tx-mac', 'rx-mac'];
                    addHighlight('tx-mac', 'ptp');
                    addHighlight('rx-mac', 'ptp');
                    showInfo('ptp');
                    break;
                case 'fec':
                    stageIds = ['tx-fec', 'rx-fec'];
                    addHighlight('tx-fec', 'fec');
                    addHighlight('rx-fec', 'fec');
                    showInfo('fec');
                    break;
                case 'am':
                    stageIds = ['tx-pcs', 'rx-pma', 'rx-deskew'];
                    addHighlight('tx-pcs', 'am');
                    addHighlight('rx-pma', 'am');
                    addHighlight('rx-deskew', 'am');
                    showInfo('am');
                    break;
            }

            // æ¿€æ´»ç›¸å…³é˜¶æ®µ
            stageIds.forEach((id, index) => {
                setTimeout(() => {
                    document.getElementById(id).classList.add('active');
                }, index * 300);
            });
        }

        function addHighlight(stageId, type) {
            const stage = document.getElementById(stageId);
            const highlight = document.createElement('div');
            highlight.className = `highlight-box ${type}`;
            stage.appendChild(highlight);
        }

        function showInfo(type) {
            // éšè—æ‰€æœ‰ä¿¡æ¯
            document.querySelectorAll('.info-content').forEach(info => {
                info.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„ä¿¡æ¯
            const targetInfo = document.getElementById(`info-${type}`);
            if (targetInfo) {
                targetInfo.classList.add('active');
            }
        }

        function resetAnimation() {
            // ç§»é™¤æ‰€æœ‰æ¿€æ´»çŠ¶æ€
            document.querySelectorAll('.stage-box').forEach(box => {
                box.classList.remove('active');
            });

            // ç§»é™¤æ‰€æœ‰é«˜äº®æ¡†
            document.querySelectorAll('.highlight-box').forEach(box => {
                box.remove();
            });

            // é‡ç½®æ•°æ®åŒ…
            const packet = document.getElementById('flying-packet');
            packet.classList.remove('moving');

            // éšè—æ‰€æœ‰ä¿¡æ¯
            document.querySelectorAll('.info-content').forEach(info => {
                info.classList.remove('active');
            });

            currentHighlight = null;
        }

        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºå®Œæ•´æµç¨‹è¯´æ˜
        window.addEventListener('load', () => {
            showInfo('full');
        });
    </script>
</body>
</html>