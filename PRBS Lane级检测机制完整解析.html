<!DOCTYPE html>  
<html lang="zh-CN">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>PRBS Laneçº§æ£€æµ‹æœºåˆ¶è¯¦è§£</title>  
    <style>  
        * {  
            margin: 0;  
            padding: 0;  
            box-sizing: border-box;  
        }  

        body {  
            font-family: 'Segoe UI', 'Microsoft YaHei', Arial, sans-serif;  
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);  
            padding: 20px;  
            color: #fff;  
            min-height: 100vh;  
        }  

        .container {  
            max-width: 1600px;  
            margin: 0 auto;  
        }  

        h1 {  
            text-align: center;  
            margin-bottom: 30px;  
            font-size: 2.8em;  
            text-shadow: 3px 3px 6px rgba(0,0,0,0.5);  
            background: linear-gradient(135deg, #ffd700 0%, #ff6347 100%);  
            -webkit-background-clip: text;  
            -webkit-text-fill-color: transparent;  
            background-clip: text;  
        }  

        .main-section {  
            background: rgba(255, 255, 255, 0.08);  
            border-radius: 20px;  
            padding: 35px;  
            margin: 25px 0;  
            backdrop-filter: blur(10px);  
            border: 2px solid rgba(255, 215, 0, 0.3);  
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);  
        }  

        .section-title {  
            font-size: 28px;  
            color: #ffd700;  
            margin-bottom: 25px;  
            padding-bottom: 15px;  
            border-bottom: 3px solid #ffd700;  
            font-weight: bold;  
        }  

        .code-block {  
            background: rgba(0, 0, 0, 0.6);  
            padding: 20px;  
            border-radius: 10px;  
            font-family: 'Courier New', monospace;  
            font-size: 13px;  
            margin: 20px 0;  
            line-height: 1.9;  
            border-left: 5px solid #4facfe;  
            white-space: pre-wrap;  
            word-wrap: break-word;  
            overflow-x: auto;  
        }  

        .highlight {  
            color: #ffd700;  
            font-weight: bold;  
        }  

        .emphasis {  
            color: #ff0080;  
            font-weight: bold;  
        }  

        .good {  
            color: #44ff44;  
            font-weight: bold;  
        }  

        .bad {  
            color: #ff4444;  
            font-weight: bold;  
        }  

        .lane-diagram {  
            display: grid;  
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));  
            gap: 20px;  
            margin: 25px 0;  
        }  

        .lane-box {  
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.3) 0%, rgba(118, 75, 162, 0.3) 100%);  
            border: 3px solid #667eea;  
            border-radius: 15px;  
            padding: 20px;  
            transition: all 0.3s;  
            cursor: pointer;  
        }  

        .lane-box:hover {  
            transform: translateY(-5px);  
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.6);  
            border-color: #ffd700;  
        }  

        .lane-title {  
            font-size: 20px;  
            font-weight: bold;  
            color: #ffd700;  
            margin-bottom: 15px;  
            text-align: center;  
        }  

        .lane-content {  
            font-size: 13px;  
            line-height: 1.8;  
            color: #ccc;  
        }  

        .comparison-table {  
            width: 100%;  
            border-collapse: collapse;  
            margin: 25px 0;  
            background: rgba(0, 0, 0, 0.4);  
            border-radius: 10px;  
            overflow: hidden;  
        }  

        .comparison-table th,  
        .comparison-table td {  
            padding: 18px;  
            text-align: left;  
            border: 1px solid rgba(255, 255, 255, 0.2);  
        }  

        .comparison-table th {  
            background: rgba(255, 0, 128, 0.4);  
            font-weight: bold;  
            color: #ffd700;  
            font-size: 16px;  
        }  

        .comparison-table tr:hover {  
            background: rgba(255, 255, 255, 0.15);  
        }  

        .state-machine {  
            background: rgba(0, 0, 0, 0.5);  
            padding: 25px;  
            border-radius: 15px;  
            margin: 25px 0;  
            border: 2px solid #4facfe;  
        }  

        .state {  
            background: rgba(255, 255, 255, 0.1);  
            border: 3px solid #667eea;  
            border-radius: 12px;  
            padding: 20px;  
            margin: 20px 0;  
            position: relative;  
            transition: all 0.3s;  
        }  

        .state:hover {  
            background: rgba(255, 255, 255, 0.2);  
            transform: translateX(5px);  
        }  

        .state-name {  
            font-size: 20px;  
            font-weight: bold;  
            color: #ffd700;  
            margin-bottom: 12px;  
        }  

        .state-desc {  
            color: #ccc;  
            line-height: 1.8;  
            font-size: 14px;  
        }  

        .arrow-down {  
            text-align: center;  
            font-size: 32px;  
            color: #4facfe;  
            margin: 10px 0;  
            animation: bounce 2s infinite;  
        }  

        @keyframes bounce {  
            0%, 100% { transform: translateY(0); }  
            50% { transform: translateY(10px); }  
        }  

        .info-box {  
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2) 0%, rgba(255, 140, 0, 0.2) 100%);  
            border: 2px solid #ffd700;  
            border-radius: 12px;  
            padding: 20px;  
            margin: 20px 0;  
        }  

        .info-box-title {  
            font-size: 20px;  
            font-weight: bold;  
            color: #ffd700;  
            margin-bottom: 12px;  
            display: flex;  
            align-items: center;  
        }  

        .info-box-title:before {  
            content: 'ğŸ’¡';  
            font-size: 24px;  
            margin-right: 10px;  
        }  

        .warning-box {  
            background: linear-gradient(135deg, rgba(255, 0, 0, 0.2) 0%, rgba(255, 69, 0, 0.2) 100%);  
            border: 2px solid #ff4444;  
            border-radius: 12px;  
            padding: 20px;  
            margin: 20px 0;  
        }  

        .warning-box-title {  
            font-size: 20px;  
            font-weight: bold;  
            color: #ff4444;  
            margin-bottom: 12px;  
            display: flex;  
            align-items: center;  
        }  

        .warning-box-title:before {  
            content: 'âš ï¸';  
            font-size: 24px;  
            margin-right: 10px;  
        }  

        .timeline {  
            position: relative;  
            padding-left: 40px;  
            margin: 30px 0;  
        }  

        .timeline:before {  
            content: '';  
            position: absolute;  
            left: 10px;  
            top: 0;  
            bottom: 0;  
            width: 4px;  
            background: linear-gradient(to bottom, #4facfe 0%, #00f2fe 100%);  
        }  

        .timeline-item {  
            position: relative;  
            margin-bottom: 30px;  
            padding-left: 30px;  
        }  

        .timeline-item:before {  
            content: '';  
            position: absolute;  
            left: -26px;  
            top: 5px;  
            width: 16px;  
            height: 16px;  
            border-radius: 50%;  
            background: #ffd700;  
            border: 3px solid #1a1a2e;  
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.8);  
        }  

        .timeline-content {  
            background: rgba(255, 255, 255, 0.1);  
            padding: 18px;  
            border-radius: 10px;  
            border-left: 4px solid #4facfe;  
        }  

        .timeline-title {  
            font-size: 18px;  
            font-weight: bold;  
            color: #ffd700;  
            margin-bottom: 10px;  
        }  

        .bit-pattern {  
            font-family: 'Courier New', monospace;  
            background: rgba(0, 0, 0, 0.8);  
            padding: 15px;  
            border-radius: 8px;  
            margin: 15px 0;  
            font-size: 14px;  
            border: 2px solid #ff0080;  
            overflow-x: auto;  
        }  

        .bit-group {  
            display: inline-block;  
            margin: 0 8px;  
            padding: 5px 10px;  
            background: rgba(255, 0, 128, 0.3);  
            border-radius: 5px;  
        }  

        .tabs {  
            display: flex;  
            gap: 15px;  
            margin-bottom: 25px;  
            flex-wrap: wrap;  
            justify-content: center;  
        }  

        .tab-btn {  
            padding: 14px 28px;  
            background: rgba(255, 255, 255, 0.15);  
            border: 2px solid rgba(255, 255, 255, 0.3);  
            border-radius: 10px;  
            color: #fff;  
            cursor: pointer;  
            transition: all 0.3s;  
            font-size: 16px;  
            font-weight: bold;  
        }  

        .tab-btn:hover {  
            background: rgba(255, 215, 0, 0.3);  
            border-color: #ffd700;  
            transform: translateY(-2px);  
        }  

        .tab-btn.active {  
            background: linear-gradient(135deg, #ff0080 0%, #ff6347 100%);  
            border-color: #ffd700;  
            box-shadow: 0 5px 20px rgba(255, 0, 128, 0.5);  
        }  

        .tab-content {  
            display: none;  
        }  

        .tab-content.active {  
            display: block;  
            animation: fadeIn 0.5s;  
        }  

        @keyframes fadeIn {  
            from { opacity: 0; transform: translateY(20px); }  
            to { opacity: 1; transform: translateY(0); }  
        }  

        .status-indicator {  
            display: inline-block;  
            width: 14px;  
            height: 14px;  
            border-radius: 50%;  
            margin-right: 10px;  
            animation: pulse 2s infinite;  
        }  

        .status-indicator.ok {  
            background: #44ff44;  
            box-shadow: 0 0 15px #44ff44;  
        }  

        .status-indicator.error {  
            background: #ff4444;  
            box-shadow: 0 0 15px #ff4444;  
        }  

        .status-indicator.warning {  
            background: #ffaa00;  
            box-shadow: 0 0 15px #ffaa00;  
        }  

        @keyframes pulse {  
            0%, 100% { opacity: 1; }  
            50% { opacity: 0.5; }  
        }  

        .visual-block {  
            background: rgba(0, 0, 0, 0.6);  
            border: 2px solid #4facfe;  
            border-radius: 10px;  
            padding: 20px;  
            margin: 20px 0;  
        }  

        .visual-title {  
            font-size: 18px;  
            color: #4facfe;  
            font-weight: bold;  
            margin-bottom: 15px;  
            text-align: center;  
        }  

        @media (max-width: 768px) {  
            h1 {  
                font-size: 2em;  
            }  
            .lane-diagram {  
                grid-template-columns: 1fr;  
            }  
        }  
    </style>  
</head>  
<body>  
    <div class="container">  
        <h1>ğŸ”¬ PRBS Laneçº§æ£€æµ‹æœºåˆ¶å®Œæ•´è§£æ</h1>  

        <!-- æ ‡ç­¾å¯¼èˆª -->  
        <div class="tabs">  
            <button class="tab-btn active" onclick="switchTab('question1')">â“ é—®é¢˜1: Laneçº§æ£€æµ‹</button>  
            <button class="tab-btn" onclick="switchTab('question2')">ğŸ” é—®é¢˜2: è¯†åˆ«PRBS</button>  
            <button class="tab-btn" onclick="switchTab('question3')">ğŸ“ é—®é¢˜3: èµ·å§‹ä½ç½®</button>  
            <button class="tab-btn" onclick="switchTab('question4')">ğŸ­ é—®é¢˜4: ä¸åŒç å‹</button>  
        </div>  

        <!-- é—®é¢˜1: PRBSæ˜¯æŒ‰Laneæ£€æµ‹çš„å—? -->  
        <div id="question1" class="tab-content active">  
            <div class="main-section">  
                <div class="section-title">â“ é—®é¢˜1: PRBSæ˜¯æŒ‰Laneé€šé“æ£€æµ‹çš„å—ï¼Ÿ</div>  
                
                <div class="info-box">  
                    <div class="info-box-title">æ ¸å¿ƒç­”æ¡ˆ</div>  
                    <div class="code-block">  
<span class="highlight">âœ… æ˜¯çš„ï¼PRBSæ˜¯æŒ‰æ¯ä¸ªLaneç‹¬ç«‹æ£€æµ‹çš„ï¼</span>  

SerDesæ¶æ„ï¼š  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
<span class="emphasis">æ¯ä¸ªç‰©ç†Laneéƒ½æœ‰ç‹¬ç«‹çš„PRBS Generatorå’ŒCheckerï¼</span>  

100Gä»¥å¤ªç½‘ç¤ºä¾‹ï¼ˆä½¿ç”¨4Ã—25G Laneï¼‰ï¼š  
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  
â”‚  Lane 0: <span class="good">ç‹¬ç«‹çš„PRBS31 Generator â†’ Checker</span>         â”‚  
â”‚  Lane 1: <span class="good">ç‹¬ç«‹çš„PRBS31 Generator â†’ Checker</span>         â”‚  
â”‚  Lane 2: <span class="good">ç‹¬ç«‹çš„PRBS31 Generator â†’ Checker</span>         â”‚  
â”‚  Lane 3: <span class="good">ç‹¬ç«‹çš„PRBS31 Generator â†’ Checker</span>         â”‚  
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  

æ¯ä¸ªLaneæœ‰è‡ªå·±çš„ï¼š  
â€¢ PRBS Generatorï¼ˆå‘é€ç«¯ï¼‰  
â€¢ PRBS Checkerï¼ˆæ¥æ”¶ç«¯ï¼‰  
â€¢ é”™è¯¯è®¡æ•°å™¨  
â€¢ LockçŠ¶æ€  
â€¢ BERç»Ÿè®¡  
                    </div>  
                </div>  

                <div class="section-title" style="margin-top: 40px;">ğŸ—ï¸ Laneçº§æ¶æ„è¯¦è§£</div>  
                
                <div class="lane-diagram">  
                    <div class="lane-box">  
                        <div class="lane-title"><span class="status-indicator ok"></span>Lane 0</div>  
                        <div class="lane-content">  
                            <div class="code-block">  
<span class="highlight">TXç«¯ï¼š</span>  
PRBS_GEN[0]  
â”œâ”€ Seed: 0xFFFFFFFF  
â”œâ”€ Type: PRBS31  
â””â”€ Output â†’ SerDes TX[0]  

<span class="highlight">RXç«¯ï¼š</span>  
SerDes RX[0] â†’ PRBS_CHK[0]  
â”œâ”€ Lock: <span class="good">LOCKED</span>  
â”œâ”€ Error Count: 93  
â”œâ”€ Total Bits: 9.28e13  
â””â”€ BER: <span class="good">1.0e-12</span>  
                            </div>  
                        </div>  
                    </div>  

                    <div class="lane-box">  
                        <div class="lane-title"><span class="status-indicator ok"></span>Lane 1</div>  
                        <div class="lane-content">  
                            <div class="code-block">  
<span class="highlight">TXç«¯ï¼š</span>  
PRBS_GEN[1]  
â”œâ”€ Seed: 0xFFFFFFFF  
â”œâ”€ Type: PRBS31  
â””â”€ Output â†’ SerDes TX[1]  

<span class="highlight">RXç«¯ï¼š</span>  
SerDes RX[1] â†’ PRBS_CHK[1]  
â”œâ”€ Lock: <span class="good">LOCKED</span>  
â”œâ”€ Error Count: 87  
â”œâ”€ Total Bits: 9.28e13  
â””â”€ BER: <span class="good">9.4e-13</span>  
                            </div>  
                        </div>  
                    </div>  

                    <div class="lane-box">  
                        <div class="lane-title"><span class="status-indicator warning"></span>Lane 2</div>  
                        <div class="lane-content">  
                            <div class="code-block">  
<span class="highlight">TXç«¯ï¼š</span>  
PRBS_GEN[2]  
â”œâ”€ Seed: 0xFFFFFFFF  
â”œâ”€ Type: PRBS31  
â””â”€ Output â†’ SerDes TX[2]  

<span class="highlight">RXç«¯ï¼š</span>  
SerDes RX[2] â†’ PRBS_CHK[2]  
â”œâ”€ Lock: <span class="good">LOCKED</span>  
â”œâ”€ Error Count: 234  
â”œâ”€ Total Bits: 9.28e13  
â””â”€ BER: <span class="warning-box">2.5e-12</span>  
<span class="emphasis">âš ï¸ æ­¤Lane BERç¨é«˜</span>  
                            </div>  
                        </div>  
                    </div>  

                    <div class="lane-box">  
                        <div class="lane-title"><span class="status-indicator error"></span>Lane 3</div>  
                        <div class="lane-content">  
                            <div class="code-block">  
<span class="highlight">TXç«¯ï¼š</span>  
PRBS_GEN[3]  
â”œâ”€ Seed: 0xFFFFFFFF  
â”œâ”€ Type: PRBS31  
â””â”€ Output â†’ SerDes TX[3]  

<span class="highlight">RXç«¯ï¼š</span>  
SerDes RX[3] â†’ PRBS_CHK[3]  
â”œâ”€ Lock: <span class="bad">UNLOCKED</span>  
â”œâ”€ Error Count: N/A  
â”œâ”€ Total Bits: N/A  
â””â”€ BER: <span class="bad">FAIL</span>  
<span class="bad">âŒ æ­¤Laneæ— æ³•åŒæ­¥</span>  
                            </div>  
                        </div>  
                    </div>  
                </div>  

                <div class="warning-box">  
                    <div class="warning-box-title">ä¸ºä»€ä¹ˆè¦æŒ‰Laneç‹¬ç«‹æ£€æµ‹ï¼Ÿ</div>  
                    <div class="code-block">  
åŸå› 1ï¼š<span class="highlight">ç‰©ç†éš”ç¦»</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
â€¢ æ¯ä¸ªLaneæ˜¯ç‹¬ç«‹çš„ç‰©ç†é€šé“ï¼ˆç‹¬ç«‹çš„SerDesï¼‰  
â€¢ æ¯ä¸ªLaneæœ‰ç‹¬ç«‹çš„å…‰çº¤/é“œç¼†  
â€¢ ä¸åŒLaneçš„ä¿¡å·è´¨é‡å¯èƒ½ä¸åŒ  

ç¤ºä¾‹ï¼š  
Lane 0: å…‰çº¤Aï¼Œè¡°å‡3dBï¼Œ<span class="good">BER=1e-12</span>  
Lane 1: å…‰çº¤Bï¼Œè¡°å‡3.5dBï¼Œ<span class="good">BER=1.5e-12</span>  
Lane 2: å…‰çº¤Cï¼Œè¡°å‡5dBï¼Œ<span class="bad">BER=1e-9</span> â† é—®é¢˜Laneï¼  
Lane 3: å…‰çº¤Dï¼Œè¡°å‡3dBï¼Œ<span class="good">BER=1e-12</span>  

å¦‚æœåˆå¹¶æ£€æµ‹ï¼Œæ— æ³•å®šä½æ˜¯å“ªä¸ªLaneæœ‰é—®é¢˜ï¼  


åŸå› 2ï¼š<span class="highlight">æ•…éšœéš”ç¦»</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
ç‹¬ç«‹æ£€æµ‹å¯ä»¥ç²¾ç¡®å®šä½æ•…éšœLaneï¼š  
â€¢ Lane 2çš„BERå¼‚å¸¸ â†’ æ£€æŸ¥Lane 2çš„å…‰çº¤  
â€¢ Lane 3æ— æ³•Lock â†’ æ£€æŸ¥Lane 3çš„SerDes  
â€¢ å…¶ä»–Laneæ­£å¸¸ â†’ é—®é¢˜éš”ç¦»åœ¨å•Lane  


åŸå› 3ï¼š<span class="highlight">ç‹¬ç«‹è°ƒè¯•</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
æ¯ä¸ªLaneå¯ä»¥ç‹¬ç«‹è°ƒæ•´å‚æ•°ï¼š  
â€¢ Lane 0: TXé¢„åŠ é‡ = 3dB  
â€¢ Lane 1: TXé¢„åŠ é‡ = 4dB  â† éœ€è¦æ›´å¤šè¡¥å¿  
â€¢ Lane 2: RXå‡è¡¡ = High   â† ä¿¡é“æŸè€—å¤§  
â€¢ Lane 3: TXé¢„åŠ é‡ = 3dB  

ä¸åŒLaneçš„æœ€ä¼˜å‚æ•°å¯èƒ½ä¸åŒï¼  


åŸå› 4ï¼š<span class="highlight">ç»Ÿè®¡ç²¾åº¦</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
ç‹¬ç«‹ç»Ÿè®¡å¯ä»¥ï¼š  
â€¢ è¯†åˆ«å“ªä¸ªLaneæ˜¯"æœ€å·®Lane"  
â€¢ è¯„ä¼°Laneé—´çš„åå·®ï¼ˆSkewï¼‰  
â€¢ é¢„æµ‹å“ªä¸ªLaneå¯èƒ½å…ˆå¤±æ•ˆ  

ç³»ç»Ÿçº§å†³ç­–ï¼š  
if (worst_lane_BER > 1e-9) {  
    // å³ä½¿å…¶ä»–Laneæ­£å¸¸ï¼Œæ•´ä¸ªé“¾è·¯ä¹Ÿå¯èƒ½ä¸å¯é   
    return FAIL;  
}  
                    </div>  
                </div>  

                <div class="section-title" style="margin-top: 40px;">ğŸ“Š å¯„å­˜å™¨æ˜ å°„</div>  
                
                <table class="comparison-table">  
                    <tr>  
                        <th>å¯„å­˜å™¨</th>  
                        <th>åœ°å€èŒƒå›´</th>  
                        <th>è¯´æ˜</th>  
                    </tr>  
                    <tr>  
                        <td><strong>PRBS_CTRL[0]</strong></td>  
                        <td>0x1000</td>  
                        <td>Lane 0 PRBSæ§åˆ¶</td>  
                    </tr>  
                    <tr>  
                        <td><strong>PRBS_CTRL[1]</strong></td>  
                        <td>0x1100</td>  
                        <td>Lane 1 PRBSæ§åˆ¶</td>  
                    </tr>  
                    <tr>  
                        <td><strong>PRBS_CTRL[2]</strong></td>  
                        <td>0x1200</td>  
                        <td>Lane 2 PRBSæ§åˆ¶</td>  
                    </tr>  
                    <tr>  
                        <td><strong>PRBS_CTRL[3]</strong></td>  
                        <td>0x1300</td>  
                        <td>Lane 3 PRBSæ§åˆ¶</td>  
                    </tr>  
                    <tr>  
                        <td colspan="3" style="background: rgba(255,215,0,0.2); color: #ffd700; text-align: center;">  
                            æ¯ä¸ªLaneæœ‰ç‹¬ç«‹çš„å¯„å­˜å™¨ç»„ï¼ˆ256 bytes/Laneï¼‰  
                        </td>  
                    </tr>  
                    <tr>  
                        <td><strong>PRBS_STATUS[n]</strong></td>  
                        <td>0x1n04</td>  
                        <td>Lane nçš„LockçŠ¶æ€</td>  
                    </tr>  
                    <tr>  
                        <td><strong>PRBS_ERROR_CNT[n]</strong></td>  
                        <td>0x1n08</td>  
                        <td>Lane nçš„é”™è¯¯è®¡æ•°</td>  
                    </tr>  
                    <tr>  
                        <td><strong>PRBS_BER[n]</strong></td>  
                        <td>0x1n0C</td>  
                        <td>Lane nçš„å®æ—¶BER</td>  
                    </tr>  
                </table>  

                <div class="code-block">  
<span class="highlight">è¯»å–ç¤ºä¾‹ä»£ç ï¼š</span>  

// è¯»å–æ‰€æœ‰Laneçš„çŠ¶æ€  
for (int lane = 0; lane < 4; lane++) {  
    uint32_t base_addr = 0x1000 + (lane * 0x100);  
    
    uint32_t status = read_reg(base_addr + 0x04);  
    uint32_t error_cnt = read_reg(base_addr + 0x08);  
    uint32_t ber = read_reg(base_addr + 0x0C);  
    
    printf("Lane %d:\n", lane);  
    printf("  Lock: %s\n", (status & 0x01) ? "<span class="good">LOCKED</span>" : "<span class="bad">UNLOCKED</span>");  
    printf("  Error Count: %u\n", error_cnt);  
    printf("  BER: %.2e\n", ber * 1e-15);  
    
    if (!(status & 0x01)) {  
        printf("  <span class="bad">âš ï¸ Lane %d is NOT locked!</span>\n", lane);  
    }  
}  

// è®¡ç®—æ•´ä½“BERï¼ˆæ‰€æœ‰Laneçš„å¹³å‡ï¼‰  
double total_ber = 0;  
int locked_lanes = 0;  
for (int lane = 0; lane < 4; lane++) {  
    uint32_t status = read_reg(0x1000 + lane*0x100 + 0x04);  
    if (status & 0x01) {  
        uint32_t ber = read_reg(0x1000 + lane*0x100 + 0x0C);  
        total_ber += ber * 1e-15;  
        locked_lanes++;  
    }  
}  
if (locked_lanes > 0) {  
    double avg_ber = total_ber / locked_lanes;  
    printf("\n<span class="highlight">Average BER: %.2e</span>\n", avg_ber);  
}  
                </div>  
            </div>  
        </div>  

        <!-- é—®é¢˜2: å¦‚ä½•è¯†åˆ«PRBS -->  
        <div id="question2" class="tab-content">  
            <div class="main-section">  
                <div class="section-title">ğŸ” é—®é¢˜2: æ€ä¹ˆåˆ¤æ–­æ˜¯PRBSè€Œä¸æ˜¯å…¶ä»–æŠ¥æ–‡ï¼Ÿ</div>  
                
                <div class="info-box">  
                    <div class="info-box-title">æ ¸å¿ƒç­”æ¡ˆ</div>  
                    <div class="code-block">  
<span class="highlight">æ¥æ”¶ç«¯é€šè¿‡"æ•°å­¦ç‰¹å¾"è¯†åˆ«PRBSï¼Œä¸æ˜¯é€šè¿‡ç‰¹æ®Šæ ‡è®°ï¼</span>  

å…³é”®ç‚¹ï¼š  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
1. <span class="emphasis">PRBSæ˜¯ç¡®å®šæ€§ä¼ªéšæœºåºåˆ—</span>  
   â€¢ ç»™å®šå¤šé¡¹å¼å’Œç§å­ï¼Œåºåˆ—å®Œå…¨ç¡®å®š  
   â€¢ æ¥æ”¶ç«¯ç”¨ç›¸åŒå¤šé¡¹å¼ç”Ÿæˆæœ¬åœ°åºåˆ—  
   â€¢ é€bitæ¯”å¯¹æ¥æ”¶æ•°æ®å’Œæœ¬åœ°åºåˆ—  

2. <span class="emphasis">æ²¡æœ‰ç‰¹æ®Šçš„"PRBSå¤´"æˆ–"PRBSæ ‡è®°"</span>  
   â€¢ PRBSæµæ˜¯è¿ç»­çš„bitåºåˆ—  
   â€¢ çœ‹èµ·æ¥åƒéšæœºæ•°ï¼Œä½†å®é™…æ˜¯ç¡®å®šçš„  
   â€¢ æ¥æ”¶ç«¯é€šè¿‡"æœç´¢+åŒ¹é…"æ¥è¯†åˆ«  

3. <span class="emphasis">ä¸æ­£å¸¸æ•°æ®çš„åŒºåˆ«</span>  
   â€¢ æ­£å¸¸æ•°æ®ï¼šä»¥å¤ªç½‘å¸§ç»“æ„ï¼Œæœ‰Preambleã€Dest MACã€Payloadç­‰  
   â€¢ PRBSæ•°æ®ï¼šçº¯ç²¹çš„ä¼ªéšæœºbitæµï¼Œæ— ä»»ä½•åè®®ç»“æ„  
                    </div>  
                </div>  

                <div class="section-title" style="margin-top: 40px;">ğŸ” PRBSè¯†åˆ«è¿‡ç¨‹</div>  
                
                <div class="state-machine">  
                    <div class="state">  
                        <div class="state-name">æ­¥éª¤1: é…ç½®é˜¶æ®µ</div>  
                        <div class="state-desc">  
                            <div class="code-block">  
<span class="highlight">TXç«¯å’ŒRXç«¯å¿…é¡»é¢„å…ˆçº¦å®šï¼š</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
â€¢ PRBSç±»å‹ï¼ˆPRBS7/9/11/15/23/31ï¼‰  
â€¢ åˆå§‹ç§å­ï¼ˆé€šå¸¸0xFFFFFFFFï¼‰  
â€¢ æ˜¯å¦åç›¸ï¼ˆInvertï¼‰  

<span class="emphasis">æ²¡æœ‰è‡ªåŠ¨åå•†ï¼å¿…é¡»æ‰‹åŠ¨é…ç½®ä¸€è‡´ï¼</span>  

TXç«¯é…ç½®ï¼š  
write_reg(PRBS_TX_CTRL[lane], 0x51);  // PRBS31, Enable  

RXç«¯é…ç½®ï¼š  
write_reg(PRBS_RX_CTRL[lane], 0x51);  // PRBS31, Enable (å¿…é¡»åŒ¹é…!)  

å¦‚æœé…ç½®ä¸åŒ¹é…ï¼š  
TX: PRBS31  vs  RX: PRBS15  â†’  <span class="bad">æ°¸è¿œæ— æ³•Lock!</span>  
                            </div>  
                        </div>  
                    </div>  

                    <div class="arrow-down">â†“</div>  

                    <div class="state">  
                        <div class="state-name">æ­¥éª¤2: æ¥æ”¶æ•°æ®æµ</div>  
                        <div class="state-desc">  
                            <div class="code-block">  
RXç«¯æ¥æ”¶åˆ°è¿ç»­çš„bitæµï¼š  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
æ¥æ”¶æ•°æ®: 1011001110100111001011010110011101...  

<span class="highlight">é—®é¢˜ï¼šè¿™æ˜¯PRBS31å—ï¼Ÿè¿˜æ˜¯æ™®é€šæ•°æ®ï¼Ÿ</span>  

RXç«¯ä¸çŸ¥é“ï¼éœ€è¦é€šè¿‡"åŒæ­¥ç®—æ³•"æ¥åˆ¤æ–­ï¼  
                            </div>  
                        </div>  
                    </div>  

                    <div class="arrow-down">â†“</div>  

                    <div class="state">  
                        <div class="state-name">æ­¥éª¤3: ç”Ÿæˆæœ¬åœ°PRBS</div>  
                        <div class="state-desc">  
                            <div class="code-block">  
RXç«¯å¯åŠ¨æœ¬åœ°PRBS Generatorï¼ˆä¸TXç›¸åŒçš„å¤šé¡¹å¼ï¼‰ï¼š  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
PRBS31å¤šé¡¹å¼: xÂ³Â¹ + xÂ²â¸ + 1  

æœ¬åœ°ç”Ÿæˆ: 1011001110100111001011010110011101...  
          â†‘  
       ä»åˆå§‹ç§å­å¼€å§‹ç”Ÿæˆ  

<span class="emphasis">å…³é”®ï¼šæœ¬åœ°åºåˆ—æ˜¯ç¡®å®šçš„ï¼</span>  
ç»™å®šç§å­0xFFFFFFFFï¼ŒPRBS31çš„å‰Nä½æ€»æ˜¯å›ºå®šçš„ï¼  
                            </div>  
                        </div>  
                    </div>  

                    <div class="arrow-down">â†“</div>  

                    <div class="state">  
                        <div class="state-name">æ­¥éª¤4: ç›¸ä½æœç´¢ï¼ˆå…³é”®æ­¥éª¤ï¼‰</div>  
                        <div class="state-desc">  
                            <div class="code-block">  
<span class="highlight">é—®é¢˜ï¼šæ¥æ”¶æ•°æ®å¯èƒ½ä»PRBSåºåˆ—çš„ä»»æ„ä½ç½®å¼€å§‹ï¼</span>  

PRBS31å®Œæ•´åºåˆ—ï¼ˆ2Â³Â¹-1 = 2147483647 bitsï¼‰ï¼š  
ä½ç½®0:    1011001110100111...  â† ä»ç§å­å¼€å§‹  
ä½ç½®1:    0110011101001110...  â† åç§»1ä½  
ä½ç½®2:    1100111010011100...  â† åç§»2ä½  
...  
ä½ç½®N:    ???...                â† æ¥æ”¶æ•°æ®ä»è¿™é‡Œå¼€å§‹ï¼Ÿ  

<span class="emphasis">æœç´¢ç®—æ³•ï¼š</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
for (phase = 0; phase < PRBS_PERIOD; phase++) {  
    // å°è¯•ä¸åŒçš„èµ·å§‹ç›¸ä½  
    match_count = 0;  
    
    for (i = 0; i < LOCK_THRESHOLD; i++) {  
        // æ¯”å¯¹è¿ç»­Nä½ï¼ˆå¦‚127ä½ï¼‰  
        if (rx_bit[i] == prbs_local[phase + i]) {  
            match_count++;  
        }  
    }  
    
    if (match_count >= LOCK_THRESHOLD * 0.95) {  
        // æ‰¾åˆ°äº†ï¼è‡³å°‘95%åŒ¹é…  
        current_phase = phase;  
        state = LOCKED;  
        break;  
    }  
}  

<span class="highlight">ä¼˜åŒ–ï¼šå¿«é€Ÿæœç´¢ç®—æ³•</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
ä¸éœ€è¦éå†æ‰€æœ‰2Â³Â¹-1ä¸ªç›¸ä½ï¼  
ä½¿ç”¨LFSRçš„ç‰¹æ€§ï¼Œå¯ä»¥å¿«é€Ÿç§»ä½ï¼š  
â€¢ æ¯æ¬¡åªç§»åŠ¨1-2ä½  
â€¢ åˆ©ç”¨è‡ªç›¸å…³ç‰¹æ€§å¿«é€Ÿå¯¹é½  
â€¢ å…¸å‹Lockæ—¶é—´ï¼š< 100ms  
                            </div>  
                        </div>  
                    </div>  

                    <div class="arrow-down">â†“</div>  

                    <div class="state">  
                        <div class="state-name">æ­¥éª¤5: Lockç¡®è®¤</div>  
                        <div class="state-desc">  
                            <div class="code-block">  
<span class="highlight">æ‰¾åˆ°ç›¸ä½åï¼ŒæŒç»­éªŒè¯ï¼š</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
è¿ç»­æ¯”å¯¹Nä½ï¼ˆå¦‚1023ä½for PRBS31ï¼‰ï¼š  

æ¥æ”¶: 1011001110100111001011010110011101...  
æœ¬åœ°: 1011001110100111001011010110011101...  
åŒ¹é…: âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ ...  

if (è¿ç»­1023ä½åŒ¹é…) {  
    PRBS_LOCK = TRUE;  <span class="good">â† ç¡®è®¤æ˜¯PRBSï¼</span>  
    printf("PRBS Locked at phase %d\n", current_phase);  
}  

<span class="emphasis">æ­¤æ—¶å¯ä»¥ç¡®å®šï¼šæ¥æ”¶çš„æ˜¯PRBSï¼Œä¸æ˜¯æ™®é€šæ•°æ®ï¼</span>  
                            </div>  
                        </div>  
                    </div>  

                    <div class="arrow-down">â†“</div>  

                    <div class="state">  
                        <div class="state-name">æ­¥éª¤6: æŒç»­æ ¡éªŒ</div>  
                        <div class="state-desc">  
                            <div class="code-block">  
Lockåï¼ŒæŒç»­é€bitæ¯”å¯¹ï¼š  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
æ¯ä¸ªæ—¶é’Ÿå‘¨æœŸï¼š  
    rx_bit = get_rx_bit();  
    expected_bit = prbs_next();  // ç”Ÿæˆæœ¬åœ°ä¸‹ä¸€ä½  
    
    if (rx_bit != expected_bit) {  
        error_count++;  <span class="bad">â† æ£€æµ‹åˆ°é”™è¯¯</span>  
    }  
    total_count++;  
    
    ber = error_count / total_count;  

<span class="good">å¦‚æœBERå¾ˆä½ï¼ˆå¦‚1e-12ï¼‰ï¼Œè¯æ˜ç¡®å®æ˜¯PRBSï¼</span>  
<span class="bad">å¦‚æœBERå¾ˆé«˜ï¼ˆå¦‚0.5ï¼‰ï¼Œè¯´æ˜ä¸æ˜¯PRBSæˆ–é…ç½®é”™è¯¯ï¼</span>  
                            </div>  
                        </div>  
                    </div>  
                </div>  

                <div class="warning-box">  
                    <div class="warning-box-title">å¦‚æœæ¥æ”¶çš„ä¸æ˜¯PRBSä¼šæ€æ ·ï¼Ÿ</div>  
                    <div class="code-block">  
<span class="highlight">åœºæ™¯1ï¼šæ¥æ”¶çš„æ˜¯æ­£å¸¸ä»¥å¤ªç½‘å¸§</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
æ­£å¸¸å¸§ç»“æ„:  
[Preamble][Dest MAC][Src MAC][EtherType][Payload][FCS]  

æœ¬åœ°PRBS:  
1011001110100111001011010110011101...  

æ¯”å¯¹ç»“æœ:  
åŒ¹é…ç‡ â‰ˆ 50%ï¼ˆéšæœºåŒ¹é…ï¼‰<span class="bad">â† æ°¸è¿œæ— æ³•Lockï¼</span>  

RXçŠ¶æ€ï¼š  
â€¢ PRBS_LOCK = 0 (UNLOCKED)  
â€¢ æŒç»­æœç´¢ç›¸ä½ï¼Œä½†æ°¸è¿œæ‰¾ä¸åˆ°  
â€¢ BER â‰ˆ 0.5ï¼ˆå®Œå…¨éšæœºï¼‰  


<span class="highlight">åœºæ™¯2ï¼šTXå‘PRBSï¼Œä½†RXé…ç½®æˆPRBS15ï¼ˆç±»å‹ä¸åŒ¹é…ï¼‰</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
TXå‘é€: PRBS31åºåˆ—  
RXæœŸæœ›: PRBS15åºåˆ—  

æ¯”å¯¹ç»“æœ:  
å¶å°”ä¼šæœ‰çŸ­æš‚çš„"å‡Lock"ï¼Œä½†å¾ˆå¿«å¤±é”  
BER â‰ˆ 0.3-0.4 <span class="bad">â† éƒ¨åˆ†åŒ¹é…ï¼Œä½†ä¸ç¨³å®š</span>  

ç»“è®ºï¼š<span class="emphasis">å¿…é¡»TXå’ŒRXé…ç½®å®Œå…¨ä¸€è‡´æ‰èƒ½Lockï¼</span>  


<span class="highlight">åœºæ™¯3ï¼šTXå’ŒRXéƒ½é…ç½®PRBS31ï¼Œä½†ç§å­ä¸åŒ</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
TXç§å­: 0xFFFFFFFF  
RXç§å­: 0x12345678  

å½±å“ï¼š  
â€¢ åºåˆ—ç›¸åŒï¼Œåªæ˜¯èµ·å§‹ä½ç½®ä¸åŒ  
â€¢ <span class="good">å¯ä»¥Lockï¼</span>ï¼ˆé€šè¿‡ç›¸ä½æœç´¢ï¼‰  
â€¢ ä½†Lockæ—¶é—´å¯èƒ½ç¨é•¿  


<span class="highlight">åœºæ™¯4ï¼šé“¾è·¯ä¸­æ–­åé‡æ–°è¿æ¥</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
ä¸­æ–­å‰ï¼šPRBS Lockåœ¨ç›¸ä½1000  
ä¸­æ–­åï¼šæ¥æ”¶æ•°æ®ä»ç›¸ä½2000å¼€å§‹  

RXè¡Œä¸ºï¼š  
â€¢ æ£€æµ‹åˆ°Lockä¸¢å¤±ï¼ˆbitä¸åŒ¹é…ï¼‰  
â€¢ é‡æ–°è¿›å…¥æœç´¢çŠ¶æ€  
â€¢ æ‰¾åˆ°æ–°ç›¸ä½2000  
â€¢ <span class="good">é‡æ–°Lock</span>  

å…¸å‹é‡Lockæ—¶é—´ï¼š10-100ms  
                    </div>  
                </div>  

                <div class="visual-block">  
                    <div class="visual-title">ğŸ¯ PRBSè¯†åˆ«çš„æœ¬è´¨</div>  
                    <div class="code-block">  
<span class="highlight">PRBSè¯†åˆ« = æ¨¡å¼åŒ¹é…ç®—æ³•</span>  

ç±»æ¯”ï¼šDNAåºåˆ—åŒ¹é…  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
å·²çŸ¥åºåˆ—ï¼ˆæ¨¡æ¿ï¼‰: ATCG ATCG ATCG ATCG...  
æœªçŸ¥åºåˆ—ï¼ˆæ ·æœ¬ï¼‰: ???? ???? ???? ????...  

åŒ¹é…è¿‡ç¨‹ï¼š  
1. å°è¯•å¯¹é½  
2. é€ä½æ¯”å¯¹  
3. è®¡ç®—åŒ¹é…åº¦  
4. å¦‚æœåŒ¹é…åº¦>95% â†’ ç¡®è®¤æ˜¯è¯¥DNA  

PRBSè¯†åˆ«å®Œå…¨ç›¸åŒï¼  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
å·²çŸ¥åºåˆ—ï¼ˆPRBS31ï¼‰: 1011 0011 1010 0111...  
æ¥æ”¶åºåˆ—:            ???? ???? ???? ????...  

1. å°è¯•ä¸åŒç›¸ä½å¯¹é½  
2. é€bitæ¯”å¯¹  
3. è®¡ç®—åŒ¹é…ç‡  
4. å¦‚æœè¿ç»­1023ä½åŒ¹é… â†’ <span class="good">ç¡®è®¤æ˜¯PRBS31ï¼</span>  

<span class="emphasis">æ²¡æœ‰ä»»ä½•"é­”æ³•"æˆ–ç‰¹æ®Šæ ‡è®°ï¼Œçº¯ç²¹æ˜¯æ•°å­¦åŒ¹é…ï¼</span>  
                    </div>  
                </div>  
            </div>  
        </div>  

        <!-- é—®é¢˜3: èµ·å§‹ä½ç½®åˆ¤æ–­ -->  
        <div id="question3" class="tab-content">  
            <div class="main-section">  
                <div class="section-title">ğŸ“ é—®é¢˜3: æ€ä¹ˆåˆ¤æ–­PRBSç æµçš„èµ·å§‹ä½ç½®ä¸ä¼šé”™æ¼ï¼Ÿ</div>  
                
                <div class="info-box">  
                    <div class="info-box-title">æ ¸å¿ƒç­”æ¡ˆ</div>  
                    <div class="code-block">  
<span class="highlight">PRBSæ²¡æœ‰ç»å¯¹çš„"èµ·å§‹ä½ç½®"æ¦‚å¿µï¼</span>  
<span class="emphasis">PRBSæ˜¯å¾ªç¯åºåˆ—ï¼Œä»»ä½•ä½ç½®éƒ½å¯ä»¥ä½œä¸ºèµ·å§‹ç‚¹ï¼</span>  

å…³é”®ç†è§£ï¼š  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
1. <span class="good">PRBSåºåˆ—æ˜¯å¾ªç¯çš„</span>  
   â€¢ PRBS31å‘¨æœŸ = 2Â³Â¹-1 bits  
   â€¢ åºåˆ—ç»“å°¾è¿æ¥åˆ°åºåˆ—å¼€å¤´ï¼Œæ— ç¼å¾ªç¯  
   â€¢ æ²¡æœ‰"ç¬¬ä¸€ä½"æˆ–"æœ€åä¸€ä½"çš„æ¦‚å¿µ  

2. <span class="good">RXä¸éœ€è¦çŸ¥é“"èµ·å§‹ä½ç½®"</span>  
   â€¢ RXåªéœ€è¦æ‰¾åˆ°ä»»æ„ä¸€ä¸ªåŒ¹é…ç‚¹ï¼ˆç›¸ä½ï¼‰  
   â€¢ ä¸€æ—¦Lockï¼ŒæŒç»­è·Ÿè¸ªå³å¯  
   â€¢ ç›¸ä½åç§»ä¸å½±å“è¯¯ç æ£€æµ‹  

3. <span class="good">"é”™æ¼"ä¸ä¼šå‘ç”Ÿ</span>  
   â€¢ å› ä¸ºæ²¡æœ‰ç»å¯¹èµ·å§‹ç‚¹ï¼Œæ‰€ä»¥ä¸å­˜åœ¨"é”™è¿‡"  
   â€¢ åªè¦èƒ½Lockï¼Œå°±èƒ½æ­£ç¡®æ£€æµ‹è¯¯ç   
                    </div>  
                </div>  

<div class="section-title" style="margin-top: 40px;">ğŸ”„ PRBSå¾ªç¯ç‰¹æ€§</div>  
                
<div class="visual-block">  
    <div class="visual-title">PRBS31åºåˆ—çš„å¾ªç¯ç»“æ„</div>  
    <div class="code-block" style="white-space: pre-wrap; word-wrap: break-word; overflow-wrap: break-word;">
<span class="highlight">PRBS31å‘¨æœŸ = 2,147,483,647 bitsï¼ˆçº¦2.15G bitsï¼‰</span>  

é€»è¾‘ç»“æ„ï¼ˆç®€åŒ–è¡¨ç¤ºï¼‰ï¼š  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  
                    â”‚                             â”‚  
                    â†“                             â”‚  
ä½ç½®0: <span class="bit-group">101100111010</span>...<span class="bit-group">011010110</span>â”€â”€â”        â”‚  
       â†“                             â”‚        â”‚  
ä½ç½®1000: <span class="bit-group">011101001</span>...<span class="bit-group">110100111</span>  â”‚        â”‚  
          â†“                          â”‚        â”‚  
ä½ç½®10000: <span class="bit-group">110010011</span>...<span class="bit-group">010110011</span> â”‚        â”‚  
           â†“                         â”‚        â”‚  
    ...   ...   ...   ...   ...     â”‚        â”‚  
           â†“                         â”‚        â”‚  
ä½ç½®2147483646: <span class="bit-group">011010110</span> â”€â”€â”€â”€â”€â”˜        â”‚  
                                              â”‚  
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  
                           å¾ªç¯è¿æ¥  

<span class="emphasis">å…³é”®ç‚¹ï¼š</span>  
â€¢ ä»»ä½•ä½ç½®éƒ½å¯ä»¥ä½œä¸º"èµ·å§‹ç‚¹"  
â€¢ ä»ä»»ä½•ä½ç½®å¼€å§‹ï¼Œç»è¿‡2Â³Â¹-1 bitsåå›åˆ°åŸç‚¹  
â€¢ RXåªéœ€è¦æ‰¾åˆ°æŸä¸ªä½ç½®å¹¶Lockå³å¯  


<span class="highlight">ä¾‹å­ï¼šä¸‰ä¸ªä¸åŒçš„"èµ·å§‹ç‚¹"</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
TX1ä»ä½ç½®0å¼€å§‹:    <span class="bit-group">1011001110</span><span class="bit-group">1001110010</span><span class="bit-group">1101011001</span>...  
TX2ä»ä½ç½®100å¼€å§‹:  <span class="bit-group">0111010011</span><span class="bit-group">1010011100</span><span class="bit-group">1011001110</span>...  
TX3ä»ä½ç½®5000å¼€å§‹: <span class="bit-group">1100100111</span><span class="bit-group">0101100111</span><span class="bit-group">0100111001</span>...  

<span class="good">ä¸‰ä¸ªå‘é€ç«¯å‘é€çš„éƒ½æ˜¯PRBS31ï¼Œåªæ˜¯ç›¸ä½ä¸åŒï¼</span>  
<span class="good">æ¥æ”¶ç«¯éƒ½èƒ½Lockï¼Œåªæ˜¯Lockåˆ°ä¸åŒçš„ç›¸ä½ï¼</span>  
    </div>  
</div>

                <div class="section-title" style="margin-top: 40px;">ğŸ¯ ç›¸ä½Lockæœºåˆ¶</div>  
                
                <div class="timeline">  
                    <div class="timeline-item">  
                        <div class="timeline-content">  
                            <div class="timeline-title">T0: åˆå§‹çŠ¶æ€</div>  
                            <div class="code-block">  
RXçŠ¶æ€ï¼šUNLOCKED  
æœ¬åœ°PRBSï¼šä»ç›¸ä½0å¼€å§‹ç”Ÿæˆ  

æ¥æ”¶æ•°æ®: ??? ??? ??? ???...  
æœ¬åœ°PRBS: <span class="bit-group">101 100 111 010</span>...  

åŒ¹é…åº¦ï¼šæœªçŸ¥  
                            </div>  
                        </div>  
                    </div>  

                    <div class="timeline-item">  
                        <div class="timeline-content">  
                            <div class="timeline-title">T1: å¼€å§‹æœç´¢</div>  
                            <div class="code-block">  
<span class="highlight">å°è¯•ç›¸ä½0ï¼š</span>  
æ¥æ”¶: <span class="bit-group">011 101 001 110</span>  
æœ¬åœ°: <span class="bit-group">101 100 111 010</span>  
åŒ¹é…: <span class="bad">âœ— âœ— âœ“ âœ—</span>  â†’ åŒ¹é…ç‡25%ï¼Œç»§ç»­æœç´¢  

<span class="highlight">å°è¯•ç›¸ä½1ï¼š</span>  
æ¥æ”¶: <span class="bit-group">011 101 001 110</span>  
æœ¬åœ°: <span class="bit-group">011 001 110 100</span> ï¼ˆç§»ä½1 bitï¼‰  
åŒ¹é…: <span class="bad">âœ“ âœ— âœ— âœ—</span>  â†’ åŒ¹é…ç‡25%ï¼Œç»§ç»­æœç´¢  

<span class="highlight">å°è¯•ç›¸ä½2ï¼š</span>  
æ¥æ”¶: <span class="bit-group">011 101 001 110</span>  
æœ¬åœ°: <span class="bit-group">110 011 101 001</span> ï¼ˆç§»ä½2 bitsï¼‰  
åŒ¹é…: <span class="bad">âœ— âœ— âœ— âœ—</span>  â†’ åŒ¹é…ç‡0%ï¼Œç»§ç»­æœç´¢  

...æŒç»­æœç´¢...  
                            </div>  
                        </div>  
                    </div>  

                    <div class="timeline-item">  
                        <div class="timeline-content">  
                            <div class="timeline-title">T2: æ‰¾åˆ°åŒ¹é…ç›¸ä½</div>  
                            <div class="code-block">  
<span class="highlight">å°è¯•ç›¸ä½5000ï¼š</span>  
æ¥æ”¶: <span class="bit-group">011 101 001 110 100 111 001 011 010 110 011 101</span>  
æœ¬åœ°: <span class="bit-group">011 101 001 110 100 111 001 011 010 110 011 101</span>  
åŒ¹é…: <span class="good">âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“ âœ“</span>  

åŒ¹é…ç‡ï¼š100%ï¼<span class="good">â† æ‰¾åˆ°äº†ï¼</span>  

current_phase = 5000;  
state = LOCKED;  
                            </div>  
                        </div>  
                    </div>  

                    <div class="timeline-item">  
                        <div class="timeline-content">  
                            <div class="timeline-title">T3: ç»´æŒLock</div>  
                            <div class="code-block">  
<span class="good">Lockåˆ°ç›¸ä½5000åï¼š</span>  

RXæŒç»­è·Ÿè¸ªï¼š  
â€¢ æœ¬åœ°PRBSä¿æŒåœ¨ç›¸ä½5000  
â€¢ æ¯æ¥æ”¶1 bitï¼Œæœ¬åœ°ä¹Ÿå‰è¿›1 bit  
â€¢ é€bitæ¯”å¯¹ï¼Œç»Ÿè®¡é”™è¯¯  

æ—¶åˆ»T3:  
æ¥æ”¶bit[5000]: 0  
æœ¬åœ°bit[5000]: 0  
åŒ¹é…: <span class="good">âœ“</span>  

æ—¶åˆ»T3+1:  
æ¥æ”¶bit[5001]: 1  
æœ¬åœ°bit[5001]: 1  
åŒ¹é…: <span class="good">âœ“</span>  

æ—¶åˆ»T3+2:  
æ¥æ”¶bit[5002]: 1  
æœ¬åœ°bit[5002]: 1  
åŒ¹é…: <span class="good">âœ“</span>  

...æŒç»­è·Ÿè¸ª...  

<span class="emphasis">ç›¸ä½å·²é”å®šï¼Œä¸ä¼š"é”™æ¼"ï¼</span>  
                            </div>  
                        </div>  
                    </div>  

                    <div class="timeline-item">  
                        <div class="timeline-content">  
                            <div class="timeline-title">T4: å¾ªç¯è¾¹ç•Œå¤„ç†</div>  
                            <div class="code-block">  
<span class="highlight">å½“ç›¸ä½åˆ°è¾¾åºåˆ—æœ«å°¾æ—¶ï¼š</span>  

æ—¶åˆ»TN (ä½ç½®2147483646ï¼Œæœ€åä¸€ä½):  
æ¥æ”¶bit[2147483646]: 0  
æœ¬åœ°bit[2147483646]: 0  
åŒ¹é…: <span class="good">âœ“</span>  

æ—¶åˆ»TN+1 (ä½ç½®0ï¼Œå›åˆ°å¼€å¤´):  
æ¥æ”¶bit[0]: 1  <span class="emphasis">â† è‡ªåŠ¨å¾ªç¯ï¼</span>  
æœ¬åœ°bit[0]: 1  
åŒ¹é…: <span class="good">âœ“</span>  

æ—¶åˆ»TN+2 (ä½ç½®1):  
æ¥æ”¶bit[1]: 0  
æœ¬åœ°bit[1]: 0  
åŒ¹é…: <span class="good">âœ“</span>  

<span class="good">å¾ªç¯æ— ç¼ï¼Œä¸ä¼š"æ¼æ‰"ä»»ä½•bitï¼</span>  

ç›¸ä½è®¡æ•°å™¨è‡ªåŠ¨wrapï¼š  
current_phase = (current_phase + 1) % PRBS_PERIOD;  
                            </div>  
                        </div>  
                    </div>  
                </div>  

                <div class="warning-box">  
                    <div class="warning-box-title">ä¼šä¸ä¼šLockåˆ°é”™è¯¯çš„ç›¸ä½ï¼Ÿ</div>  
                    <div class="code-block">  
<span class="highlight">é—®é¢˜ï¼šå¦‚æœæ¥æ”¶æ•°æ®æ°å¥½ä¸PRBSçš„æŸä¸ªç‰‡æ®µåŒ¹é…æ€ä¹ˆåŠï¼Ÿ</span>  

<span class="emphasis">ç­”æ¡ˆï¼šPRBSçš„è‡ªç›¸å…³ç‰¹æ€§é˜²æ­¢äº†è¿™ä¸ªé—®é¢˜ï¼</span>  

PRBS31çš„è‡ªç›¸å…³ç‰¹æ€§ï¼š  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
â€¢ <span class="good">æ­£ç¡®ç›¸ä½</span>ï¼šè¿ç»­1023+ bitsåŒ¹é…ç‡ > 99%  
â€¢ <span class="bad">é”™è¯¯ç›¸ä½</span>ï¼šè¿ç»­åŒ¹é…ä¸è¶…è¿‡31 bitsï¼Œç„¶åå¤±é…  

æ•°å­¦è¯æ˜ï¼ˆç®€åŒ–ï¼‰ï¼š  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
å¯¹äºPRBS31ï¼Œä»»æ„ä¸¤ä¸ªä¸åŒç›¸ä½çš„åºåˆ—ï¼š  
â€¢ çŸ­æœŸï¼ˆ< 31 bitsï¼‰ï¼šå¯èƒ½å¶ç„¶åŒ¹é…  
â€¢ é•¿æœŸï¼ˆ> 100 bitsï¼‰ï¼šåŒ¹é…ç‡ â‰ˆ 50%ï¼ˆéšæœºï¼‰  

åªæœ‰æ­£ç¡®ç›¸ä½æ‰èƒ½ä¿æŒé•¿æœŸé«˜åŒ¹é…ç‡ï¼  

å®é™…Lockç®—æ³•ï¼š  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
è¿ç»­æ£€æŸ¥N bitsï¼ˆN > 1000ï¼‰ï¼š  
if (match_rate > 95%) {  
    // å‡ ä¹ä¸å¯èƒ½æ˜¯å‡Lock  
    LOCK_CONFIRMED = TRUE;  
} else {  
    // ç»§ç»­æœç´¢  
    continue_search();  
}  

<span class="good">ç»“è®ºï¼šæ­£ç¡®ç›¸ä½Lockåï¼Œä¸ä¼š"è·³"åˆ°é”™è¯¯ç›¸ä½ï¼</span>  


<span class="highlight">ç‰¹æ®Šæƒ…å†µï¼šå™ªå£°å¯¼è‡´çš„å‡Lock</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
å¦‚æœé“¾è·¯è´¨é‡æå·®ï¼ˆBER > 0.1ï¼‰ï¼š  
â€¢ å¯èƒ½å¶ç„¶Lockåˆ°é”™è¯¯ç›¸ä½  
â€¢ ä½†ä¼šå¾ˆå¿«å¤±é”ï¼ˆæŒç»­mismatchingï¼‰  
â€¢ é‡æ–°æœç´¢å¹¶Lockåˆ°æ­£ç¡®ç›¸ä½  

é˜²æŠ¤æœºåˆ¶ï¼š  
â€¢ Locké˜ˆå€¼ï¼šè¿ç»­N bitsåŒ¹é…ï¼ˆNè¶Šå¤§è¶Šå¯é ï¼‰  
â€¢ å¤±é”é˜ˆå€¼ï¼šè¿ç»­M bitsä¸åŒ¹é…åˆ™å¤±é”  
â€¢ Hysteresisï¼šLockæ…¢ï¼Œå¤±é”å¿«  
                    </div>  
                </div>  

                <div class="info-box" style="margin-top: 30px;">  
                    <div class="info-box-title">èµ·å§‹ä½ç½®çš„çœŸå®å«ä¹‰</div>  
                    <div class="code-block">  
<span class="highlight">æ¾„æ¸…æ¦‚å¿µï¼š</span>  

<span class="bad">âŒ é”™è¯¯ç†è§£ï¼š</span>  
"PRBSæœ‰ä¸€ä¸ªå›ºå®šçš„èµ·å§‹ä½ç½®ï¼ŒRXå¿…é¡»æ‰¾åˆ°è¿™ä¸ªèµ·å§‹ä½ç½®"  

<span class="good">âœ… æ­£ç¡®ç†è§£ï¼š</span>  
"PRBSæ˜¯å¾ªç¯åºåˆ—ï¼ŒRXæ‰¾åˆ°ä»»æ„åŒ¹é…ç‚¹ï¼ˆç›¸ä½ï¼‰å³å¯"  


<span class="highlight">ç±»æ¯”ï¼šæ—¶é’Ÿ</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
é—®ï¼šæ—¶é’Ÿçš„"èµ·å§‹ä½ç½®"åœ¨å“ªé‡Œï¼Ÿ  
ç­”ï¼š<span class="emphasis">æ²¡æœ‰ç»å¯¹èµ·å§‹ä½ç½®ï¼</span>  

ä½ å¯ä»¥è¯´ï¼š  
â€¢ "ä»12ç‚¹å¼€å§‹" â†’ ç›¸ä½0  
â€¢ "ä»3ç‚¹å¼€å§‹"  â†’ ç›¸ä½90Â°  
â€¢ "ä»6ç‚¹å¼€å§‹"  â†’ ç›¸ä½180Â°  

éƒ½æ˜¯æ­£ç¡®çš„ï¼åªè¦ä½ æŒç»­è·Ÿè¸ªæ—¶é—´æµé€å³å¯ã€‚  

PRBSå®Œå…¨ç›¸åŒï¼š  
â€¢ TXå¯ä»¥ä»ä»»æ„ç›¸ä½å¼€å§‹å‘é€  
â€¢ RXæ‰¾åˆ°ä»»æ„ç›¸ä½å¹¶Lock  
â€¢ ä¹‹åæŒç»­è·Ÿè¸ªï¼Œæ£€æµ‹è¯¯ç   

<span class="good">ç›¸ä½æœ¬èº«ä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯Lockåçš„åŒæ­¥ï¼</span>  


<span class="highlight">å®é™…åº”ç”¨ä¸­ï¼š</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
â€¢ TXé‡å¯åï¼Œå¯èƒ½ä»ä¸åŒç›¸ä½å¼€å§‹  
  â†’ RXé‡æ–°æœç´¢å¹¶Lockåˆ°æ–°ç›¸ä½ <span class="good">âœ“</span>  

â€¢ é“¾è·¯ä¸­æ–­åé‡æ–°è¿æ¥  
  â†’ RXé‡æ–°æœç´¢ï¼Œå‡ åæ¯«ç§’å†…é‡æ–°Lock <span class="good">âœ“</span>  

â€¢ å¤šLaneç³»ç»Ÿï¼Œæ¯ä¸ªLaneçš„ç›¸ä½å¯èƒ½ä¸åŒ  
  â†’ æ¯ä¸ªLaneç‹¬ç«‹æœç´¢å’ŒLock <span class="good">âœ“</span>  

â€¢ å³ä½¿ç›¸ä½ä¸åŒï¼ŒBERç»Ÿè®¡å®Œå…¨å‡†ç¡®  
  â†’ å› ä¸ºè¯¯ç æ£€æµ‹æ˜¯é€bitçš„ï¼Œä¸ç›¸ä½æ— å…³ <span class="good">âœ“</span>  
                    </div>  
                </div>  
            </div>  
        </div>  

        <!-- é—®é¢˜4: ä¸åŒç å‹å¤„ç† -->  
        <div id="question4" class="tab-content">  
            <div class="main-section">  
                <div class="section-title">ğŸ­ é—®é¢˜4: å¦‚æœå„ä¸ªLaneå‘é€çš„ç æµç å‹ä¸ä¸€æ ·ï¼Œæ¥æ”¶ç«¯æ€ä¹ˆå¤„ç†ï¼Ÿ</div>  
                
                <div class="info-box">  
                    <div class="info-box-title">æ ¸å¿ƒç­”æ¡ˆ</div>  
                    <div class="code-block">  
<span class="highlight">å®Œå…¨æ”¯æŒï¼æ¯ä¸ªLaneå¯ä»¥é…ç½®ä¸åŒçš„PRBSç±»å‹ï¼</span>  

å…³é”®ç‚¹ï¼š  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
1. <span class="emphasis">æ¯ä¸ªLaneæœ‰ç‹¬ç«‹çš„PRBS Generatorå’ŒChecker</span>  
   â€¢ æ¯ä¸ªLaneå¯ä»¥é€‰æ‹©ä¸åŒçš„PRBSç±»å‹  
   â€¢ Lane 0: PRBS7  
   â€¢ Lane 1: PRBS15  
   â€¢ Lane 2: PRBS31  
   â€¢ Lane 3: PRBS23  

2. <span class="emphasis">RXç«¯æ¯ä¸ªLaneç‹¬ç«‹é…ç½®å’Œæ£€æµ‹</span>  
                   â€¢ RX Lane 0é…ç½®ä¸ºPRBS7 â†’ æ£€æµ‹Lane 0
                   â€¢ RX Lane 1é…ç½®ä¸ºPRBS15 â†’ æ£€æµ‹Lane 1
                   â€¢ RX Lane 2é…ç½®ä¸ºPRBS31 â†’ æ£€æµ‹Lane 2
                   â€¢ RX Lane 3é…ç½®ä¸ºPRBS23 â†’ æ£€æµ‹Lane 3

3. <span class="emphasis">Laneä¹‹é—´å®Œå…¨ç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰°</span>
   â€¢ Lane 0çš„PRBSç±»å‹ä¸å½±å“Lane 1
   â€¢ æ¯ä¸ªLaneç‹¬ç«‹Lockã€ç‹¬ç«‹ç»Ÿè®¡BER
   â€¢ å¯ä»¥æ··åˆä½¿ç”¨ä¸åŒPRBSç±»å‹æµ‹è¯•
                    </div>
                </div>

                <div class="warning-box" style="margin-top: 30px;">
                    <div class="warning-box-title">âš¡ é‡è¦ï¼šPRBSé€Ÿç‡åŒ¹é…ç‰¹æ€§</div>
                    <div class="code-block">
<span class="highlight">â“ PRBSå‘é€é€Ÿç‡ > æ¥æ”¶é€Ÿç‡ä¼šæ€æ ·ï¼Ÿ</span>

<span class="emphasis">æ ¸å¿ƒç­”æ¡ˆï¼šä¸ä¼šæœ‰åå‹æˆ–æµæ§ï¼PRBSå·¥ä½œåœ¨ç‰©ç†å±‚ï¼Œæ²¡æœ‰ç¼“å­˜æœºåˆ¶ï¼</span>

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
<span class="highlight">1. PRBSå·¥ä½œåœ¨ç‰©ç†å±‚ï¼ˆPHY Layerï¼‰</span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

OSIæ¨¡å‹ä½ç½®ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åº”ç”¨å±‚ (Application)    â† æœ‰ç¼“å­˜ã€æµæ§                  â”‚
â”‚ ä¼ è¾“å±‚ (Transport)      â† TCPæœ‰æµæ§ã€çª—å£æ§åˆ¶            â”‚
â”‚ ç½‘ç»œå±‚ (Network)        â† IPè·¯ç”±                        â”‚
â”‚ æ•°æ®é“¾è·¯å±‚ (Data Link)  â† ä»¥å¤ªç½‘MACæœ‰PAUSEå¸§ï¼ˆæµæ§ï¼‰     â”‚
â”‚ <span class="emphasis">ç‰©ç†å±‚ (Physical)       â† PRBSåœ¨è¿™é‡Œï¼æ— ç¼“å­˜ã€æ— æµæ§</span>  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

<span class="good">PRBSç›´æ¥æ“ä½œSerDeså‘é€ç«¯å’Œæ¥æ”¶ç«¯ï¼Œæ²¡æœ‰ä¸­é—´ç¼“å­˜ï¼</span>


<span class="highlight">2. PRBSå¿…é¡»é€Ÿç‡å®Œå…¨åŒ¹é…</span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

PRBSå·¥ä½œåŸç†ï¼š
TXç«¯ï¼šæ—¶é’ŸCLK_TXé©±åŠ¨ â†’ æ¯ä¸ªæ—¶é’Ÿå‘¨æœŸå‘é€N bits
RXç«¯ï¼šæ—¶é’ŸCLK_RXé©±åŠ¨ â†’ æ¯ä¸ªæ—¶é’Ÿå‘¨æœŸæ¥æ”¶N bits

<span class="emphasis">å…³é”®çº¦æŸï¼šCLK_TX = CLK_RXï¼ˆå¿…é¡»å®Œå…¨ç›¸ç­‰ï¼ï¼‰</span>

å¦‚æœé€Ÿç‡ä¸åŒ¹é…ä¼šæ€æ ·ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åœºæ™¯1ï¼šTXé€Ÿç‡ > RXé€Ÿç‡                                   â”‚
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚                                                          â”‚
â”‚ TX: å‘é€10 Gbps                                          â”‚
â”‚     â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“ (10ä¸ªbit/ns)                            â”‚
â”‚                                                          â”‚
â”‚ RX: æ¥æ”¶8 Gbps                                           â”‚
â”‚     â†“â†“â†“â†“â†“â†“â†“â†“   (8ä¸ªbit/ns)                              â”‚
â”‚                                                          â”‚
â”‚ <span class="bad">ç»“æœï¼šRXä¼šæ¼æ‰2 Gbpsçš„æ•°æ®ï¼</span>                       â”‚
â”‚      æ— ç¼“å­˜æœºåˆ¶ï¼Œæ•°æ®ç›´æ¥ä¸¢å¤±ï¼                          â”‚
â”‚      BERä¼šéå¸¸é«˜ï¼ˆâ‰ˆ20%ï¼‰                                 â”‚
â”‚      CDRæ— æ³•Lockï¼ˆæ—¶é’Ÿé¢‘ç‡ä¸åŒ¹é…ï¼‰                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åœºæ™¯2ï¼šTXé€Ÿç‡ < RXé€Ÿç‡                                   â”‚
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚                                                          â”‚
â”‚ TX: å‘é€8 Gbps                                           â”‚
â”‚     â†“â†“â†“â†“â†“â†“â†“â†“   (8ä¸ªbit/ns)                              â”‚
â”‚                                                          â”‚
â”‚ RX: æ¥æ”¶10 Gbps                                          â”‚
â”‚     â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“ (10ä¸ªbit/ns)                            â”‚
â”‚                                                          â”‚
â”‚ <span class="bad">ç»“æœï¼šRXä¼šé‡‡æ ·åˆ°"ç©ºç™½"ï¼ˆæœªå®šä¹‰çŠ¶æ€ï¼‰</span>                â”‚
â”‚      RXçš„CDRå°è¯•æ¢å¤æ—¶é’Ÿï¼Œä½†ä¼šå¤±è´¥                       â”‚
â”‚      æ— æ³•Lockï¼ŒPRBS_LOCK = 0                             â”‚
â”‚      BERæ— æ„ä¹‰ï¼ˆå› ä¸ºæ ¹æœ¬æ²¡Lockï¼‰                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


<span class="highlight">3. ä¸ºä»€ä¹ˆæ²¡æœ‰ç¼“å­˜ï¼Ÿ</span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ç‰©ç†åŸå› ï¼š
â€¢ SerDesæ˜¯<span class="emphasis">å®æ—¶ç”µè·¯</span>ï¼Œæ•°æ®ä»¥ç”µä¿¡å·å½¢å¼ç›´æ¥ä¼ è¾“
â€¢ TXç«¯å‘é€çš„bitç«‹å³åœ¨ä¼ è¾“ä»‹è´¨ï¼ˆå…‰çº¤/é“œç¼†ï¼‰ä¸Šä¼ æ’­
â€¢ RXç«¯å®æ—¶é‡‡æ ·ï¼Œæ²¡æœ‰æ—¶é—´"ç¼“å­˜"

ç±»æ¯”ï¼š
PRBSä¼ è¾“ = æ°´ç®¡ç›´æ¥è¿æ¥
â€¢ TXç«¯ï¼šæ°´é¾™å¤´ï¼ˆå›ºå®šæµé€Ÿï¼‰
â€¢ RXç«¯ï¼šæ°´æ§½ï¼ˆå›ºå®šæ’æ°´é€Ÿåº¦ï¼‰
â€¢ å¦‚æœæ°´é¾™å¤´æµé€Ÿ > æ’æ°´é€Ÿåº¦ â†’ <span class="bad">æº¢å‡ºï¼ˆæ•°æ®ä¸¢å¤±ï¼‰</span>
â€¢ å¦‚æœæ°´é¾™å¤´æµé€Ÿ < æ’æ°´é€Ÿåº¦ â†’ <span class="bad">å¹²æ¶¸ï¼ˆé‡‡æ ·é”™è¯¯ï¼‰</span>
â€¢ <span class="good">å¿…é¡»æµé€Ÿå®Œå…¨åŒ¹é…ï¼</span>

ä»¥å¤ªç½‘ä¼ è¾“ = æ°´ç®¡ä¸­é—´æœ‰æ°´å¡”ï¼ˆç¼“å­˜ï¼‰
â€¢ TXç«¯å¿«äº†ï¼Œæ°´å¡”æš‚å­˜ â†’ æµæ§å‘Šè¯‰TXæ…¢ä¸€ç‚¹
â€¢ RXç«¯æ…¢äº†ï¼Œæ°´å¡”æœ‰å®¹é‡ â†’ å¯ä»¥æš‚æ—¶ç¼“å†²
â€¢ æœ‰PAUSEå¸§æœºåˆ¶


<span class="highlight">4. SerDesçš„æ—¶é’Ÿæ¢å¤æœºåˆ¶ï¼ˆCDRï¼‰</span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

RXç«¯å¦‚ä½•é€‚åº”TXé€Ÿç‡ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TXç«¯ï¼š                                                 â”‚
â”‚   æœ¬åœ°å‚è€ƒæ—¶é’Ÿ â†’ PLL â†’ ç”ŸæˆTXæ—¶é’Ÿï¼ˆå¦‚10.3125 GHzï¼‰    â”‚
â”‚   TXæ—¶é’Ÿé©±åŠ¨SerDeså‘é€æ•°æ®                             â”‚
â”‚                                                        â”‚
â”‚ ä¼ è¾“ä»‹è´¨ï¼ˆå…‰çº¤/é“œç¼†ï¼‰ï¼š                                 â”‚
â”‚   æ•°æ® + åµŒå…¥çš„æ—¶é’Ÿä¿¡æ¯ï¼ˆé€šè¿‡æ•°æ®è·³å˜ä¼ é€’ï¼‰             â”‚
â”‚                                                        â”‚
â”‚ RXç«¯ï¼š                                                 â”‚
â”‚   SerDesæ¥æ”¶æ•°æ® â†’ <span class="emphasis">CDRï¼ˆClock Data Recoveryï¼‰</span>      â”‚
â”‚   CDRä»æ•°æ®ä¸­æ¢å¤TXçš„æ—¶é’Ÿ                               â”‚
â”‚   ç”¨æ¢å¤çš„æ—¶é’Ÿé‡‡æ ·æ•°æ® â†’ <span class="good">é€Ÿç‡è‡ªåŠ¨åŒ¹é…ï¼</span>             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

<span class="good">å…³é”®ï¼šCDRè‡ªåŠ¨è¿½è¸ªTXæ—¶é’Ÿï¼ŒRXé€Ÿç‡ = TXé€Ÿç‡ï¼</span>

CDRå·¥ä½œåŸç†ï¼ˆç®€åŒ–ï¼‰ï¼š
1. ç›‘æµ‹æ•°æ®è¾¹æ²¿ï¼ˆ0â†’1æˆ–1â†’0è·³å˜ï¼‰
2. è°ƒæ•´æœ¬åœ°PLLï¼Œä½¿é‡‡æ ·æ—¶é’Ÿå¯¹é½æ•°æ®ä¸­å¿ƒ
3. é”å®šåï¼ŒRXæ—¶é’Ÿ = TXæ—¶é’Ÿï¼ˆè¯¯å·® < 100 ppmï¼‰

CDRå®¹å¿èŒƒå›´ï¼š
â€¢ TX/RXæ—¶é’Ÿè¯¯å·® < Â±100 ppm â†’ <span class="good">å¯ä»¥Lock</span>
â€¢ TX/RXæ—¶é’Ÿè¯¯å·® > Â±300 ppm â†’ <span class="bad">æ— æ³•Lock</span>


<span class="highlight">5. å®é™…é€Ÿç‡ä¸åŒ¹é…çš„æ¡ˆä¾‹</span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

<span class="bad">æ¡ˆä¾‹1ï¼šé”™è¯¯é…ç½®SerDesé€Ÿç‡</span>
TXé…ç½®ï¼š25 Gbps SerDes
RXé…ç½®ï¼š10 Gbps SerDes

ç°è±¡ï¼š
â€¢ RXçš„CDRå°è¯•Lockï¼Œä½†é¢‘ç‡å·®2.5å€
â€¢ CDRçš„PLLæ— æ³•Lockåˆ°æ­£ç¡®é¢‘ç‡
â€¢ PRBS_LOCK = 0ï¼ˆæ°¸è¿œæ— æ³•Lockï¼‰
â€¢ é”™è¯¯æç¤ºï¼š"CDR unlock"


<span class="bad">æ¡ˆä¾‹2ï¼šå‚è€ƒæ—¶é’Ÿé¢‘ç‡é”™è¯¯</span>
TXå‚è€ƒæ—¶é’Ÿï¼š156.25 MHzï¼ˆæ­£ç¡®ï¼‰
RXå‚è€ƒæ—¶é’Ÿï¼š155.00 MHzï¼ˆé”™è¯¯ï¼å·®0.8%ï¼‰

ç°è±¡ï¼š
â€¢ çŸ­æœŸï¼šCDRå¯èƒ½å‹‰å¼ºLockï¼ˆå®¹å¿Â±100ppmï¼‰
â€¢ 0.8% = 8000 ppm â†’ <span class="bad">è¶…å‡ºCDRèŒƒå›´ï¼</span>
â€¢ CDRé¢‘ç¹å¤±é”ã€é‡é”
â€¢ BERæé«˜ï¼ˆå› ä¸ºé‡‡æ ·ç‚¹æ¼‚ç§»ï¼‰


<span class="good">æ¡ˆä¾‹3ï¼šæ­£ç¡®é…ç½®ï¼ˆé€Ÿç‡åŒ¹é…ï¼‰</span>
TXé…ç½®ï¼š25.78125 Gbpsï¼ˆ100Gä»¥å¤ªç½‘å•Laneï¼‰
RXé…ç½®ï¼šCDRè‡ªåŠ¨è¿½è¸ª

ç°è±¡ï¼š
â€¢ RXçš„CDRè‡ªåŠ¨Lockåˆ°TXæ—¶é’Ÿ
â€¢ CDR_LOCK = 1
â€¢ PRBSå¿«é€ŸLockï¼ˆ< 100msï¼‰
â€¢ BER < 1e-12 <span class="good">â† å®Œç¾è¿è¡Œï¼</span>


<span class="highlight">6. ç‰¹æ®Šæƒ…å†µï¼šå¼‚æ­¥æ—¶é’ŸåŸŸï¼ˆè·¨æ—¶é’ŸåŸŸFIFOï¼‰</span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

åœ¨æŸäº›ç³»ç»Ÿä¸­ï¼Œå¯èƒ½å­˜åœ¨FIFOï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SerDes TX â†’ [FIFO] â†’ SerDes RX                         â”‚
â”‚              â†‘                                           â”‚
â”‚         å¼‚æ­¥æ—¶é’ŸåŸŸç¼“å†²                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä½†<span class="emphasis">è¿™ä¸æ˜¯PRBSå±‚é¢çš„æœºåˆ¶ï¼</span>

è¿™ç§FIFOé€šå¸¸ç”¨äºï¼š
â€¢ ä»¥å¤ªç½‘MACå±‚ï¼ˆæ­£å¸¸æ•°æ®åŒ…ï¼‰
â€¢ æœ‰æµæ§æœºåˆ¶ï¼ˆPAUSEå¸§ã€ä¿¡ç”¨å­—ï¼‰

<span class="bad">PRBSæµ‹è¯•æ—¶ï¼Œè¿™ä¸ªFIFOè¢«æ—è·¯ï¼ˆBypassï¼‰ï¼</span>
åŸå› ï¼š
â€¢ PRBSéœ€è¦ç›´æ¥æµ‹è¯•SerDesç‰©ç†å±‚
â€¢ åŠ å…¥FIFOä¼šæ©ç›–SerDesçš„çœŸå®é—®é¢˜
â€¢ PRBSæµ‹è¯• = ç›´è¿æ¨¡å¼ï¼ˆTX SerDesç›´æ¥åˆ°RX SerDesï¼‰


<span class="highlight">7. æ€»ç»“å¯¹æ¯”è¡¨</span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç‰¹æ€§       â”‚  PRBSæµ‹è¯•    â”‚  ä»¥å¤ªç½‘æ•°æ®  â”‚  TCP/IP  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å·¥ä½œå±‚       â”‚ ç‰©ç†å±‚(PHY)  â”‚ æ•°æ®é“¾è·¯å±‚   â”‚ ä¼ è¾“å±‚   â”‚
â”‚ æ˜¯å¦æœ‰ç¼“å­˜   â”‚ <span class="bad">æ— </span>           â”‚ <span class="emphasis">MACæœ‰FIFO</span>  â”‚ <span class="good">æœ‰å¤§ç¼“å­˜</span> â”‚
â”‚ æ˜¯å¦æœ‰æµæ§   â”‚ <span class="bad">æ— </span>           â”‚ <span class="emphasis">æœ‰PAUSEå¸§</span>  â”‚ <span class="good">æœ‰çª—å£</span>  â”‚
â”‚ é€Ÿç‡è¦æ±‚     â”‚ <span class="emphasis">ä¸¥æ ¼åŒ¹é…</span>     â”‚ åŒ¹é…(CDR)    â”‚ å¯ä¸åŒ   â”‚
â”‚ é€Ÿç‡ä¸åŒ¹é…   â”‚ <span class="bad">æ— æ³•å·¥ä½œ</span>     â”‚ CDRå®¹å¿      â”‚ è‡ªé€‚åº”   â”‚
â”‚ æ•°æ®ä¸¢å¤±     â”‚ <span class="bad">ç›´æ¥ä¸¢å¤±</span>     â”‚ å¯èƒ½ä¸¢åŒ…     â”‚ é‡ä¼      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    </div>
                </div>

                <div class="section-title" style="margin-top: 40px;">ğŸ”§ æ··åˆPRBSç±»å‹é…ç½®</div>
                
                <div class="lane-diagram">
                    <div class="lane-box" style="border-color: #ff69b4;">
                        <div class="lane-title"><span class="status-indicator ok"></span>Lane 0 - PRBS7</div>
                        <div class="lane-content">
                            <div class="code-block">
<span class="highlight">TXç«¯é…ç½®ï¼š</span>
write_reg(PRBS_TX_CTRL[0], 0x01);
// Bit[6:4] = 000 (PRBS7)
// Bit[0] = 1 (Enable)

<span class="highlight">PRBS7ç‰¹æ€§ï¼š</span>
â€¢ å¤šé¡¹å¼: xâ· + xâ¶ + 1
â€¢ å‘¨æœŸ: 127 bits
â€¢ Lockæ—¶é—´: ~5 ns

<span class="highlight">RXç«¯é…ç½®ï¼š</span>
write_reg(PRBS_RX_CTRL[0], 0x01);
// å¿…é¡»åŒ¹é…PRBS7

<span class="highlight">çŠ¶æ€ï¼š</span>
â€¢ Lock: <span class="good">âœ“ LOCKED</span>
â€¢ BER: <span class="good">1.2e-12</span>
â€¢ ç”¨é€”: å¿«é€Ÿæµ‹è¯•
                            </div>
                        </div>
                    </div>

                    <div class="lane-box" style="border-color: #4169e1;">
                        <div class="lane-title"><span class="status-indicator ok"></span>Lane 1 - PRBS15</div>
                        <div class="lane-content">
                            <div class="code-block">
<span class="highlight">TXç«¯é…ç½®ï¼š</span>
write_reg(PRBS_TX_CTRL[1], 0x31);
// Bit[6:4] = 011 (PRBS15)
// Bit[0] = 1 (Enable)

<span class="highlight">PRBS15ç‰¹æ€§ï¼š</span>
â€¢ å¤šé¡¹å¼: xÂ¹âµ + xÂ¹â´ + 1
â€¢ å‘¨æœŸ: 32,767 bits
â€¢ Lockæ—¶é—´: ~1.3 Î¼s

<span class="highlight">RXç«¯é…ç½®ï¼š</span>
write_reg(PRBS_RX_CTRL[1], 0x31);
// å¿…é¡»åŒ¹é…PRBS15

<span class="highlight">çŠ¶æ€ï¼š</span>
â€¢ Lock: <span class="good">âœ“ LOCKED</span>
â€¢ BER: <span class="good">9.8e-13</span>
â€¢ ç”¨é€”: æ ‡å‡†æµ‹è¯•
                            </div>
                        </div>
                    </div>

                    <div class="lane-box" style="border-color: #32cd32;">
                        <div class="lane-title"><span class="status-indicator ok"></span>Lane 2 - PRBS31</div>
                        <div class="lane-content">
                            <div class="code-block">
<span class="highlight">TXç«¯é…ç½®ï¼š</span>
write_reg(PRBS_TX_CTRL[2], 0x51);
// Bit[6:4] = 101 (PRBS31)
// Bit[0] = 1 (Enable)

<span class="highlight">PRBS31ç‰¹æ€§ï¼š</span>
â€¢ å¤šé¡¹å¼: xÂ³Â¹ + xÂ²â¸ + 1
â€¢ å‘¨æœŸ: 2,147,483,647 bits
â€¢ Lockæ—¶é—´: ~83 ms

<span class="highlight">RXç«¯é…ç½®ï¼š</span>
write_reg(PRBS_RX_CTRL[2], 0x51);
// å¿…é¡»åŒ¹é…PRBS31

<span class="highlight">çŠ¶æ€ï¼š</span>
â€¢ Lock: <span class="good">âœ“ LOCKED</span>
â€¢ BER: <span class="good">1.0e-12</span>
â€¢ ç”¨é€”: é•¿å‘¨æœŸæµ‹è¯•
                            </div>
                        </div>
                    </div>

                    <div class="lane-box" style="border-color: #ff8c00;">
                        <div class="lane-title"><span class="status-indicator ok"></span>Lane 3 - PRBS23</div>
                        <div class="lane-content">
                            <div class="code-block">
<span class="highlight">TXç«¯é…ç½®ï¼š</span>
write_reg(PRBS_TX_CTRL[3], 0x41);
// Bit[6:4] = 100 (PRBS23)
// Bit[0] = 1 (Enable)

<span class="highlight">PRBS23ç‰¹æ€§ï¼š</span>
â€¢ å¤šé¡¹å¼: xÂ²Â³ + xÂ¹â¸ + 1
â€¢ å‘¨æœŸ: 8,388,607 bits
â€¢ Lockæ—¶é—´: ~325 Î¼s

<span class="highlight">RXç«¯é…ç½®ï¼š</span>
write_reg(PRBS_RX_CTRL[3], 0x41);
// å¿…é¡»åŒ¹é…PRBS23

<span class="highlight">çŠ¶æ€ï¼š</span>
â€¢ Lock: <span class="good">âœ“ LOCKED</span>
â€¢ BER: <span class="good">8.5e-13</span>
â€¢ ç”¨é€”: ä¸­ç­‰å‘¨æœŸæµ‹è¯•
                            </div>
                        </div>
                    </div>
                </div>

                <div class="info-box" style="margin-top: 40px;">
                    <div class="info-box-title">ğŸ’¡ CDRå·¥ä½œæœºåˆ¶è¯¦è§£</div>
                    <div class="code-block">
<span class="highlight">æ—¶é’Ÿæ•°æ®æ¢å¤ï¼ˆClock Data Recoveryï¼‰å¦‚ä½•ä¿è¯é€Ÿç‡åŒ¹é…</span>

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
<span class="emphasis">æ­¥éª¤1ï¼šæ•°æ®ä¼ è¾“ï¼ˆåµŒå…¥æ—¶é’Ÿä¿¡æ¯ï¼‰</span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

TXç«¯å‘é€æ•°æ®ï¼š
æ—¶åˆ»T0: æ•°æ®='1'  ç”µå‹=+800mV  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
æ—¶åˆ»T1: æ•°æ®='0'  ç”µå‹=-800mV           â”‚ æ•°æ®è·³å˜
æ—¶åˆ»T2: æ•°æ®='1'  ç”µå‹=+800mV  â†â”€â”€â”€â”€â”€â”€â”€â”€â”˜ åŒ…å«æ—¶é’Ÿä¿¡æ¯
æ—¶åˆ»T3: æ•°æ®='1'  ç”µå‹=+800mV
æ—¶åˆ»T4: æ•°æ®='0'  ç”µå‹=-800mV  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
æ—¶åˆ»T5: æ•°æ®='1'  ç”µå‹=+800mV  â†â”€â”€â”€â”€â”€â”€â”€â”€â”˜

<span class="good">å…³é”®ï¼šæ•°æ®è·³å˜ï¼ˆ0â†’1æˆ–1â†’0ï¼‰æºå¸¦äº†TXæ—¶é’Ÿçš„é¢‘ç‡ä¿¡æ¯ï¼</span>

æ•°æ®è·³å˜é—´éš” = 1/æ—¶é’Ÿé¢‘ç‡
ä¾‹å¦‚ï¼š25 Gbps â†’ è·³å˜æœ€å°é—´éš” = 40 ps


<span class="emphasis">æ­¥éª¤2ï¼šRXç«¯çš„CDRç”µè·¯</span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

RXç«¯CDRæ¡†å›¾ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                          â”‚
â”‚  æ¥æ”¶æ•°æ® â”€â”€â”€â†’ [ç›¸ä½æ£€æµ‹å™¨] â”€â”€â†’ [ç¯è·¯æ»¤æ³¢å™¨]            â”‚
â”‚       â†‘              â†“                   â†“               â”‚
â”‚       â”‚         ç›¸ä½è¯¯å·®              æ§åˆ¶ä¿¡å·            â”‚
â”‚       â”‚              â†“                   â†“               â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€ [VCO/PLL] â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                      â”‚                                   â”‚
â”‚                æ¢å¤çš„æ—¶é’Ÿ â”€â”€â†’ [é‡‡æ ·å™¨] â”€â”€â†’ æ¢å¤çš„æ•°æ®    â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å·¥ä½œåŸç†ï¼š
1. ç›¸ä½æ£€æµ‹å™¨ï¼šæ¯”è¾ƒæ•°æ®è·³å˜ä¸æœ¬åœ°æ—¶é’Ÿçš„ç›¸ä½å·®
2. ç¯è·¯æ»¤æ³¢å™¨ï¼šå¹³æ»‘æ§åˆ¶ä¿¡å·ï¼Œé¿å…æŠ–åŠ¨
3. VCOï¼ˆå‹æ§æŒ¯è¡å™¨ï¼‰ï¼šæ ¹æ®æ§åˆ¶ä¿¡å·è°ƒæ•´é¢‘ç‡
4. è´Ÿåé¦ˆï¼šä½¿æœ¬åœ°æ—¶é’Ÿé¢‘ç‡ â†’ TXæ—¶é’Ÿé¢‘ç‡


<span class="emphasis">æ­¥éª¤3ï¼šç›¸ä½é”å®šè¿‡ç¨‹</span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

åˆå§‹çŠ¶æ€ï¼ˆæœªé”å®šï¼‰ï¼š
TXæ—¶é’Ÿ: â†‘ â”€â”€â”€ â†‘ â”€â”€â”€ â†‘ â”€â”€â”€ â†‘ â”€â”€â”€ (25.78125 GHz)
RXæ—¶é’Ÿ: â†‘ â”€â”€ â†‘ â”€â”€ â†‘ â”€â”€ â†‘ â”€â”€ â†‘ â”€â”€ (åˆå§‹25.0 GHzï¼Œé¢‘ç‡ä¸å¯¹)
        â†‘ ç›¸ä½/é¢‘ç‡éƒ½ä¸å¯¹

CDRæ£€æµ‹åˆ°ç›¸ä½è¯¯å·® â†’ è°ƒæ•´VCO â†’ å¢åŠ é¢‘ç‡

è¿‡æ¸¡çŠ¶æ€ï¼ˆè¿½è¸ªä¸­ï¼‰ï¼š
TXæ—¶é’Ÿ: â†‘ â”€â”€â”€ â†‘ â”€â”€â”€ â†‘ â”€â”€â”€ â†‘ â”€â”€â”€
RXæ—¶é’Ÿ: â†‘ â”€â”€â”€ â†‘ â”€â”€â”€ â†‘ â”€â”€â”€ â†‘ â”€â”€â”€ (æ¥è¿‘25.78125 GHz)
        â†‘ é¢‘ç‡æ¥è¿‘ï¼Œä½†ç›¸ä½è¿˜æœ‰å°è¯¯å·®

CDRç»§ç»­å¾®è°ƒ â†’ ç›¸ä½å¯¹é½

é”å®šçŠ¶æ€ï¼ˆCDR_LOCK=1ï¼‰ï¼š
TXæ—¶é’Ÿ: â†‘ â”€â”€â”€ â†‘ â”€â”€â”€ â†‘ â”€â”€â”€ â†‘ â”€â”€â”€
RXæ—¶é’Ÿ: â†‘ â”€â”€â”€ â†‘ â”€â”€â”€ â†‘ â”€â”€â”€ â†‘ â”€â”€â”€ (å®Œå…¨åŒæ­¥ï¼)
        â†‘ é¢‘ç‡å’Œç›¸ä½éƒ½åŒ¹é…

<span class="good">æ­¤æ—¶RXé‡‡æ ·æ—¶é’Ÿ = TXå‘é€æ—¶é’Ÿï¼Œé€Ÿç‡è‡ªåŠ¨åŒ¹é…ï¼</span>


<span class="emphasis">æ­¥éª¤4ï¼šæŒç»­è¿½è¸ª</span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

å³ä½¿TXæ—¶é’Ÿæœ‰å°æ¼‚ç§»ï¼ˆæ¸©åº¦ã€ç”µæºå˜åŒ–ï¼‰ï¼ŒCDRä¹Ÿèƒ½è¿½è¸ªï¼š

æ—¶åˆ»T0: TX = 25.78125000 GHz, RX = 25.78125000 GHz âœ“
æ—¶åˆ»T1: TX = 25.78125020 GHz (æ¼‚ç§»+20 Hz), RXè¿½è¸ªä¸­...
æ—¶åˆ»T2: TX = 25.78125020 GHz, RX = 25.78125020 GHz âœ“

CDRè¿½è¸ªèŒƒå›´ï¼š
â€¢ å…¸å‹ï¼šÂ±300 ppm (Â±7.7 MHz @25G)
â€¢ é«˜æ€§èƒ½ï¼šÂ±100 ppm


<span class="highlight">ä¸ºä»€ä¹ˆä¸éœ€è¦ç¼“å­˜ï¼Ÿ</span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

å› ä¸º<span class="emphasis">RXæ—¶é’Ÿè‡ªåŠ¨è¿½è¸ªTXæ—¶é’Ÿï¼Œä¸¤è€…å§‹ç»ˆåŒæ­¥ï¼</span>

ç±»æ¯”ï¼š
è·³èˆçš„ä¸¤ä¸ªäººï¼ˆTXå’ŒRXï¼‰
â€¢ TXï¼šèˆè¹ˆé¢†èˆè€…ï¼Œè®¾å®šèŠ‚å¥ï¼ˆæ—¶é’Ÿï¼‰
â€¢ RXï¼šèˆè¹ˆè·Ÿéšè€…ï¼ŒCDRè‡ªåŠ¨è·Ÿä¸ŠTXçš„èŠ‚å¥
â€¢ ç»“æœï¼šä¸¤äººæ­¥ä¼å®Œå…¨åŒæ­¥ï¼Œä¸éœ€è¦"æš‚åœ"æˆ–"ç¼“å­˜"

å¦‚æœRXæœ‰è‡ªå·±çš„å›ºå®šèŠ‚å¥ï¼ˆä¸è¿½è¸ªTXï¼‰ï¼š
â€¢ TXå¿«ï¼ŒRXæ…¢ â†’ è¸©è„šï¼ˆæ•°æ®ä¸¢å¤±ï¼‰
â€¢ TXæ…¢ï¼ŒRXå¿« â†’ ç©ºè¸©ï¼ˆé‡‡æ ·é”™è¯¯ï¼‰


<span class="highlight">CDR LockæŒ‡ç¤ºå¯„å­˜å™¨</span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

// æ£€æŸ¥CDRæ˜¯å¦Lock
uint32_t cdr_status = read_reg(LANE0_CDR_STATUS);

Bit[0]: CDR_LOCK
  â€¢ 1 = CDRå·²é”å®šTXæ—¶é’Ÿ
  â€¢ 0 = CDRæœªé”å®šï¼ˆé¢‘ç‡å·®å¤ªå¤§æˆ–æ— ä¿¡å·ï¼‰

Bit[1]: CDR_FREQ_LOCK
  â€¢ 1 = é¢‘ç‡å·²é”å®šï¼ˆè¯¯å·® < 100ppmï¼‰
  â€¢ 0 = é¢‘ç‡å·®å¤ªå¤§

Bit[2]: CDR_PHASE_LOCK
  â€¢ 1 = ç›¸ä½å·²å¯¹é½
  â€¢ 0 = ç›¸ä½è¿˜åœ¨è°ƒæ•´

Bit[15:8]: CDR_FREQ_OFFSET (æœ‰ç¬¦å·æ•°)
  â€¢ å½“å‰é¢‘ç‡åç§»é‡ï¼ˆppmï¼‰
  â€¢ ä¾‹å¦‚ï¼š0x05 = +5 ppm
  â€¢       0xFB = -5 ppm


<span class="highlight">CDR Lockå¤±è´¥çš„å¸¸è§åŸå› </span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. <span class="bad">TX/RXé€Ÿç‡é…ç½®ä¸åŒ¹é…</span>
   TX: 25G, RX: 10G â†’ é¢‘ç‡å·®2.5å€ï¼ŒCDRæ— æ³•Lock

2. <span class="bad">å‚è€ƒæ—¶é’Ÿé¢‘ç‡é”™è¯¯</span>
   TX ref: 156.25 MHz, RX ref: 155.00 MHz
   â†’ 0.8%è¯¯å·® = 8000 ppmï¼Œè¶…å‡ºCDRèŒƒå›´

3. <span class="bad">ä¿¡å·è´¨é‡å¤ªå·®</span>
   å™ªå£°å¤ªå¤§ï¼ŒCDRæ— æ³•å‡†ç¡®æ£€æµ‹æ•°æ®è·³å˜

4. <span class="bad">æ— ä¿¡å·è¾“å…¥</span>
   TXæœªå¯åŠ¨æˆ–é“¾è·¯æ–­å¼€ï¼ŒRXæ²¡æœ‰æ•°æ®è¾“å…¥

5. <span class="bad">CDRå¸¦å®½é…ç½®é”™è¯¯</span>
   ç¯è·¯å¸¦å®½å¤ªçª„ï¼Œæ— æ³•è¿½è¸ªå¿«é€Ÿå˜åŒ–
                    </div>
                </div>

                <div class="visual-block" style="margin-top: 40px;">
                    <div class="visual-title">ğŸ¬ å®Œæ•´çš„PRBSæ•°æ®æµåŠ¨ç”»ï¼ˆæ— ç¼“å­˜ï¼‰</div>
                    <div class="code-block">
<span class="highlight">æ—¶åˆ»T0: ç³»ç»Ÿå¯åŠ¨</span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
TXç«¯:
  [å‚è€ƒæ—¶é’Ÿ156.25MHz] â†’ [PLLÃ—165] â†’ [TXæ—¶é’Ÿ25.78125GHz]
                                         â†“
                              [PRBS31 Generator]
                                         â†“
                          ç”Ÿæˆbitåºåˆ—: 1011001110...
                                         â†“
                              [SerDes TXæ¨¡æ‹Ÿå‰ç«¯]
                                         â†“
                          è½¬ä¸ºç”µä¿¡å·: +800mV, -800mV, ...
                                         â†“
                                   å‘é€åˆ°å…‰çº¤/é“œç¼†

RXç«¯:
  [SerDes RXæ¨¡æ‹Ÿå‰ç«¯] â† æ¥æ”¶å…‰çº¤/é“œç¼†ä¿¡å·
           â†“
    æ£€æµ‹åˆ°æ•°æ®è·³å˜
           â†“
   [CDR: æœªé”å®šï¼Œå¼€å§‹æœç´¢é¢‘ç‡]
           â†“
    VCOåˆå§‹é¢‘ç‡: 25.0 GHz (çŒœæµ‹å€¼)


<span class="highlight">æ—¶åˆ»T1: CDRé¢‘ç‡é”å®šï¼ˆ~1msåï¼‰</span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
RXç«¯:
  [CDR] â†’ æ£€æµ‹åˆ°æ•°æ®è·³å˜é¢‘ç‡ â‰ˆ 25.78 GHz
       â†’ è°ƒæ•´VCO â†’ 25.78125 GHz
       â†’ CDR_FREQ_LOCK = 1 âœ“

æ­¤æ—¶:
  TXæ—¶é’Ÿ: 25.78125 GHz
  RXæ—¶é’Ÿ: 25.78125 GHz <span class="good">â† é¢‘ç‡åŒ¹é…ï¼</span>


<span class="highlight">æ—¶åˆ»T2: CDRç›¸ä½é”å®šï¼ˆ~10msåï¼‰</span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
RXç«¯:
  [CDR] â†’ å¾®è°ƒç›¸ä½ï¼Œä½¿é‡‡æ ·ç‚¹å¯¹é½æ•°æ®ä¸­å¿ƒ
       â†’ CDR_PHASE_LOCK = 1 âœ“
       â†’ CDR_LOCK = 1 âœ“

TXå‘é€:  â”€â”€â”     â”Œâ”€â”€     â”€â”€â”     â”Œâ”€â”€
         1 â”‚     â”‚0      1 â”‚     â”‚0
           â””â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”˜
            â†‘ RXé‡‡æ ·ç‚¹ï¼ˆå®Œç¾å¯¹é½ï¼‰

<span class="good">æ­¤æ—¶RXå¯ä»¥å‡†ç¡®é‡‡æ ·æ¯ä¸€ä¸ªbitï¼</span>


<span class="highlight">æ—¶åˆ»T3: PRBSåŒæ­¥ï¼ˆ~100msåï¼‰</span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
RXç«¯:
  [PRBS31 Checker] â† æ¥æ”¶æ¢å¤çš„bitåºåˆ—
          â†“
    æœ¬åœ°ç”ŸæˆPRBS31åºåˆ—ï¼ˆå„ç§ç›¸ä½å°è¯•ï¼‰
          â†“
    æ‰¾åˆ°åŒ¹é…ç›¸ä½5000
          â†“
    PRBS_LOCK = 1 âœ“

æ­¤æ—¶å®Œæ•´æ•°æ®æµ:
TX: [PRBS Gen] â†’ [SerDes TX] â†’ å…‰çº¤ â†’ [SerDes RX] â†’ [PRBS Chk]
    bitç”Ÿæˆ     ç”µä¿¡å·å‘é€           ç”µä¿¡å·æ¥æ”¶    bitæ ¡éªŒ
      â†“            â†“                    â†“            â†“
    1011...     +800mV...            +800mV...    1011... âœ“
    
<span class="good">å…¨ç¨‹å®æ—¶ï¼Œæ— ä»»ä½•ç¼“å­˜ï¼</span>


<span class="highlight">æ—¶åˆ»T4: æŒç»­è¿è¡Œï¼ˆæ•°å°æ—¶ï¼‰</span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ¯ä¸ªæ—¶é’Ÿå‘¨æœŸï¼ˆ38.76 ps @25.78125GHzï¼‰ï¼š
  TX: ç”Ÿæˆ1 bit â†’ å‘é€
  RX: æ¥æ”¶1 bit â†’ CDRæ¢å¤æ—¶é’Ÿ â†’ é‡‡æ · â†’ æ¯”å¯¹

ç¤ºä¾‹ï¼šç¬¬1000äº¿ä¸ªbit
  TXç”Ÿæˆ: bit[100000000000] = 1
  TXå‘é€: +800mV
  å…‰çº¤ä¼ è¾“: ~5Î¼så»¶è¿Ÿ
  RXæ¥æ”¶: +800mV
  RXé‡‡æ ·: bit = 1
  RXæ¯”å¯¹: 1 == 1 â†’ <span class="good">æ­£ç¡® âœ“</span>
  
error_count = 93  (æå°‘é”™è¯¯)
total_count = 100000000000
BER = 9.3e-10 <span class="good">â† ä¼˜ç§€ï¼</span>


<span class="highlight">å…³é”®è§‚å¯Ÿï¼šæ•°æ®æµæ˜¯è¿ç»­çš„ã€å®æ—¶çš„</span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â€¢ TXæ¯38.76psç”Ÿæˆ1ä¸ªbitï¼Œ<span class="emphasis">æ— æ³•"æš‚åœ"</span>
â€¢ RXæ¯38.76psé‡‡æ ·1ä¸ªbitï¼Œ<span class="emphasis">æ— æ³•"ç¼“å­˜"</span>
â€¢ å¦‚æœRXé€Ÿç‡æ…¢äº†ï¼Œä¼š<span class="bad">ç›´æ¥æ¼bit</span>ï¼ˆæ— æ³•è¡¥æ•‘ï¼‰
â€¢ CDRä¿è¯RXé€Ÿç‡è‡ªåŠ¨è¿½è¸ªTXï¼Œ<span class="good">é¿å…æ¼bit</span>

<span class="emphasis">è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸éœ€è¦æµæ§å’Œç¼“å­˜ï¼</span>
                    </div>
                </div>

                <div class="warning-box" style="margin-top: 40px;">
                    <div class="warning-box-title">âš ï¸ å¸¸è§è¯¯åŒºæ¾„æ¸…</div>
                    <div class="code-block">
<span class="bad">âŒ è¯¯åŒº1ï¼š</span>"PRBSç±»ä¼¼ç½‘ç»œæ•°æ®åŒ…ï¼Œä¼šæœ‰ç¼“å­˜å’Œé‡ä¼ "
<span class="good">âœ… çœŸç›¸ï¼š</span>PRBSæ˜¯ç‰©ç†å±‚bitæµï¼Œæ— ç¼“å­˜ã€æ— é‡ä¼ ã€æ— åè®®


<span class="bad">âŒ è¯¯åŒº2ï¼š</span>"å¦‚æœTXå¿«RXæ…¢ï¼ŒRXä¼šå‘PAUSEå¸§è¦æ±‚TXæ…¢ä¸‹æ¥"
<span class="good">âœ… çœŸç›¸ï¼š</span>PAUSEå¸§æ˜¯ä»¥å¤ªç½‘MACå±‚æœºåˆ¶ï¼ŒPRBSåœ¨ç‰©ç†å±‚ï¼Œæ²¡æœ‰PAUSE


<span class="bad">âŒ è¯¯åŒº3ï¼š</span>"SerDeså†…éƒ¨è‚¯å®šæœ‰FIFOç¼“å­˜æ•°æ®"
<span class="good">âœ… çœŸç›¸ï¼š</span>SerDes TX/RXä¹‹é—´æ²¡æœ‰FIFOï¼Œæ•°æ®å®æ—¶ä¼ è¾“
            ï¼ˆæŸäº›ç³»ç»Ÿçš„FIFOåœ¨MACå±‚ï¼Œä¸åœ¨SerDesç‰©ç†å±‚ï¼‰


<span class="bad">âŒ è¯¯åŒº4ï¼š</span>"CDR Lockå¾ˆæ…¢ï¼Œåœ¨Lockä¹‹å‰çš„æ•°æ®ä¼šç¼“å­˜èµ·æ¥"
<span class="good">âœ… çœŸç›¸ï¼š</span>CDR Lockä¹‹å‰çš„æ•°æ®ç›´æ¥ä¸¢å¤±ï¼Œæ— æ³•æ¢å¤
            è¿™å°±æ˜¯ä¸ºä»€ä¹ˆPRBSæµ‹è¯•è¦ç­‰CDR Lockåæ‰å¼€å§‹ç»Ÿè®¡


<span class="bad">âŒ è¯¯åŒº5ï¼š</span>"PRBSå¯ä»¥åœ¨TX 10Gã€RX 25Gçš„é…ç½®ä¸‹æµ‹è¯•"
<span class="good">âœ… çœŸç›¸ï¼š</span>SerDesé€Ÿç‡å¿…é¡»å®Œå…¨åŒ¹é…ï¼Œå¦åˆ™CDRæ— æ³•Lock
            ä¸åŒé€Ÿç‡éœ€è¦ä¸åŒçš„SerDesé…ç½®ï¼ˆç‰©ç†ä¸Šä¸å…¼å®¹ï¼‰


<span class="highlight">å¯¹æ¯”ï¼šä»¥å¤ªç½‘æ•°æ®ä¼ è¾“ï¼ˆæœ‰ç¼“å­˜å’Œæµæ§ï¼‰</span>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ä»¥å¤ªç½‘å †æ ˆï¼ˆä»ä¸Šåˆ°ä¸‹ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åº”ç”¨å±‚: æ•°æ®åŒ…å‡†å¤‡                                      â”‚
â”‚   â†“                                                    â”‚
â”‚ TCPå±‚: æœ‰å‘é€çª—å£ã€æµæ§ã€é‡ä¼                           â”‚
â”‚   â†“                                                    â”‚
â”‚ IPå±‚: è·¯ç”±                                             â”‚
â”‚   â†“                                                    â”‚
â”‚ <span class="emphasis">MACå±‚: æœ‰TX FIFOï¼ˆå¦‚8KBï¼‰ã€RX FIFOï¼ˆå¦‚8KBï¼‰</span>        â”‚
â”‚   â†“     æœ‰PAUSEå¸§æµæ§æœºåˆ¶                              â”‚
â”‚   [TX FIFO] â†’ Serialize â†’ SerDes TX â†’ ç‰©ç†é“¾è·¯         â”‚
â”‚                                                        â”‚
â”‚   ç‰©ç†é“¾è·¯ â†’ SerDes RX â†’ Deserialize â†’ [RX FIFO]      â”‚
â”‚                            â†‘                           â”‚
â”‚                       <span class="good">è¿™é‡Œæœ‰ç¼“å­˜ï¼</span>                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PRBSæµ‹è¯•ï¼ˆæ—è·¯æ‰€æœ‰ä¸Šå±‚ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="emphasis">ç›´æ¥ä»PRBS Generator â†’ SerDes TX â†’ ç‰©ç†é“¾è·¯</span>         â”‚
â”‚ <span class="emphasis">ç‰©ç†é“¾è·¯ â†’ SerDes RX â†’ PRBS Checker</span>                â”‚
â”‚          â†‘                                             â”‚
â”‚     <span class="bad">æ— ç¼“å­˜ã€æ— MACã€æ— PAUSEï¼</span>                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    </div>
                </div>

                <div class="section-title" style="margin-top: 40px;">ğŸ“Š æ··åˆPRBSç±»å‹çš„åº”ç”¨åœºæ™¯</div>
				                <table class="comparison-table">  
                    <tr>  
                        <th>åœºæ™¯</th>  
                        <th>é…ç½®ç­–ç•¥</th>  
                        <th>ç›®çš„</th>  
                        <th>ä¼˜åŠ¿</th>  
                    </tr>  
                    <tr>  
                        <td><strong>åœºæ™¯1ï¼šå¿«é€ŸéªŒè¯</strong></td>  
                        <td>  
                            æ‰€æœ‰Laneä½¿ç”¨<span class="emphasis">PRBS7</span><br>  
                            â€¢ Lane 0-3: PRBS7  
                        </td>  
                        <td>  
                            â€¢ å¿«é€ŸLockï¼ˆ<1Î¼sï¼‰<br>  
                            â€¢ åˆæ­¥éªŒè¯é“¾è·¯  
                        </td>  
                        <td>  
                            <span class="good">âœ“ æµ‹è¯•æ—¶é—´çŸ­</span><br>  
                            <span class="good">âœ“ å¿«é€Ÿå‘ç°é—®é¢˜</span>  
                        </td>  
                    </tr>  
                    <tr>  
                        <td><strong>åœºæ™¯2ï¼šæ ‡å‡†æµ‹è¯•</strong></td>  
                        <td>  
                            æ‰€æœ‰Laneä½¿ç”¨<span class="emphasis">PRBS31</span><br>  
                            â€¢ Lane 0-3: PRBS31  
                        </td>  
                        <td>  
                            â€¢ é•¿å‘¨æœŸæµ‹è¯•<br>  
                            â€¢ ç¬¦åˆIEEEæ ‡å‡†  
                        </td>  
                        <td>  
                            <span class="good">âœ“ è¦†ç›–ç‡é«˜</span><br>  
                            <span class="good">âœ“ ä¸šç•Œæ ‡å‡†</span>  
                        </td>  
                    </tr>  
                    <tr>  
                        <td><strong>åœºæ™¯3ï¼šæ¸è¿›å¼æµ‹è¯•</strong></td>  
                        <td>  
                            ä¸åŒLaneé€’å¢å¤æ‚åº¦<br>  
                            â€¢ Lane 0: PRBS7<br>  
                            â€¢ Lane 1: PRBS15<br>  
                            â€¢ Lane 2: PRBS23<br>  
                            â€¢ Lane 3: PRBS31  
                        </td>  
                        <td>  
                            â€¢ é€æ­¥æé«˜æµ‹è¯•å¼ºåº¦<br>  
                            â€¢ å¯¹æ¯”ä¸åŒå‘¨æœŸçš„BER  
                        </td>  
                        <td>  
                            <span class="good">âœ“ å…¨é¢è¯„ä¼°</span><br>  
                            <span class="good">âœ“ å‘ç°å‘¨æœŸæ€§é—®é¢˜</span>  
                        </td>  
                    </tr>  
                    <tr>  
                        <td><strong>åœºæ™¯4ï¼šæ•…éšœè¯Šæ–­</strong></td>  
                        <td>  
                            é—®é¢˜Laneç”¨çŸ­PRBS<br>  
                            â€¢ Lane 0-2: PRBS31<br>  
                            â€¢ Lane 3: PRBS7ï¼ˆé—®é¢˜Laneï¼‰  
                        </td>  
                        <td>  
                            â€¢ å¿«é€Ÿå®šä½é—®é¢˜Lane<br>  
                            â€¢ PRBS7æ›´å®¹æ˜“Lock  
                        </td>  
                        <td>  
                            <span class="good">âœ“ å¿«é€Ÿè¯Šæ–­</span><br>  
                            <span class="good">âœ“ éš”ç¦»æ•…éšœ</span>  
                        </td>  
                    </tr>  
                    <tr>  
                        <td><strong>åœºæ™¯5ï¼šå·®å¼‚åŒ–å‹åŠ›æµ‹è¯•</strong></td>  
                        <td>  
                            å…³é”®Laneç”¨é•¿PRBS<br>  
                            â€¢ Lane 0: PRBS31ï¼ˆå…³é”®ï¼‰<br>  
                            â€¢ Lane 1-3: PRBS15  
                        </td>  
                        <td>  
                            â€¢ é‡ç‚¹æµ‹è¯•å…³é”®Lane<br>  
                            â€¢ å…¶ä»–Laneå¿«é€Ÿæµ‹è¯•  
                        </td>  
                        <td>  
                            <span class="good">âœ“ èµ„æºä¼˜åŒ–</span><br>  
                            <span class="good">âœ“ é’ˆå¯¹æ€§å¼º</span>  
                        </td>  
                    </tr>  
                </table>  

                <div class="section-title" style="margin-top: 40px;">âš™ï¸ å®é™…é…ç½®ä»£ç ç¤ºä¾‹</div>  
                
                <div class="code-block">  
<span class="highlight">ç¤ºä¾‹1ï¼šæ£€æµ‹CDR LockçŠ¶æ€ï¼ˆé€Ÿç‡åŒ¹é…çš„å‰æï¼‰</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
#include <stdio.h>  
#include <stdint.h>  
#include <stdbool.h>  
#include <unistd.h>  

// å¯„å­˜å™¨å®šä¹‰  
#define LANE_BASE(n)              (0x1000 + ((n) * 0x100))  
#define CDR_STATUS_OFFSET         0x10  
#define CDR_FREQ_OFFSET_OFFSET    0x14  
#define PRBS_TX_CTRL_OFFSET       0x00  
#define PRBS_RX_CTRL_OFFSET       0x04  
#define PRBS_STATUS_OFFSET        0x08  

// CDRçŠ¶æ€ä½å®šä¹‰  
#define CDR_LOCK_BIT              (1 << 0)  
#define CDR_FREQ_LOCK_BIT         (1 << 1)  
#define CDR_PHASE_LOCK_BIT        (1 << 2)  

// PRBSç±»å‹  
typedef enum {  
    PRBS7  = 0,  
    PRBS9  = 1,  
    PRBS11 = 2,  
    PRBS15 = 3,  
    PRBS23 = 4,  
    PRBS31 = 5  
} prbs_type_t;  

// æ¨¡æ‹Ÿå¯„å­˜å™¨è¯»å†™ï¼ˆå®é™…é¡¹ç›®ä¸­æ›¿æ¢ä¸ºçœŸå®é©±åŠ¨ï¼‰  
uint32_t read_reg(uint32_t addr) {  
    // å®é™…å®ç°ï¼šé€šè¿‡PCIe/AXIç­‰æ€»çº¿è¯»å–  
    // è¿™é‡Œæ¨¡æ‹Ÿè¿”å›å€¼  
    return 0;  
}  

void write_reg(uint32_t addr, uint32_t val) {  
    // å®é™…å®ç°ï¼šé€šè¿‡PCIe/AXIç­‰æ€»çº¿å†™å…¥  
    printf("  [REG_WRITE] Addr=0x%04X, Val=0x%08X\n", addr, val);  
}  

// æ£€æŸ¥å•ä¸ªLaneçš„CDR LockçŠ¶æ€  
bool check_cdr_lock(int lane) {  
    uint32_t base_addr = LANE_BASE(lane);  
    uint32_t cdr_status = read_reg(base_addr + CDR_STATUS_OFFSET);  
    
    bool cdr_lock = (cdr_status & CDR_LOCK_BIT) != 0;  
    bool freq_lock = (cdr_status & CDR_FREQ_LOCK_BIT) != 0;  
    bool phase_lock = (cdr_status & CDR_PHASE_LOCK_BIT) != 0;  
    
    int8_t freq_offset = (int8_t)((cdr_status >> 8) & 0xFF);  
    
    printf("Lane %d CDR Status:\n", lane);  
    printf("  CDR_LOCK:       %s\n", cdr_lock ? "<span class='good'>âœ“ LOCKED</span>" : "<span class='bad'>âœ— UNLOCKED</span>");  
    printf("  FREQ_LOCK:      %s\n", freq_lock ? "<span class='good'>âœ“</span>" : "<span class='bad'>âœ—</span>");  
    printf("  PHASE_LOCK:     %s\n", phase_lock ? "<span class='good'>âœ“</span>" : "<span class='bad'>âœ—</span>");  
    printf("  Freq Offset:    %+d ppm\n", freq_offset);  
    
    if (!cdr_lock) {  
        printf("  <span class='bad'>âš ï¸  WARNING: CDR not locked! Cannot proceed with PRBS test.</span>\n");  
    }  
    
    return cdr_lock;  
}  

// ç­‰å¾…æ‰€æœ‰Laneçš„CDR Lock  
bool wait_all_cdr_lock(int num_lanes, uint32_t timeout_ms) {  
    printf("\n<span class='highlight'>Waiting for CDR Lock on all lanes...</span>\n");  
    
    uint32_t elapsed = 0;  
    bool all_locked = false;  
    
    while (elapsed < timeout_ms) {  
        all_locked = true;  
        
        for (int lane = 0; lane < num_lanes; lane++) {  
            if (!check_cdr_lock(lane)) {  
                all_locked = false;  
            }  
        }  
        
        if (all_locked) {  
            printf("\n<span class='good'>âœ“ All CDR locked! (Time: %u ms)</span>\n", elapsed);  
            return true;  
        }  
        
        usleep(100000);  // ç­‰å¾…100ms  
        elapsed += 100;  
        printf("  ... %u ms elapsed\n", elapsed);  
    }  
    
    printf("\n<span class='bad'>âœ— TIMEOUT: Not all CDR locked after %u ms</span>\n", timeout_ms);  
    return false;  
}  

// é…ç½®PRBSï¼ˆåœ¨CDR Lockä¹‹åï¼‰  
void configure_prbs(int lane, prbs_type_t type) {  
    uint32_t base_addr = LANE_BASE(lane);  
    
    // é¦–å…ˆç¡®è®¤CDRå·²Lock  
    if (!check_cdr_lock(lane)) {  
        printf("<span class='bad'>ERROR: Lane %d CDR not locked! Cannot configure PRBS.</span>\n", lane);  
        return;  
    }  
    
    // é…ç½®TXç«¯PRBS  
    uint32_t tx_ctrl = (type << 4) | 0x01;  // Type + Enable  
    write_reg(base_addr + PRBS_TX_CTRL_OFFSET, tx_ctrl);  
    
    // é…ç½®RXç«¯PRBS  
    uint32_t rx_ctrl = (type << 4) | 0x01;  // Type + Enable  
    write_reg(base_addr + PRBS_RX_CTRL_OFFSET, rx_ctrl);  
    
    const char *type_names[] = {"PRBS7", "PRBS9", "PRBS11", "PRBS15", "PRBS23", "PRBS31"};  
    printf("Lane %d: Configured as %s\n", lane, type_names[type]);  
}  

// å®Œæ•´çš„æµ‹è¯•æµç¨‹  
int main(void) {  
    printf("<span class='highlight'>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>\n");  
    printf("<span class='highlight'>PRBS Test with CDR Lock Check</span>\n");  
    printf("<span class='highlight'>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>\n\n");  
    
    const int NUM_LANES = 4;  
    
    // <span class='emphasis'>æ­¥éª¤1ï¼šåˆå§‹åŒ–SerDesï¼ˆç”±ç¡¬ä»¶/é©±åŠ¨å®Œæˆï¼‰</span>  
    printf("<span class='highlight'>Step 1: Initialize SerDes...</span>\n");  
    printf("  - Configure SerDes speed: 25.78125 Gbps\n");  
    printf("  - Configure reference clock: 156.25 MHz\n");  
    printf("  - Enable TX/RX\n");  
    usleep(100000);  // ç­‰å¾…ç¡¬ä»¶åˆå§‹åŒ–  
    printf("  <span class='good'>âœ“ SerDes initialized</span>\n\n");  
    
    // <span class='emphasis'>æ­¥éª¤2ï¼šç­‰å¾…CDR Lockï¼ˆå…³é”®ï¼ï¼‰</span>  
    printf("<span class='highlight'>Step 2: Wait for CDR Lock...</span>\n");  
    if (!wait_all_cdr_lock(NUM_LANES, 5000)) {  // 5ç§’è¶…æ—¶  
        printf("<span class='bad'>FATAL: CDR Lock failed! Check:</span>\n");  
        printf("  1. TX/RX speed configuration match?\n");  
        printf("  2. Reference clock frequency correct?\n");  
        printf("  3. Physical link connected?\n");  
        printf("  4. Signal quality adequate?\n");  
        return -1;  
    }  
    printf("\n");  
    
    // <span class='emphasis'>æ­¥éª¤3ï¼šé…ç½®PRBSï¼ˆæ··åˆç±»å‹ï¼‰</span>  
    printf("<span class='highlight'>Step 3: Configure PRBS (Mixed Types)...</span>\n");  
    configure_prbs(0, PRBS7);  
    configure_prbs(1, PRBS15);  
    configure_prbs(2, PRBS23);  
    configure_prbs(3, PRBS31);  
    printf("\n");  
    
    // <span class='emphasis'>æ­¥éª¤4ï¼šç­‰å¾…PRBS Lock</span>  
    printf("<span class='highlight'>Step 4: Wait for PRBS Lock...</span>\n");  
    usleep(200000);  // ç­‰å¾…200msï¼ˆè€ƒè™‘PRBS31çš„Lockæ—¶é—´ï¼‰  
    
    for (int lane = 0; lane < NUM_LANES; lane++) {  
        uint32_t base_addr = LANE_BASE(lane);  
        uint32_t prbs_status = read_reg(base_addr + PRBS_STATUS_OFFSET);  
        bool prbs_lock = (prbs_status & 0x01) != 0;  
        
        printf("Lane %d PRBS: %s\n", lane,   
               prbs_lock ? "<span class='good'>âœ“ LOCKED</span>" : "<span class='bad'>âœ— UNLOCKED</span>");  
    }  
    printf("\n");  
    
    // <span class='emphasis'>æ­¥éª¤5ï¼šè¿è¡Œæµ‹è¯•</span>  
    printf("<span class='highlight'>Step 5: Running PRBS test (3600 seconds)...</span>\n");  
    printf("  Press Ctrl+C to stop early.\n\n");  
    
    sleep(3600);  // å®é™…æµ‹è¯•ä¸­å¯ä»¥ç”¨ä¿¡å·å¤„ç†æå‰é€€å‡º  
    
    printf("<span class='good'>âœ“ Test completed!</span>\n");  
    return 0;  
}  


<span class="highlight">ç¤ºä¾‹2ï¼šè¯Šæ–­CDR Lockå¤±è´¥</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
typedef struct {  
    const char *name;  
    bool (*check_func)(int lane);  
    const char *fix_hint;  
} cdr_diag_item_t;  

// æ£€æŸ¥SerDesé€Ÿç‡é…ç½®  
bool check_serdes_rate(int lane) {  
    uint32_t tx_rate_reg = read_reg(LANE_BASE(lane) + 0x20);  
    uint32_t rx_rate_reg = read_reg(LANE_BASE(lane) + 0x24);  
    
    uint32_t tx_rate = (tx_rate_reg >> 0) & 0xFF;  // é€Ÿç‡ç¼–ç   
    uint32_t rx_rate = (rx_rate_reg >> 0) & 0xFF;  
    
    printf("  TX Rate Code: 0x%02X\n", tx_rate);  
    printf("  RX Rate Code: 0x%02X\n", rx_rate);  
    
    if (tx_rate != rx_rate) {  
        printf("  <span class='bad'>âœ— TX/RX rate mismatch!</span>\n");  
        return false;  
    }  
    
    printf("  <span class='good'>âœ“ TX/RX rate match</span>\n");  
    return true;  
}  

// æ£€æŸ¥å‚è€ƒæ—¶é’Ÿ  
bool check_reference_clock(int lane) {  
    uint32_t ref_clk_reg = read_reg(LANE_BASE(lane) + 0x28);  
    uint32_t ref_freq = (ref_clk_reg >> 0) & 0xFFFF;  // é¢‘ç‡å€¼ï¼ˆkHzï¼‰  
    
    printf("  Reference Clock: %u kHz\n", ref_freq);  
    
    // æ£€æŸ¥æ˜¯å¦ä¸ºæ ‡å‡†é¢‘ç‡  
    const uint32_t valid_freqs[] = {156250, 312500, 625000};  // kHz  
    bool valid = false;  
    for (int i = 0; i < 3; i++) {  
        if (ref_freq == valid_freqs[i]) {  
            valid = true;  
            break;  
        }  
    }  
    
    if (!valid) {  
        printf("  <span class='bad'>âœ— Non-standard reference clock!</span>\n");  
        printf("    Expected: 156.25/312.5/625.0 MHz\n");  
        return false;  
    }  
    
    printf("  <span class='good'>âœ“ Valid reference clock</span>\n");  
    return true;  
}  

// æ£€æŸ¥ä¿¡å·æ£€æµ‹  
bool check_signal_detect(int lane) {  
    uint32_t sig_det_reg = read_reg(LANE_BASE(lane) + 0x2C);  
    bool rx_signal_detected = (sig_det_reg & 0x01) != 0;  
    int8_t signal_level = (int8_t)((sig_det_reg >> 8) & 0xFF);  // dBm  
    
    printf("  RX Signal Detect: %s\n",   
           rx_signal_detected ? "<span class='good'>âœ“ YES</span>" : "<span class='bad'>âœ— NO</span>");  
    printf("  Signal Level: %+d dBm\n", signal_level);  
    
    if (!rx_signal_detected) {  
        printf("  <span class='bad'>âœ— No signal detected!</span>\n");  
        return false;  
    }  
    
    if (signal_level < -15) {  // é˜ˆå€¼ç¤ºä¾‹  
        printf("  <span class='emphasis'>âš ï¸  Signal level low (might affect CDR)</span>\n");  
    }  
    
    printf("  <span class='good'>âœ“ Signal detected</span>\n");  
    return true;  
}  

// æ£€æŸ¥CDRé…ç½®  
bool check_cdr_config(int lane) {  
    uint32_t cdr_cfg_reg = read_reg(LANE_BASE(lane) + 0x30);  
    uint32_t cdr_bandwidth = (cdr_cfg_reg >> 0) & 0x07;  
    bool cdr_enabled = (cdr_cfg_reg & 0x80) != 0;  
    
    printf("  CDR Enabled: %s\n", cdr_enabled ? "<span class='good'>YES</span>" : "<span class='bad'>NO</span>");  
    printf("  CDR Bandwidth: %u (0=narrowest, 7=widest)\n", cdr_bandwidth);  
    
    if (!cdr_enabled) {  
        printf("  <span class='bad'>âœ— CDR is disabled!</span>\n");  
        return false;  
    }  
    
    printf("  <span class='good'>âœ“ CDR enabled</span>\n");  
    return true;  
}  

// CDRè¯Šæ–­ä¸»å‡½æ•°  
void diagnose_cdr_failure(int lane) {  
    printf("\n<span class='highlight'>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>\n");  
    printf("<span class='highlight'>Diagnosing CDR Lock Failure - Lane %d</span>\n", lane);  
    printf("<span class='highlight'>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>\n\n");  
    
    cdr_diag_item_t checks[] = {  
        {"SerDes Rate Match", check_serdes_rate,   
         "Configure TX and RX to same rate (e.g., both 25G)"},  
        {"Reference Clock", check_reference_clock,   
         "Use standard reference clock (156.25/312.5/625 MHz)"},  
        {"Signal Detection", check_signal_detect,   
         "Check physical link: cable, optical module, connectors"},  
        {"CDR Configuration", check_cdr_config,   
         "Enable CDR and set appropriate bandwidth"}  
    };  
    
    int num_checks = sizeof(checks) / sizeof(checks[0]);  
    int failed_checks = 0;  
    
    for (int i = 0; i < num_checks; i++) {  
        printf("<span class='emphasis'>Check %d: %s</span>\n", i+1, checks[i].name);  
        
        if (!checks[i].check_func(lane)) {  
            failed_checks++;  
            printf("  <span class='bad'>Fix:</span> %s\n", checks[i].fix_hint);  
        }  
        printf("\n");  
    }  
    
    printf("<span class='highlight'>Summary:</span>\n");  
    printf("  Total Checks: %d\n", num_checks);  
    printf("  Failed: %d\n", failed_checks);  
    
    if (failed_checks == 0) {  
        printf("  <span class='emphasis'>âš ï¸  All checks passed, but CDR still not locked.</span>\n");  
        printf("     Possible issues:\n");  
        printf("     - Signal quality too poor (high jitter/noise)\n");  
        printf("     - CDR PLL out of lock range\n");  
        printf("     - Hardware fault\n");  
        printf("     Recommendation: Check eye diagram with oscilloscope\n");  
    } else {  
        printf("  <span class='bad'>âœ— Fix the above issues and retry</span>\n");  
    }  
    
    printf("<span class='highlight'>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>\n\n");  
}  


<span class="highlight">ç¤ºä¾‹3ï¼šæ¨¡æ‹Ÿé€Ÿç‡ä¸åŒ¹é…åœºæ™¯</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
void simulate_rate_mismatch_test(void) {  
    printf("\n<span class='highlight'>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>\n");  
    printf("<span class='highlight'>Simulation: Rate Mismatch Scenario</span>\n");  
    printf("<span class='highlight'>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>\n\n");  
    
    printf("<span class='bad'>Scenario: TX=25G, RX=10G (WRONG!)</span>\n\n");  
    
    // é…ç½®TXä¸º25G  
    printf("<span class='emphasis'>TX Configuration:</span>\n");  
    printf("  SerDes Rate: 25.78125 Gbps\n");  
    printf("  PRBS Type: PRBS31\n");  
    printf("  TX Enable: <span class='good'>âœ“</span>\n");  
    printf("  TX Sending: 1011001110100111... @ 25.78125 Gbps\n\n");  
    
    // é…ç½®RXä¸º10Gï¼ˆé”™è¯¯ï¼ï¼‰  
    printf("<span class='emphasis'>RX Configuration:</span>\n");  
    printf("  SerDes Rate: 10.3125 Gbps <span class='bad'>â† WRONG!</span>\n");  
    printf("  PRBS Type: PRBS31\n");  
    printf("  RX Enable: <span class='good'>âœ“</span>\n\n");  
    
    // æ¨¡æ‹ŸCDRå°è¯•Lock  
    printf("<span class='emphasis'>CDR Behavior:</span>\n");  
    printf("  T=0ms:   CDR starts, VCO initial freq = 10.3 GHz\n");  
    printf("  T=1ms:   CDR detects data transitions\n");  
    printf("           Measured transition rate â‰ˆ 25.78 GHz\n");  
    printf("           <span class='emphasis'>âš ï¸  Frequency error = (25.78-10.3)/10.3 = 150%</span>\n");  
    printf("           <span class='bad'>âœ— Error too large! CDR cannot lock!</span>\n");  
    printf("  T=10ms:  CDR still trying...\n");  
    printf("           VCO trying to adjust, but 10Gâ†’25G is 2.5x\n");  
    printf("           <span class='bad'>âœ— Beyond PLL range (typically Â±10%%)</span>\n");  
    printf("  T=100ms: CDR gives up\n");  
    printf("           CDR_LOCK = 0 <span class='bad'>â† FAILED</span>\n\n");  
    
    // ç»“æœ  
    printf("<span class='emphasis'>Result:</span>\n");  
    printf("  CDR Status:    <span class='bad'>âœ— UNLOCKED</span>\n");  
    printf("  PRBS Status:   <span class='bad'>âœ— CANNOT TEST (CDR not locked)</span>\n");  
    printf("  BER:           <span class='bad'>N/A (no valid data received)</span>\n\n");  
    
    printf("<span class='highlight'>Conclusion:</span>\n");  
    printf("  <span class='bad'>TX and RX MUST be configured to the same rate!</span>\n");  
    printf("  SerDes physical layer does NOT support rate conversion.\n");  
    printf("  No buffering or flow control at this level.\n\n");  
    
    // æ­£ç¡®é…ç½®  
    printf("<span class='good'>Correct Configuration:</span>\n");  
    printf("  TX: 25.78125 Gbps\n");  
    printf("  RX: 25.78125 Gbps <span class='good'>â† SAME!</span>\n");  
    printf("  Result: CDR locks, PRBS test runs successfully\n");  
    
    printf("<span class='highlight'>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>\n");  
}  


<span class="highlight">ç¤ºä¾‹4ï¼šå¤šLaneæ··åˆPRBSç±»å‹é…ç½®ï¼ˆå®Œæ•´æµç¨‹ï¼‰</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
typedef struct {  
    int lane;  
    prbs_type_t type;  
    const char *name;  
    uint32_t expected_lock_time_ms;  // é¢„æœŸLockæ—¶é—´  
} lane_prbs_config_t;  

int run_mixed_prbs_test(void) {  
    // å®šä¹‰æ··åˆé…ç½®  
    lane_prbs_config_t configs[] = {  
        {0, PRBS7,  "PRBS7",  1},      // 1ms  
        {1, PRBS15, "PRBS15", 2},      // 2ms  
        {2, PRBS23, "PRBS23", 10},     // 10ms  
        {3, PRBS31, "PRBS31", 100}     // 100ms  
    };  
    int num_lanes = sizeof(configs) / sizeof(configs[0]);  
    
    printf("\n<span class='highlight'>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>\n");  
    printf("<span class='highlight'>Mixed PRBS Type Test</span>\n");  
    printf("<span class='highlight'>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>\n\n");  
    
    // æ‰“å°é…ç½®è¡¨  
    printf("<span class='emphasis'>Configuration:</span>\n");  
    printf("â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n");  
    printf("â”‚ Lane â”‚ Type    â”‚ Lock Time (ms) â”‚\n");  
    printf("â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n");  
    for (int i = 0; i < num_lanes; i++) {  
        printf("â”‚  %d   â”‚ %-7s â”‚      %-3u       â”‚\n",   
               configs[i].lane, configs[i].name, configs[i].expected_lock_time_ms);  
    }  
    printf("â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n");  
    
    // æ­¥éª¤1ï¼šæ£€æŸ¥CDR Lockï¼ˆæ‰€æœ‰Laneå¿…é¡»å…ˆLockï¼‰  
    printf("<span class='highlight'>Step 1: Verify CDR Lock (all lanes)...</span>\n");  
    if (!wait_all_cdr_lock(num_lanes, 5000)) {  
        printf("<span class='bad'>FATAL: CDR not locked, cannot proceed</span>\n");  
        return -1;  
    }  
    printf("\n");  
    
    // æ­¥éª¤2ï¼šé…ç½®PRBSï¼ˆæŒ‰Laneï¼‰  
    printf("<span class='highlight'>Step 2: Configure PRBS (mixed types)...</span>\n");  
    for (int i = 0; i < num_lanes; i++) {  
        configure_prbs(configs[i].lane, configs[i].type);  
    }  
    printf("\n");  
    
    // æ­¥éª¤3ï¼šç­‰å¾…PRBS Lockï¼ˆè€ƒè™‘æœ€æ…¢çš„Laneï¼‰  
    uint32_t max_lock_time = 0;  
    for (int i = 0; i < num_lanes; i++) {  
        if (configs[i].expected_lock_time_ms > max_lock_time) {  
            max_lock_time = configs[i].expected_lock_time_ms;  
        }  
    }  
    max_lock_time = max_lock_time * 2 + 100;  // åŠ è£•é‡  
    
    printf("<span class='highlight'>Step 3: Wait for PRBS Lock (max %u ms)...</span>\n", max_lock_time);  
    usleep(max_lock_time * 1000);  
    
    // æ£€æŸ¥æ¯ä¸ªLaneçš„PRBS LockçŠ¶æ€  
    bool all_prbs_locked = true;  
    for (int i = 0; i < num_lanes; i++) {  
        uint32_t base_addr = LANE_BASE(configs[i].lane);  
        uint32_t prbs_status = read_reg(base_addr + PRBS_STATUS_OFFSET);  
        bool prbs_lock = (prbs_status & 0x01) != 0;  
        
        printf("Lane %d (%s): %s\n", configs[i].lane, configs[i].name,  
               prbs_lock ? "<span class='good'>âœ“ PRBS LOCKED</span>" : "<span class='bad'>âœ— PRBS UNLOCKED</span>");  
        
        if (!prbs_lock) {  
            all_prbs_locked = false;  
        }  
    }  
    
    if (!all_prbs_locked) {  
        printf("\n<span class='bad'>ERROR: Not all lanes PRBS locked!</span>\n");  
        printf("Possible causes:\n");  
        printf("  1. TX/RX PRBS type mismatch\n");  
        printf("  2. Signal quality too poor\n");  
        printf("  3. Need more time for PRBS31 to lock\n");  
        return -1;  
    }  
    printf("\n<span class='good'>âœ“ All lanes PRBS locked!</span>\n\n");  
    
    // æ­¥éª¤4ï¼šè¿è¡Œæµ‹è¯•  
    printf("<span class='highlight'>Step 4: Running test (60 seconds)...</span>\n");  
    sleep(60);  
    
    // æ­¥éª¤5ï¼šè¯»å–ç»“æœ  
    printf("\n<span class='highlight'>Step 5: Results</span>\n");  
    printf("â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n");  
    printf("â”‚ Lane â”‚ Type    â”‚ Error Count  â”‚ Total Bits     â”‚ BER        â”‚\n");  
    printf("â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n");  
    
    for (int i = 0; i < num_lanes; i++) {  
        uint32_t base_addr = LANE_BASE(configs[i].lane);  
        uint64_t error_cnt = read_reg(base_addr + 0x20);  
        uint64_t total_cnt = read_reg(base_addr + 0x28);  
        double ber  = (total_cnt > 0) ? ((double)error_cnt / (double)total_cnt) : 0.0;  
        
        printf("â”‚  %d   â”‚ %-7s â”‚ %12llu â”‚ %14llu â”‚ %.2e â”‚\n",  
               configs[i].lane, configs[i].name, error_cnt, total_cnt, ber);  
    }  
    printf("â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n");  
    
    // åˆ†æï¼šæ‰¾å‡ºæœ€å·®Lane  
    double worst_ber = 0.0;  
    int worst_lane = -1;  
    for (int i = 0; i < num_lanes; i++) {  
        uint32_t base_addr = LANE_BASE(configs[i].lane);  
        uint64_t error_cnt = read_reg(base_addr + 0x20);  
        uint64_t total_cnt = read_reg(base_addr + 0x28);  
        double ber = (total_cnt > 0) ? ((double)error_cnt / (double)total_cnt) : 0.0;  
        
        if (ber > worst_ber) {  
            worst_ber = ber;  
            worst_lane = configs[i].lane;  
        }  
    }  
    
    printf("<span class='highlight'>Analysis:</span>\n");  
    printf("  Worst Lane: Lane %d (BER=%.2e)\n", worst_lane, worst_ber);  
    
    if (worst_ber <= 1e-12) {  
        printf("  <span class='good'>âœ“ ALL LANES PASS (BER â‰¤ 1e-12)</span>\n");  
    } else if (worst_ber <= 1e-9) {  
        printf("  <span class='emphasis'>âš ï¸  MARGINAL (1e-12 < BER â‰¤ 1e-9)</span>\n");  
        printf("     Consider: Adjust equalizer, check signal integrity\n");  
    } else {  
        printf("  <span class='bad'>âœ— FAIL (BER > 1e-9)</span>\n");  
        printf("     Action required: Diagnose Lane %d\n", worst_lane);  
    }  
    
    printf("\n<span class='highlight'>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>\n");  
    return 0;  
}  


<span class="highlight">ç¤ºä¾‹5ï¼šé€Ÿç‡ä¸åŒ¹é…çš„å®æ—¶ç›‘æ§</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
#include <time.h>  

typedef struct {  
    time_t timestamp;  
    bool cdr_lock;  
    int8_t freq_offset_ppm;  
    uint32_t lock_loss_count;  
} cdr_monitor_record_t;  

#define MAX_RECORDS 100  
cdr_monitor_record_t history[4][MAX_RECORDS];  // 4 lanes  
int record_index[4] = {0, 0, 0, 0};  

void monitor_cdr_realtime(int duration_sec) {  
    printf("\n<span class='highlight'>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>\n");  
    printf("<span class='highlight'>Real-time CDR Monitoring (%d seconds)</span>\n", duration_sec);  
    printf("<span class='highlight'>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>\n\n");  
    
    printf("Monitoring CDR stability...\n");  
    printf("Press Ctrl+C to stop.\n\n");  
    
    time_t start_time = time(NULL);  
    time_t last_print = start_time;  
    
    while (difftime(time(NULL), start_time) < duration_sec) {  
        // æ¯ç§’é‡‡æ ·ä¸€æ¬¡  
        if (difftime(time(NULL), last_print) >= 1.0) {  
            time_t now = time(NULL);  
            
            printf("[%s] ", ctime(&now));  
            
            for (int lane = 0; lane < 4; lane++) {  
                uint32_t base_addr = LANE_BASE(lane);  
                uint32_t cdr_status = read_reg(base_addr + CDR_STATUS_OFFSET);  
                
                bool cdr_lock = (cdr_status & CDR_LOCK_BIT) != 0;  
                int8_t freq_offset = (int8_t)((cdr_status >> 8) & 0xFF);  
                
                // è®°å½•å†å²  
                int idx = record_index[lane] % MAX_RECORDS;  
                history[lane][idx].timestamp = now;  
                history[lane][idx].cdr_lock = cdr_lock;  
                history[lane][idx].freq_offset_ppm = freq_offset;  
                
                // æ£€æµ‹Lockä¸¢å¤±  
                if (idx > 0) {  
                    int prev_idx = (idx - 1 + MAX_RECORDS) % MAX_RECORDS;  
                    if (history[lane][prev_idx].cdr_lock && !cdr_lock) {  
                        history[lane][idx].lock_loss_count =   
                            history[lane][prev_idx].lock_loss_count + 1;  
                    } else {  
                        history[lane][idx].lock_loss_count =   
                            history[lane][prev_idx].lock_loss_count;  
                    }  
                }  
                
                record_index[lane]++;  
                
                // æ‰“å°çŠ¶æ€  
                printf("L%d:%s(%+3dppm) ", lane,  
                       cdr_lock ? "<span class='good'>âœ“</span>" : "<span class='bad'>âœ—</span>",  
                       freq_offset);  
                
                // å¼‚å¸¸å‘Šè­¦  
                if (!cdr_lock) {  
                    printf("\n  <span class='bad'>âš ï¸  Lane %d CDR UNLOCK!</span>", lane);  
                } else if (abs(freq_offset) > 50) {  
                    printf("\n  <span class='emphasis'>âš ï¸  Lane %d Freq offset high: %+d ppm</span>",   
                           lane, freq_offset);  
                }  
            }  
            printf("\n");  
            
            last_print = now;  
        }  
        
        usleep(100000);  // 100msè½®è¯¢é—´éš”  
    }  
    
    // ç”ŸæˆæŠ¥å‘Š  
    printf("\n<span class='highlight'>Monitoring Report:</span>\n");  
    printf("â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n");  
    printf("â”‚ Lane â”‚ Lock Losses  â”‚ Avg Freq Offsetâ”‚ Status         â”‚\n");  
    printf("â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n");  
    
    for (int lane = 0; lane < 4; lane++) {  
        int total_records = (record_index[lane] < MAX_RECORDS) ?   
                            record_index[lane] : MAX_RECORDS;  
        
        if (total_records == 0) continue;  
        
        int last_idx = (record_index[lane] - 1) % MAX_RECORDS;  
        uint32_t lock_losses = history[lane][last_idx].lock_loss_count;  
        
        // è®¡ç®—å¹³å‡é¢‘å  
        int64_t sum_offset = 0;  
        for (int i = 0; i < total_records; i++) {  
            sum_offset += history[lane][i].freq_offset_ppm;  
        }  
        double avg_offset = (double)sum_offset / total_records;  
        
        printf("â”‚  %d   â”‚     %4u     â”‚    %+6.1f ppm   â”‚ ",   
               lane, lock_losses, avg_offset);  
        
        if (lock_losses == 0 && fabs(avg_offset) < 20) {  
            printf("<span class='good'>âœ“ STABLE</span>     â”‚\n");  
        } else if (lock_losses < 5 && fabs(avg_offset) < 50) {  
            printf("<span class='emphasis'>âš  MARGINAL</span>  â”‚\n");  
        } else {  
            printf("<span class='bad'>âœ— UNSTABLE</span>  â”‚\n");  
        }  
    }  
    printf("â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n");  
    
    printf("\n<span class='highlight'>Interpretation:</span>\n");  
    printf("  Lock Losses > 0:  CDR repeatedly lost lock (rate mismatch?)\n");  
    printf("  |Avg Offset| > 50 ppm:  Large frequency drift (clock issue?)\n");  
    printf("  Stable:  Good for PRBS testing\n");  
    printf("  Unstable:  Fix CDR issues before running PRBS test\n");  
}  


<span class="highlight">ç¤ºä¾‹6ï¼šå¯¹æ¯”æœ‰/æ— ç¼“å­˜çš„ç³»ç»Ÿè¡Œä¸º</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
void demonstrate_buffer_vs_no_buffer(void) {  
    printf("\n<span class='highlight'>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>\n");  
    printf("<span class='highlight'>Comparison: Buffered System vs PRBS (No Buffer)</span>\n");  
    printf("<span class='highlight'>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>\n\n");  
    
    // ========== åœºæ™¯1ï¼šä»¥å¤ªç½‘ç³»ç»Ÿï¼ˆæœ‰ç¼“å­˜ï¼‰ ==========  
    printf("<span class='emphasis'>Scenario 1: Ethernet System (WITH Buffer & Flow Control)</span>\n");  
    printf("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n");  
    
    printf("Architecture:\n");  
    printf("  [App] â†’ [TCP] â†’ [IP] â†’ <span class='good'>[MAC + TX FIFO 8KB]</span> â†’ [SerDes TX]\n");  
    printf("                                      â†‘\n");  
    printf("                               <span class='good'>Buffer exists!</span>\n\n");  
    
    printf("Behavior when rate mismatch:\n");  
    printf("  Time T0:  App sends 100 MB/s data\n");  
    printf("  Time T1:  MAC TX FIFO filling up...\n");  
    printf("            FIFO level: 2KB / 8KB\n");  
    printf("  Time T2:  MAC TX FIFO filling up...\n");  
    printf("            FIFO level: 6KB / 8KB\n");  
    printf("  Time T3:  MAC TX FIFO almost full!\n");  
    printf("            FIFO level: 7.5KB / 8KB\n");  
    printf("            <span class='emphasis'>â†’ MAC sends PAUSE frame to upstream</span>\n");  
    printf("  Time T4:  Upstream receives PAUSE, stops sending\n");  
    printf("            MAC TX FIFO draining...\n");  
    printf("            FIFO level: 4KB / 8KB\n");  
    printf("  Time T5:  FIFO level safe\n");  
    printf("            <span class='good'>â†’ MAC sends XON, resume transmission</span>\n\n");  
    
    printf("Result: <span class='good'>âœ“ No packet loss!</span> (Flow control works)\n\n");  
    
    // ========== åœºæ™¯2ï¼šPRBSç³»ç»Ÿï¼ˆæ— ç¼“å­˜ï¼‰ ==========  
    printf("<span class='emphasis'>Scenario 2: PRBS System (NO Buffer, NO Flow Control)</span>\n");  
    printf("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n");  
    
    printf("Architecture:\n");  
    printf("  [PRBS Gen] â†’ <span class='bad'>[NO FIFO]</span> â†’ [SerDes TX] â†’ Link â†’ [SerDes RX] â†’ [PRBS Chk]\n");  
    printf("                    â†‘\n");  
    printf("              <span class='bad'>Direct connection!</span>\n\n");  
    
    printf("Behavior when rate mismatch (TX=25G, RX=10G):\n");  
    printf("  Time T0:  TX generates bits @ 25 Gbps\n");  
    printf("            Bit stream: 1 0 1 1 0 0 1 1 1 0 ...\n");  
    printf("            Rate: 1 bit every 40 ps\n\n");  
    
    printf("  Time T1:  RX tries to sample @ 10 Gbps\n");  
    printf("            RX clock: 1 sample every 100 ps\n");  
    printf("            <span class='bad'>Mismatch: TX sends 2.5 bits while RX samples 1!</span>\n\n");  
    
    printf("  Detailed view:\n");  
    printf("  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n");  
    printf("  â”‚ Time    â”‚ TX Sends        â”‚ RX Samples      â”‚ Result     â”‚\n");  
    printf("  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n");  
    printf("  â”‚   0 ps  â”‚ bit[0] = 1      â”‚ <span class='good'>sample: 1</span>       â”‚ <span class='good'>âœ“ OK</span>       â”‚\n");  
    printf("  â”‚  40 ps  â”‚ bit[1] = 0      â”‚ (no sample)     â”‚            â”‚\n");  
    printf("  â”‚  80 ps  â”‚ bit[2] = 1      â”‚ (no sample)     â”‚            â”‚\n");  
    printf("  â”‚ 100 ps  â”‚                 â”‚ <span class='bad'>sample: ???</span>     â”‚ <span class='bad'>âœ— MISS</span>     â”‚\n");  
    printf("  â”‚ 120 ps  â”‚ bit[3] = 1      â”‚ (no sample)     â”‚            â”‚\n");  
    printf("  â”‚ 160 ps  â”‚ bit[4] = 0      â”‚ (no sample)     â”‚            â”‚\n");  
    printf("  â”‚ 200 ps  â”‚ bit[5] = 0      â”‚ <span class='bad'>sample: ???</span>     â”‚ <span class='bad'>âœ— MISS</span>     â”‚\n");  
    printf("  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n");  
    
    printf("  Time T2:  RX CDR cannot lock (frequency too different)\n");  
    printf("            CDR_LOCK = 0\n");  
    printf("            <span class='bad'>RX receives garbage data!</span>\n\n");  
    
    printf("Result: <span class='bad'>âœ— Complete failure!</span> (No buffer to compensate)\n\n");  
    
    // ========== å¯¹æ¯”æ€»ç»“ ==========  
    printf("<span class='highlight'>Summary Comparison:</span>\n");  
    printf("â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n");  
    printf("â”‚ Feature                â”‚ Ethernet (MAC)     â”‚ PRBS (PHY)         â”‚\n");  
    printf("â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n");  
    printf("â”‚ Buffer                 â”‚ <span class='good'>YES (FIFO)</span>        â”‚ <span class='bad'>NO</span>                 â”‚\n");  
    printf("â”‚ Flow Control           â”‚ <span class='good'>YES (PAUSE)</span>       â”‚ <span class='bad'>NO</span>                 â”‚\n");  
    printf("â”‚ Rate Tolerance         â”‚ <span class='good'>High</span>             â”‚ <span class='bad'>None (must match)</span>  â”‚\n");  
    printf("â”‚ Data Loss on Mismatch â”‚ <span class='good'>NO (flow control)</span> â”‚ <span class='bad'>YES (immediate)</span>    â”‚\n");  
    printf("â”‚ CDR Lock Required      â”‚ YES                â”‚ <span class='emphasis'>YES (critical!)</span>   â”‚\n");  
    printf("â”‚ Speed Flexibility      â”‚ <span class='good'>Good (buffer)</span>     â”‚ <span class='bad'>None (rigid)</span>       â”‚\n");  
    printf("â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n");  
    
    printf("<span class='highlight'>Key Takeaway:</span>\n");  
    printf("  <span class='emphasis'>PRBS operates at the physical layer (PHY) with NO buffering.</span>\n");  
    printf("  TX and RX clocks MUST be synchronized via CDR.\n");  
    printf("  Any rate mismatch = immediate failure (no recovery mechanism).\n");  
    printf("  This is why CDR Lock is a prerequisite for PRBS testing!\n\n");  
    
    printf("<span class='highlight'>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>\n");  
}  
                </div>  

                <div class="info-box" style="margin-top: 40px;">  
                    <div class="info-box-title">ğŸ“ æ·±åº¦ç†è§£ï¼šä¸ºä»€ä¹ˆç‰©ç†å±‚ä¸èƒ½æœ‰ç¼“å­˜</div>  
                    <div class="code-block">  
<span class="highlight">ç‰©ç†å±‚çš„æœ¬è´¨ï¼šå®æ—¶ä¿¡å·ä¼ è¾“</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  

<span class="emphasis">1. ç‰©ç†å±‚ä¼ è¾“çš„æ˜¯"è¿ç»­æ—¶é—´ä¿¡å·"</span>  

TXç«¯ï¼š  
  æ•°å­—bit '1' â†’ ç¼–ç  â†’ ç”µå‹ä¿¡å· +800mV  
  æ•°å­—bit '0' â†’ ç¼–ç  â†’ ç”µå‹ä¿¡å· -800mV  
  
  è¿™äº›ç”µå‹ä¿¡å·åœ¨<span class="emphasis">ä¼ è¾“ä»‹è´¨</span>ï¼ˆå…‰çº¤/é“œç¼†ï¼‰ä¸Š<span class="emphasis">è¿ç»­ä¼ æ’­</span>ï¼š  
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  
  â”‚   +800mV â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€                    â”‚  
  â”‚               â”‚           â”‚                         â”‚  
  â”‚  -800mV       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â† è¿ç»­æ³¢å½¢         â”‚  
  â”‚   ^           ^           ^           ^             â”‚  
  â”‚   0ps        40ps        80ps       120ps           â”‚  
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  

RXç«¯ï¼š  
  å¿…é¡»åœ¨<span class="emphasis">æ­£ç¡®çš„æ—¶åˆ»</span>é‡‡æ ·è¿™ä¸ªè¿ç»­ä¿¡å·  
  å¦‚æœæ—¶é’Ÿä¸å¯¹ï¼Œé‡‡æ ·ç‚¹åç§» â†’ é‡‡æ ·åˆ°é”™è¯¯å€¼  


<span class="emphasis">2. ä¸ºä»€ä¹ˆä¸èƒ½"ç¼“å­˜"ç‰©ç†ä¿¡å·ï¼Ÿ</span>  

å‡è®¾TXå‘é€ï¼š1 0 1 1 0ï¼ˆ5ä¸ªbitï¼‰  

å¦‚æœè¦"ç¼“å­˜"è¿™5ä¸ªbitï¼Œéœ€è¦ï¼š  
  a) å­˜å‚¨æ¯ä¸ªbitçš„<span class="emphasis">æ—¶é—´æˆ³</span>ï¼ˆä»€ä¹ˆæ—¶å€™å‘çš„ï¼‰  
  b) å­˜å‚¨æ¯ä¸ªbitçš„<span class="emphasis">å€¼</span>ï¼ˆ0æˆ–1ï¼‰  
  c) åœ¨RXç«¯æŒ‰<span class="emphasis">æ­£ç¡®çš„æ—¶é—´é—´éš”</span>é‡æ”¾  

ä½†é—®é¢˜æ˜¯ï¼š  
  â€¢ TXä»¥25 Gbpså‘é€ â†’ bité—´éš” = 40 psï¼ˆçš®ç§’ï¼ï¼‰  
  â€¢ <span class="bad">40 ps = 0.00000000004 ç§’ = 10^-11 ç§’</span>  
  â€¢ ç°ä»£æ•°å­—ç”µè·¯å¾ˆéš¾å®ç°å¦‚æ­¤ç²¾ç¡®çš„æ—¶é—´ç¼“å­˜  
  â€¢ å³ä½¿èƒ½å®ç°ï¼Œæˆæœ¬æé«˜ï¼Œä¸”å¼•å…¥å»¶è¿Ÿ  


<span class="emphasis">3. ç±»æ¯”ï¼šéŸ³é¢‘æµ vs æ•°å­—æ–‡ä»¶</span>  

<span class="good">æ•°å­—æ–‡ä»¶ï¼ˆç±»ä¼¼ä»¥å¤ªç½‘æœ‰ç¼“å­˜ï¼‰ï¼š</span>  
  â€¢ éŸ³ä¹æ–‡ä»¶.mp3 â†’ å¯ä»¥æš‚åœã€å¿«è¿›ã€ç¼“å­˜  
  â€¢ æ•°æ®ä»¥"åŒ…"çš„å½¢å¼å­˜å‚¨ï¼ˆç¦»æ•£çš„ï¼‰  
  â€¢ æ’­æ”¾é€Ÿåº¦å¯ä»¥è°ƒæ•´ï¼ˆæ…¢æ”¾ã€å¿«æ”¾ï¼‰  

<span class="bad">å®æ—¶éŸ³é¢‘æµï¼ˆç±»ä¼¼PRBSæ— ç¼“å­˜ï¼‰ï¼š</span>  
  â€¢ ç”µè¯é€šè¯ã€ç›´æ’­ â†’ å¿…é¡»å®æ—¶ä¼ è¾“  
  â€¢ å£°éŸ³ä»¥"è¿ç»­æ³¢å½¢"ä¼ è¾“  
  â€¢ å¦‚æœæ¥æ”¶ç«¯æ…¢äº† â†’ å£°éŸ³æ–­æ–­ç»­ç»­ï¼ˆæ— æ³•ç¼“å­˜è¡¥æ•‘ï¼‰  
  â€¢ <span class="emphasis">å¿…é¡»å‘é€ç«¯å’Œæ¥æ”¶ç«¯çš„"é‡‡æ ·ç‡"ä¸¥æ ¼ä¸€è‡´ï¼</span>  

PRBSå°±åƒå®æ—¶éŸ³é¢‘ï¼š  
  â€¢ æ¯”ç‰¹æµæ˜¯è¿ç»­çš„ã€å®æ—¶çš„  
  â€¢ ä¸èƒ½"æš‚åœ"æˆ–"ç¼“å­˜"  
  â€¢ TXå’ŒRXçš„"é‡‡æ ·ç‡"ï¼ˆæ—¶é’Ÿï¼‰å¿…é¡»ä¸€è‡´  


<span class="emphasis">4. å¦‚æœå¼ºè¡ŒåŠ å…¥FIFOä¼šæ€æ ·ï¼Ÿ</span>  

å‡è®¾åœ¨SerDes RXååŠ å…¥FIFOï¼š  
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  
â”‚ [SerDes RX] â†’ <span class="emphasis">[FIFO]</span> â†’ [PRBS Checker]             â”‚  
â”‚     â†‘            â†‘                                 â”‚  
â”‚  25G clock   éœ€è¦ç¼“å†²æ·±åº¦ï¼Ÿ                         â”‚  
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  

é—®é¢˜ï¼š  
  a) <span class="bad">FIFOå†™å…¥æ—¶é’Ÿ = SerDes RXæ—¶é’Ÿï¼ˆç”±CDRæ¢å¤ï¼‰</span>  
     å¦‚æœCDRæœªLockï¼Œå†™å…¥æ—¶é’Ÿä¸ç¨³å®š â†’ FIFOä¼šæº¢å‡º/æ¬ è½½  

  b) <span class="bad">FIFOè¯»å‡ºæ—¶é’Ÿ = æœ¬åœ°æ—¶é’Ÿ</span>  
     å¦‚æœæœ¬åœ°æ—¶é’Ÿ â‰  TXæ—¶é’Ÿ â†’ FIFOè¦ä¹ˆæ»¡ã€è¦ä¹ˆç©º  
     æœ€ç»ˆè¿˜æ˜¯éœ€è¦é€Ÿç‡åŒ¹é…ï¼  

  c) <span class="bad">å¼•å…¥é¢å¤–å»¶è¿Ÿå’ŒæŠ–åŠ¨</span>  
     PRBSæµ‹è¯•çš„ç›®çš„å°±æ˜¯æµ‹ç‰©ç†å±‚æ€§èƒ½  
     åŠ FIFOä¼šæ©ç›–çœŸå®é—®é¢˜  

ç»“è®ºï¼š<span class="emphasis">FIFOä¸è§£å†³æ ¹æœ¬é—®é¢˜ï¼ˆé€Ÿç‡ä¸åŒ¹é…ï¼‰ï¼Œåè€Œå¼•å…¥å‰¯ä½œç”¨</span>  


<span class="emphasis">5. CDRæ˜¯"è½¯ç¼“å­˜"</span>  

è™½ç„¶æ²¡æœ‰FIFOï¼Œä½†CDRæä¾›äº†ä¸€ç§"è½¯ç¼“å­˜"æœºåˆ¶ï¼š  
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  
â”‚ CDRé€šè¿‡<span class="emphasis">è°ƒæ•´æœ¬åœ°æ—¶é’Ÿé¢‘ç‡</span>æ¥"è¿½è¸ª"TXæ—¶é’Ÿ          â”‚  
â”‚ è¿™ç›¸å½“äºè®©RXçš„"é‡‡æ ·ç‡"è‡ªåŠ¨é€‚åº”TXçš„"å‘é€ç‡"      â”‚  
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  

å·¥ä½œåŸç†ï¼š  
  â€¢ TXæ—¶é’Ÿå¿«äº† â†’ CDRæ£€æµ‹åˆ° â†’ åŠ å¿«RXæ—¶é’Ÿ â†’ åŒæ­¥  
  â€¢ TXæ—¶é’Ÿæ…¢äº† â†’ CDRæ£€æµ‹åˆ° â†’ å‡æ…¢RXæ—¶é’Ÿ â†’ åŒæ­¥  

è¿™ç§"åŠ¨æ€è¿½è¸ª"åœ¨100ppmèŒƒå›´å†…æœ‰æ•ˆï¼š  
  â€¢ 25.78125 GHz Â± 100ppm = Â±2.578 MHz  
  â€¢ å¦‚æœè¯¯å·®è¶…è¿‡è¿™ä¸ªèŒƒå›´ â†’ CDRæ— æ³•è¿½è¸ª â†’ å¤±é”  


<span class="emphasis">6. æ€»ç»“ï¼šç‰©ç†å±‚çš„åˆšæ€§</span>  

<span class="highlight">ç‰©ç†å±‚ï¼ˆPHYï¼‰ç‰¹ç‚¹ï¼š</span>  
  â€¢ <span class="bad">åˆšæ€§</span>ï¼šé€Ÿç‡å¿…é¡»ä¸¥æ ¼åŒ¹é…ï¼Œå®¹å¿åº¦æå°ï¼ˆ<100ppmï¼‰  
  â€¢ <span class="bad">å®æ—¶</span>ï¼šæ•°æ®è¿ç»­ä¼ è¾“ï¼Œæ— æ³•æš‚åœæˆ–é‡ä¼   
  â€¢ <span class="bad">æ— åè®®</span>ï¼šæ²¡æœ‰æ¡æ‰‹ã€ç¡®è®¤ã€æµæ§ç­‰æœºåˆ¶  
  â€¢ <span class="good">é«˜æ•ˆ</span>ï¼šç›´è¿ï¼Œå»¶è¿Ÿæœ€å°ï¼Œååæœ€é«˜  
  â€¢ <span class="good">ç¡®å®šæ€§</span>ï¼šé€‚åˆæµ‹è¯•ç‰©ç†é“¾è·¯çš„çœŸå®æ€§èƒ½  

<span class="highlight">æ•°æ®é“¾è·¯å±‚åŠä»¥ä¸Šçš„ç‰¹ç‚¹ï¼š</span>  
  â€¢ <span class="good">æŸ”æ€§</span>ï¼šå¯ä»¥æœ‰é€Ÿç‡å·®å¼‚ï¼Œé€šè¿‡ç¼“å­˜å’Œæµæ§é€‚åº”  
  â€¢ <span class="good">å¯é </span>ï¼šæœ‰é‡ä¼ ã€ç¡®è®¤ã€é”™è¯¯çº æ­£  
  â€¢ <span class="good">æœ‰åè®®</span>ï¼šæœ‰å¸§ç»“æ„ã€åœ°å€ã€æ ¡éªŒç­‰  
  â€¢ <span class="bad">å¼€é”€</span>ï¼šæœ‰åè®®å¼€é”€ï¼Œå»¶è¿Ÿè¾ƒå¤§  
  â€¢ <span class="bad">ä¸ç¡®å®šæ€§</span>ï¼šç¼“å­˜ã€é‡ä¼ å¯¼è‡´å»¶è¿Ÿå˜åŒ–  

<span class="emphasis">PRBSæµ‹è¯•é€‰æ‹©å·¥ä½œåœ¨ç‰©ç†å±‚ï¼Œæ˜¯ä¸ºäº†ï¼š</span>  
  â€¢ ç›´æ¥æµ‹è¯•SerDesçš„çœŸå®æ€§èƒ½ï¼ˆæ— æ©ç›–ï¼‰  
  â€¢ é¿å…åè®®å¼€é”€çš„å½±å“  
  â€¢ ç²¾ç¡®è¯„ä¼°ç‰©ç†é“¾è·¯çš„è¯¯ç ç‡  
  â€¢ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¿…é¡»ä¸¥æ ¼ä¿è¯TX/RXé€Ÿç‡ä¸€è‡´ï¼  
                    </div>  
                </div>  

                <div class="section-title" style="margin-top: 50px;">ğŸ“š å®Œæ•´çŸ¥è¯†æ€»ç»“</div>  
                
                <div class="visual-block">  
                    <div class="visual-title">ğŸ¯ æ ¸å¿ƒè¦ç‚¹å›é¡¾</div>  
                    <div class="code-block">  
<span class="highlight">é—®é¢˜4æ ¸å¿ƒç­”æ¡ˆï¼š</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
<span class="good">âœ“ å®Œå…¨æ”¯æŒå„Laneå‘é€ä¸åŒç å‹</span>  
  â€¢ æ¯ä¸ªLaneæœ‰ç‹¬ç«‹çš„PRBS Generator/Checker  
  â€¢ Lane 0å¯ä»¥æ˜¯PRBS7ï¼ŒLane 1å¯ä»¥æ˜¯PRBS31ï¼Œäº’ä¸å¹²æ‰°  
  â€¢ RXç«¯æ¯ä¸ªLaneå¿…é¡»ç‹¬ç«‹é…ç½®åŒ¹é…çš„PRBSç±»å‹  

<span class="good">âœ“ å¤„ç†æ–¹å¼ï¼š</span>  
  1. TX/RXç«¯æ¯ä¸ªLaneå•ç‹¬é…ç½®å¯„å­˜å™¨  
  2. æ¯ä¸ªLaneç‹¬ç«‹Lockã€ç‹¬ç«‹ç»Ÿè®¡BER  
  3. è½¯ä»¶åˆ†åˆ«è¯»å–æ¯ä¸ªLaneçš„ç»“æœ  
  4. å¯ä»¥åŠ¨æ€åˆ‡æ¢å•ä¸ªLaneçš„PRBSç±»å‹  


<span class="highlight">æ‰©å±•çŸ¥è¯†ï¼šé€Ÿç‡åŒ¹é…ä¸ç¼“å­˜</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
<span class="bad">âœ— PRBSå±‚é¢ä¸å­˜åœ¨é€Ÿç‡ä¸åŒ¹é…é—®é¢˜</span>  
  â€¢ SerDes TX/RXé€Ÿç‡å¿…é¡»ä¸¥æ ¼ä¸€è‡´ï¼ˆç”±ç¡¬ä»¶é…ç½®å†³å®šï¼‰  
  â€¢ CDRè‡ªåŠ¨è¿½è¸ªTXæ—¶é’Ÿï¼ŒRXé€Ÿç‡ = TXé€Ÿç‡  
  â€¢ å¦‚æœé…ç½®ä¸åŒ¹é…ï¼ˆå¦‚TX=25G, RX=10Gï¼‰â†’ CDRæ— æ³•Lock  
  â€¢ <span class="emphasis">æ ¹æœ¬ä¸ä¼šè¿›å…¥PRBSæµ‹è¯•é˜¶æ®µ</span>  

<span class="bad">âœ— PRBSä¼ è¾“æ²¡æœ‰ç¼“å­˜</span>  
  â€¢ å·¥ä½œåœ¨ç‰©ç†å±‚ï¼Œæ•°æ®å®æ—¶ä¼ è¾“  
  â€¢ æ²¡æœ‰FIFOç¼“å†²  
  â€¢ æ²¡æœ‰æµæ§æœºåˆ¶ï¼ˆæ— PAUSEå¸§ï¼‰  
  â€¢ å¦‚æœå‡ºç°é€Ÿç‡åå·® â†’ æ•°æ®ç›´æ¥ä¸¢å¤±ï¼ˆæ— æ³•è¡¥æ•‘ï¼‰  

<span class="good">âœ“ CDRä¿è¯é€Ÿç‡è‡ªåŠ¨åŒ¹é…</span>  
  â€¢ RXçš„CDRä»æ•°æ®ä¸­æ¢å¤TXæ—¶é’Ÿ  
  â€¢ åŠ¨æ€è°ƒæ•´RXé‡‡æ ·æ—¶é’Ÿé¢‘ç‡/ç›¸ä½  
  â€¢ å®¹å¿èŒƒå›´ï¼šÂ±100 ppm  
  â€¢ è¶…å‡ºèŒƒå›´ â†’ CDR_LOCKå¤±è´¥  


<span class="highlight">å®é™…åº”ç”¨å»ºè®®ï¼š</span>  
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  
<span class="good">1. æµ‹è¯•å‰å¿…æ£€é¡¹ï¼š</span>  
   âœ“ ç¡®è®¤TX/RX SerDesé€Ÿç‡é…ç½®ä¸€è‡´  
   âœ“ ç¡®è®¤å‚è€ƒæ—¶é’Ÿé¢‘ç‡æ­£ç¡®  
   âœ“ ç­‰å¾…CDR Lockï¼ˆæ‰€æœ‰Laneï¼‰  
   âœ“ ç„¶åæ‰é…ç½®PRBS  

<span class="good">2. æ··åˆPRBSç±»å‹ä½¿ç”¨åœºæ™¯ï¼š</span>  
   âœ“ å¿«é€ŸéªŒè¯ï¼šå…¨éƒ¨ç”¨PRBS7ï¼ˆLockå¿«ï¼‰  
   âœ“ æ ‡å‡†æµ‹è¯•ï¼šå…¨éƒ¨ç”¨PRBS31ï¼ˆè¦†ç›–å…¨é¢ï¼‰  
   âœ“ æ¸è¿›æµ‹è¯•ï¼šä¸åŒLaneç”¨ä¸åŒPRBSï¼ˆå…¨é¢è¯„ä¼°ï¼‰  
   âœ“ æ•…éšœè¯Šæ–­ï¼šé—®é¢˜Laneç”¨çŸ­PRBSï¼ˆæ˜“Lockï¼‰  

<span class="good">3. è°ƒè¯•CDRé—®é¢˜ï¼š</span>  
   âœ“ æ£€æŸ¥SerDesé€Ÿç‡å¯„å­˜å™¨é…ç½®  
   âœ“ æ£€æŸ¥å‚è€ƒæ—¶é’Ÿé¢‘ç‡  
   âœ“ æ£€æŸ¥ä¿¡å·æ£€æµ‹çŠ¶æ€  
   âœ“ ç›‘æ§CDRé¢‘åï¼ˆæ­£å¸¸åº”<20ppmï¼‰  
   âœ“ å¿…è¦æ—¶ç”¨ç¤ºæ³¢å™¨æŸ¥çœ‹çœ¼å›¾  

<span class="good">4. ç†è§£åˆ†å±‚ï¼š</span>  
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  
   â”‚ åº”ç”¨å±‚ï¼šæœ‰å¤§ç¼“å­˜ã€æµæ§ã€é‡ä¼         â”‚ â† çµæ´»  
   â”‚ TCPå±‚ï¼šæœ‰çª—å£ã€æ‹¥å¡æ§åˆ¶            â”‚  
   â”‚ MACå±‚ï¼šæœ‰FIFOã€PAUSEå¸§             â”‚  
   â”‚ <span class="emphasis">PHYå±‚(PRBS)ï¼šæ— ç¼“å­˜ã€æ— æµæ§ã€åˆšæ€§</span>  â”‚ â† å®æ—¶  
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  
   
   PRBSæµ‹è¯•å·¥ä½œåœ¨æœ€åº•å±‚ â†’ æœ€ç›´æ¥ã€æœ€çœŸå®  
                    </div>  
                </div>  
            </div>  
        </div>  

    </div>  

    <script>  
        function switchTab(tabName) {  
            // éšè—æ‰€æœ‰å†…å®¹  
            document.querySelectorAll('.tab-content').forEach(content => {  
                content.classList.remove('active');  
            });  
            
            // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„activeçŠ¶æ€
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„å†…å®¹
            document.getElementById(tabName).classList.add('active');
            
            // æ¿€æ´»å¯¹åº”æŒ‰é’®
            event.target.classList.add('active');
        }

        // æ·»åŠ åŠ¨ç”»æ•ˆæœ
        document.querySelectorAll('.lane-box').forEach(box => {
            box.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-8px) scale(1.02)';
            });
            box.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0) scale(1)';
            });
        });

        // é¡µé¢åŠ è½½æ—¶çš„æ¬¢è¿åŠ¨ç”»
        window.addEventListener('load', function() {
            document.querySelectorAll('.main-section').forEach((section, index) => {
                setTimeout(() => {
                    section.style.animation = 'fadeIn 0.8s ease-out';
                }, index * 100);
            });
        });

        // ä»£ç å—é«˜äº®
        document.querySelectorAll('.code-block').forEach(block => {
            block.addEventListener('click', function(e) {
                if (e.target.tagName === 'SPAN' && e.target.classList.contains('highlight')) {
                    e.target.style.backgroundColor = '#fffacd';
                    setTimeout(() => {
                        e.target.style.backgroundColor = '';
                    }, 1000);
                }
            });
        });

        // æ·»åŠ å¤åˆ¶ä»£ç åŠŸèƒ½
        document.querySelectorAll('.code-block').forEach(block => {
            const copyBtn = document.createElement('button');
            copyBtn.textContent = 'ğŸ“‹ Copy';
            copyBtn.style.cssText = `
                position: absolute;
                top: 10px;
                right: 10px;
                background: #4CAF50;
                color: white;
                border: none;
                padding: 5px 10px;
                border-radius: 3px;
                cursor: pointer;
                font-size: 12px;
                opacity: 0;
                transition: opacity 0.3s;
            `;
            
            block.style.position = 'relative';
            block.appendChild(copyBtn);
            
            block.addEventListener('mouseenter', () => {
                copyBtn.style.opacity = '1';
            });
            
            block.addEventListener('mouseleave', () => {
                copyBtn.style.opacity = '0';
            });
            
            copyBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                const text = block.innerText.replace('ğŸ“‹ Copy', '');
                navigator.clipboard.writeText(text).then(() => {
                    copyBtn.textContent = 'âœ“ Copied!';
                    setTimeout(() => {
                        copyBtn.textContent = 'ğŸ“‹ Copy';
                    }, 2000);
                });
            });
        });

        // æ·»åŠ è¡¨æ ¼æ’åºåŠŸèƒ½
        document.querySelectorAll('.comparison-table th').forEach((header, index) => {
            if (index > 0) {  // è·³è¿‡ç¬¬ä¸€åˆ—ï¼ˆæ ‡é¢˜åˆ—ï¼‰
                header.style.cursor = 'pointer';
                header.title = 'Click to sort';
                
                header.addEventListener('click', function() {
                    const table = this.closest('table');
                    const tbody = table.querySelector('tbody') || table;
                    const rows = Array.from(tbody.querySelectorAll('tr')).slice(1);  // è·³è¿‡è¡¨å¤´
                    
                    const isAscending = this.classList.contains('sort-asc');
                    
                    // ç§»é™¤æ‰€æœ‰æ’åºæ ‡è®°
                    table.querySelectorAll('th').forEach(th => {
                        th.classList.remove('sort-asc', 'sort-desc');
                    });
                    
                    // æ·»åŠ å½“å‰æ’åºæ ‡è®°
                    this.classList.add(isAscending ? 'sort-desc' : 'sort-asc');
                    
                    rows.sort((a, b) => {
                        const aText = a.cells[index].innerText;
                        const bText = b.cells[index].innerText;
                        return isAscending ? 
                            bText.localeCompare(aText) : 
                            aText.localeCompare(bText);
                    });
                    
                    rows.forEach(row => tbody.appendChild(row));
                });
            }
        });

        // æ·»åŠ æ»šåŠ¨è¿›åº¦æŒ‡ç¤ºå™¨
        const progressBar = document.createElement('div');
        progressBar.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            height: 3px;
            background: linear-gradient(90deg, #4CAF50, #2196F3);
            width: 0%;
            z-index: 9999;
            transition: width 0.1s;
        `;
        document.body.appendChild(progressBar);

        window.addEventListener('scroll', () => {
            const windowHeight = window.innerHeight;
            const documentHeight = document.documentElement.scrollHeight - windowHeight;
            const scrolled = window.scrollY;
            const progress = (scrolled / documentHeight) * 100;
            progressBar.style.width = progress + '%';
        });

        // æ·»åŠ "å›åˆ°é¡¶éƒ¨"æŒ‰é’®
        const backToTop = document.createElement('button');
        backToTop.innerHTML = 'â†‘';
        backToTop.style.cssText = `
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        `;
        document.body.appendChild(backToTop);

        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {
                backToTop.style.opacity = '1';
            } else {
                backToTop.style.opacity = '0';
            }
        });

        backToTop.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        backToTop.addEventListener('mouseenter', () => {
            backToTop.style.transform = 'scale(1.1)';
        });

        backToTop.addEventListener('mouseleave', () => {
            backToTop.style.transform = 'scale(1)';
        });

        // æ·»åŠ é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', (e) => {
            // Alt + æ•°å­—é”®åˆ‡æ¢æ ‡ç­¾é¡µ
            if (e.altKey && e.key >= '1' && e.key <= '4') {
                const tabs = ['overview', 'detection', 'start-position', 'mixed-types'];
                const tabName = tabs[parseInt(e.key) - 1];
                document.getElementById(tabName).classList.add('active');
                document.querySelectorAll('.tab-content').forEach(content => {
                    if (content.id !== tabName) {
                        content.classList.remove('active');
                    }
                });
                document.querySelectorAll('.tab-btn').forEach((btn, index) => {
                    btn.classList.toggle('active', index === parseInt(e.key) - 1);
                });
            }
            
            // Ctrl + F æœç´¢
            if (e.ctrlKey && e.key === 'f') {
                e.preventDefault();
                const searchTerm = prompt('Search for:');
                if (searchTerm) {
                    window.find(searchTerm);
                }
            }
        });

        // æ·»åŠ æ‰“å°æ ·å¼
        const printStyle = document.createElement('style');
        printStyle.textContent = `
            @media print {
                .tab-buttons,
                button,
                .back-to-top {
                    display: none !important;
                }
                
                .tab-content {
                    display: block !important;
                    page-break-inside: avoid;
                }
                
                .lane-box,
                .code-block,
                .info-box,
                .warning-box {
                    page-break-inside: avoid;
                    border: 1px solid #000 !important;
                }
                
                body {
                    background: white !important;
                    color: black !important;
                }
            }
        `;
        document.head.appendChild(printStyle);

        // æ·»åŠ æš—é»‘æ¨¡å¼åˆ‡æ¢
        const darkModeToggle = document.createElement('button');
        darkModeToggle.innerHTML = 'ğŸŒ™';
        darkModeToggle.title = 'Toggle Dark Mode';
        darkModeToggle.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: #333;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            transition: transform 0.3s;
        `;
        document.body.appendChild(darkModeToggle);

        let isDarkMode = false;
        darkModeToggle.addEventListener('click', () => {
            isDarkMode = !isDarkMode;
            document.body.style.filter = isDarkMode ? 'invert(1) hue-rotate(180deg)' : 'none';
            darkModeToggle.innerHTML = isDarkMode ? 'â˜€ï¸' : 'ğŸŒ™';
            
            // ä¿æŒå›¾ç‰‡å’ŒæŸäº›å…ƒç´ ä¸åè‰²
            document.querySelectorAll('img, .lane-box').forEach(el => {
                el.style.filter = isDarkMode ? 'invert(1) hue-rotate(180deg)' : 'none';
            });
        });

        darkModeToggle.addEventListener('mouseenter', () => {
            darkModeToggle.style.transform = 'rotate(20deg) scale(1.1)';
        });

        darkModeToggle.addEventListener('mouseleave', () => {
            darkModeToggle.style.transform = 'rotate(0deg) scale(1)';
        });

        // æ·»åŠ å¿«æ·é”®æç¤º
        const helpButton = document.createElement('button');
        helpButton.innerHTML = '?';
        helpButton.title = 'Keyboard Shortcuts';
        helpButton.style.cssText = `
            position: fixed;
            top: 70px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: #2196F3;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        `;
        document.body.appendChild(helpButton);

        helpButton.addEventListener('click', () => {
            alert(`Keyboard Shortcuts:
            
Alt + 1-4: Switch between tabs
Ctrl + F: Search in page
â†‘/â†“: Scroll
Home/End: Jump to top/bottom

Mouse:
Click code blocks to highlight
Hover over lane boxes for animation
Click table headers to sort`);
        });

        // æ·»åŠ å®æ—¶æ—¶é—´æ˜¾ç¤º
        const timeDisplay = document.createElement('div');
        timeDisplay.style.cssText = `
            position: fixed;
            top: 120px;
            right: 20px;
            padding: 10px;
            background: rgba(255,255,255,0.9);
            border-radius: 5px;
            font-size: 12px;
            font-family: 'Courier New', monospace;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
        `;
        document.body.appendChild(timeDisplay);

        function updateTime() {
            const now = new Date();
            timeDisplay.textContent = now.toLocaleTimeString();
        }
        updateTime();
        setInterval(updateTime, 1000);

        // æ·»åŠ é¡µé¢ç»Ÿè®¡ä¿¡æ¯
        const statsDisplay = document.createElement('div');
        statsDisplay.style.cssText = `
            position: fixed;
            bottom: 30px;
            left: 30px;
            padding: 15px;
            background: rgba(255,255,255,0.95);
            border-radius: 8px;
            font-size: 12px;
            font-family: 'Courier New', monospace;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            z-index: 1000;
            max-width: 200px;
        `;
        document.body.appendChild(statsDisplay);

        function updateStats() {
            const wordCount = document.body.innerText.split(/\s+/).length;
            const codeBlocks = document.querySelectorAll('.code-block').length;
            const tables = document.querySelectorAll('table').length;
            const sections = document.querySelectorAll('.main-section').length;
            
            statsDisplay.innerHTML = `
                <strong>ğŸ“Š Page Stats</strong><br>
                Words: ${wordCount.toLocaleString()}<br>
                Code Blocks: ${codeBlocks}<br>
                Tables: ${tables}<br>
                Sections: ${sections}
            `;
        }
        updateStats();

        // æ·»åŠ é˜…è¯»è¿›åº¦ä¿å­˜
        window.addEventListener('scroll', () => {
            localStorage.setItem('scrollPosition', window.scrollY);
        });

        // é¡µé¢åŠ è½½æ—¶æ¢å¤æ»šåŠ¨ä½ç½®
        window.addEventListener('load', () => {
            const savedPosition = localStorage.getItem('scrollPosition');
            if (savedPosition) {
                window.scrollTo(0, parseInt(savedPosition));
            }
        });

        // æ·»åŠ åŒå‡»æ–‡å­—é«˜äº®åŠŸèƒ½
        document.addEventListener('dblclick', (e) => {
            if (e.target.tagName === 'SPAN' || e.target.tagName === 'TD') {
                const selection = window.getSelection();
                const range = document.createRange();
                range.selectNodeContents(e.target);
                selection.removeAllRanges();
                selection.addRange(range);
                
                // ä¸´æ—¶é«˜äº®
                const originalBg = e.target.style.backgroundColor;
                e.target.style.backgroundColor = '#ffeb3b';
                setTimeout(() => {
                    e.target.style.backgroundColor = originalBg;
                }, 2000);
            }
        });

        // æ§åˆ¶å°å½©è›‹
        console.log('%cğŸ‰ Welcome to PRBS Documentation! ', 
            'background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); color: white; font-size: 20px; padding: 10px;');
        console.log('%cKeyboard Shortcuts:', 'font-size: 14px; font-weight: bold;');
        console.log('Alt + 1-4: Switch tabs');
        console.log('Ctrl + F: Search');
        console.log('%cHave fun exploring! ğŸš€', 'color: #4CAF50; font-size: 12px;');

        // æ·»åŠ æ€§èƒ½ç›‘æ§
        window.addEventListener('load', () => {
            const perfData = performance.getEntriesByType('navigation')[0];
            console.log(`âš¡ Page Load Time: ${(perfData.loadEventEnd - perfData.fetchStart).toFixed(2)}ms`);
        });
    </script>

    <!-- æ·»åŠ é¢å¤–çš„CSSåŠ¨ç”» -->
    <style>
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        @keyframes slideIn {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* è¡¨æ ¼æ’åºæ ·å¼ */
        .comparison-table th.sort-asc::after {
            content: ' â–²';
            color: #4CAF50;
        }

        .comparison-table th.sort-desc::after {
            content: ' â–¼';
            color: #4CAF50;
        }

        /* ä»£ç å—è¯­æ³•é«˜äº®å¢å¼º */
        .code-block .keyword {
            color: #0000ff;
            font-weight: bold;
        }

        .code-block .string {
            color: #a31515;
        }

        .code-block .comment {
            color: #008000;
            font-style: italic;
        }

        .code-block .number {
            color: #098658;
        }

        /* å“åº”å¼è®¾è®¡å¢å¼º */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .tab-buttons {
                flex-direction: column;
            }

            .tab-btn {
                width: 100%;
                margin: 5px 0;
            }

            .lane-diagram {
                grid-template-columns: 1fr;
            }

            .comparison-table {
                font-size: 12px;
            }

            .comparison-table th,
            .comparison-table td {
                padding: 8px 4px;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 24px;
            }

            .code-block {
                font-size: 11px;
                padding: 10px;
            }

            .stats-box {
                flex-direction: column;
            }

            .stat-item {
                width: 100%;
                margin-bottom: 10px;
            }
        }

        /* æ‰“å°ä¼˜åŒ– */
        @page {
            margin: 2cm;
        }

        @media print {
            .no-print {
                display: none !important;
            }

            .code-block {
                page-break-inside: avoid;
            }

            .lane-box {
                page-break-inside: avoid;
            }

            a[href]:after {
                content: " (" attr(href) ")";
            }
        }

        /* è¾…åŠ©åŠŸèƒ½å¢å¼º */
        *:focus {
            outline: 2px solid #4CAF50;
            outline-offset: 2px;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0,0,0,0);
            white-space: nowrap;
            border-width: 0;
        }

        /* é«˜å¯¹æ¯”åº¦æ¨¡å¼æ”¯æŒ */
        @media (prefers-contrast: high) {
            .good {
                color: #000;
                background-color: #0f0;
            }

            .bad {
                color: #fff;
                background-color: #f00;
            }

            .emphasis {
                color: #000;
                background-color: #ff0;
            }
        }

        /* å‡å°‘åŠ¨ç”»æ¨¡å¼æ”¯æŒ */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation: none !important;
                transition: none !important;
            }
        }
    </style>

</body>
</html>