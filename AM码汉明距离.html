<!DOCTYPE html>  
<html lang="zh-CN">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>AMç æ±‰æ˜è·ç¦» - åŸç†ä¸å¯è§†åŒ–</title>  
    <style>  
        * {  
            margin: 0;  
            padding: 0;  
            box-sizing: border-box;  
        }  

        body {  
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;  
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);  
            padding: 20px;  
            min-height: 100vh;  
            color: #333;  
        }  

        .container {  
            max-width: 1400px;  
            margin: 0 auto;  
            background: rgba(255, 255, 255, 0.98);  
            border-radius: 20px;  
            padding: 40px;  
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);  
        }  

        h1 {  
            text-align: center;  
            color: #667eea;  
            margin-bottom: 10px;  
            font-size: 2.5em;  
        }  

        .subtitle {  
            text-align: center;  
            color: #7f8c8d;  
            margin-bottom: 40px;  
            font-size: 1.2em;  
        }  

        .theory-section {  
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);  
            border-left: 5px solid #2196f3;  
            padding: 25px;  
            border-radius: 10px;  
            margin-bottom: 30px;  
        }  

        .theory-section h2 {  
            color: #1565c0;  
            margin-bottom: 15px;  
            display: flex;  
            align-items: center;  
            gap: 10px;  
        }  

        .theory-section p {  
            color: #0d47a1;  
            line-height: 1.8;  
            margin-bottom: 15px;  
        }  

        .highlight-box {  
            background: #fff3cd;  
            border-left: 4px solid #ffc107;  
            padding: 15px;  
            margin: 15px 0;  
            border-radius: 6px;  
        }  

        .highlight-box strong {  
            color: #f57c00;  
        }  

        .formula-box {  
            background: #2c3e50;  
            color: #00ff00;  
            padding: 20px;  
            border-radius: 10px;  
            font-family: 'Courier New', monospace;  
            font-size: 16px;  
            margin: 20px 0;  
            overflow-x: auto;  
            white-space: pre-wrap;  /* å…³é”®ï¼šä¿æŒæ¢è¡Œ */  
            line-height: 1.8;       /* å¢åŠ è¡Œé«˜ */  
        }  

        .demo-section {  
            background: white;  
            border-radius: 15px;  
            padding: 30px;  
            margin: 30px 0;  
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);  
        }  

        .demo-title {  
            font-size: 1.8em;  
            color: #667eea;  
            margin-bottom: 20px;  
            padding-bottom: 10px;  
            border-bottom: 3px solid #667eea;  
        }  

        .controls {  
            display: flex;  
            gap: 15px;  
            margin-bottom: 25px;  
            flex-wrap: wrap;  
            justify-content: center;  
        }  

        .btn {  
            padding: 12px 25px;  
            border: none;  
            border-radius: 8px;  
            font-weight: bold;  
            cursor: pointer;  
            transition: all 0.3s ease;  
            font-size: 1em;  
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);  
        }  

        .btn-primary {  
            background: linear-gradient(135deg, #667eea, #764ba2);  
            color: white;  
        }  

        .btn-success {  
            background: linear-gradient(135deg, #2ecc71, #27ae60);  
            color: white;  
        }  

        .btn-warning {  
            background: linear-gradient(135deg, #f39c12, #e67e22);  
            color: white;  
        }  

        .btn-danger {  
            background: linear-gradient(135deg, #e74c3c, #c0392b);  
            color: white;  
        }  

        .btn:hover {  
            transform: translateY(-3px);  
            box-shadow: 0 6px 15px rgba(0,0,0,0.3);  
        }  

        .btn:active {  
            transform: translateY(0);  
        }  

        .btn:disabled {  
            opacity: 0.5;  
            cursor: not-allowed;  
            transform: none;  
        }  

        /* æ‰‹åŠ¨è¾“å…¥åŒºåŸŸ */  
        .input-section {  
            background: #f8f9fa;  
            border-radius: 12px;  
            padding: 25px;  
            margin: 25px 0;  
            border: 2px dashed #667eea;  
        }  

        .input-group {  
            margin: 20px 0;  
        }  

        .input-label {  
            font-weight: bold;  
            color: #2c3e50;  
            margin-bottom: 10px;  
            display: block;  
            font-size: 1.1em;  
        }  

        .input-textarea {  
            width: 100%;  
            min-height: 120px;  
            padding: 15px;  
            border: 2px solid #bdc3c7;  
            border-radius: 8px;  
            font-family: 'Courier New', monospace;  
            font-size: 14px;  
            resize: vertical;  
            transition: all 0.3s ease;  
        }  

        .input-textarea:focus {  
            outline: none;  
            border-color: #667eea;  
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);  
        }  

        .input-textarea.error {  
            border-color: #e74c3c;  
            background: #fee;  
        }  

        .input-hint {  
            font-size: 0.9em;  
            color: #7f8c8d;  
            margin-top: 8px;  
        }  

        .input-format-select {  
            display: flex;  
            gap: 15px;  
            margin: 15px 0;  
            flex-wrap: wrap;  
        }  

        .format-option {  
            display: flex;  
            align-items: center;  
            gap: 8px;  
        }  

        .format-option input[type="radio"] {  
            width: 20px;  
            height: 20px;  
            cursor: pointer;  
        }  

        .format-option label {  
            cursor: pointer;  
            font-size: 1em;  
        }  

        /* AMç é€‰æ‹©åŒºåŸŸ */  
        .am-matrix {  
            display: grid;  
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));  
            gap: 20px;  
            margin: 25px 0;  
        }  

        .am-card {  
            background: #f8f9fa;  
            border-radius: 12px;  
            padding: 20px;  
            border: 2px solid #dee2e6;  
            transition: all 0.3s ease;  
            cursor: pointer;  
        }  

        .am-card:hover {  
            transform: translateY(-5px);  
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);  
            border-color: #667eea;  
        }  

        .am-card.selected {  
            background: #e3f2fd;  
            border-color: #2196f3;  
            box-shadow: 0 0 20px rgba(33, 150, 243, 0.4);  
        }  

        .am-card.reference {  
            background: #d4edda;  
            border-color: #28a745;  
            box-shadow: 0 0 20px rgba(40, 167, 69, 0.4);  
        }  

        .lane-label {  
            font-size: 1.3em;  
            font-weight: bold;  
            color: #667eea;  
            margin-bottom: 15px;  
            display: flex;  
            align-items: center;  
            gap: 8px;  
        }  

        .pattern-display {  
            font-family: 'Courier New', monospace;  
            background: #2c3e50;  
            color: #00ff00;  
            padding: 12px;  
            border-radius: 6px;  
            margin: 8px 0;  
            font-size: 13px;  
            overflow-x: auto;  
        }  

        .binary-display {  
            font-family: 'Courier New', monospace;  
            font-size: 11px;  
            color: #34495e;  
            margin: 5px 0;  
            word-break: break-all;  
            line-height: 1.6;  
        }  

        .hamming-result {  
            background: white;  
            border-radius: 10px;  
            padding: 20px;  
            margin: 25px 0;  
            border: 2px solid #667eea;  
        }  

        .hamming-grid {  
            display: grid;  
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));  
            gap: 10px;  
            margin: 20px 0;  
        }  

        .hamming-cell {  
            padding: 15px;  
            border-radius: 8px;  
            text-align: center;  
            font-weight: bold;  
            transition: all 0.3s ease;  
            cursor: pointer;  
        }  

        .hamming-cell:hover {  
            transform: scale(1.05);  
        }  

        .hamming-high {  
            background: linear-gradient(135deg, #2ecc71, #27ae60);  
            color: white;  
        }  

        .hamming-medium {  
            background: linear-gradient(135deg, #f39c12, #e67e22);  
            color: white;  
        }  

        .hamming-low {  
            background: linear-gradient(135deg, #e74c3c, #c0392b);  
            color: white;  
        }  

        .bit-comparison {  
            display: flex;  
            flex-direction: column;  
            gap: 10px;  
            margin: 20px 0;  
        }  

        .bit-row {  
            display: flex;  
            gap: 3px;  
            align-items: center;  
            flex-wrap: wrap;  
        }  

        .bit-row-label {  
            min-width: 120px;  
            font-weight: bold;  
            color: #2c3e50;  
        }  

        .bit-box {  
            width: 25px;  
            height: 25px;  
            display: flex;  
            align-items: center;  
            justify-content: center;  
            border-radius: 4px;  
            font-family: 'Courier New', monospace;  
            font-weight: bold;  
            font-size: 12px;  
        }  

        .bit-same {  
            background: #d4edda;  
            color: #155724;  
            border: 1px solid #c3e6cb;  
        }  

        .bit-diff {  
            background: #f8d7da;  
            color: #721c24;  
            border: 1px solid #f5c6cb;  
            animation: blink 0.5s ease;  
        }  

        @keyframes blink {  
            0%, 100% { opacity: 1; }  
            50% { opacity: 0.5; }  
        }  

        .stats-panel {  
            background: #ecf0f1;  
            border-radius: 10px;  
            padding: 20px;  
            margin: 20px 0;  
        }  

        .stat-item {  
            display: flex;  
            justify-content: space-between;  
            padding: 12px;  
            margin: 8px 0;  
            background: white;  
            border-radius: 6px;  
            border-left: 4px solid #667eea;  
        }  

        .stat-label {  
            font-weight: bold;  
            color: #2c3e50;  
        }  

        .stat-value {  
            font-family: 'Courier New', monospace;  
            color: #7f8c8d;  
            font-weight: bold;  
        }  

        .error-message {  
            background: #f8d7da;  
            color: #721c24;  
            padding: 15px;  
            border-radius: 8px;  
            border-left: 4px solid #e74c3c;  
            margin: 15px 0;  
        }  

        .success-message {  
            background: #d4edda;  
            color: #155724;  
            padding: 15px;  
            border-radius: 8px;  
            border-left: 4px solid #28a745;  
            margin: 15px 0;  
        }  

        .legend {  
            display: flex;  
            gap: 20px;  
            flex-wrap: wrap;  
            margin: 20px 0;  
            padding: 15px;  
            background: #f8f9fa;  
            border-radius: 8px;  
        }  

        .legend-item {  
            display: flex;  
            align-items: center;  
            gap: 8px;  
        }  

        .legend-color {  
            width: 20px;  
            height: 20px;  
            border-radius: 4px;  
        }  

        table {  
            width: 100%;  
            border-collapse: collapse;  
            margin: 20px 0;  
        }  

        th, td {  
            padding: 12px;  
            text-align: center;  
            border: 1px solid #dee2e6;  
        }  

        th {  
            background: #667eea;  
            color: white;  
            font-weight: bold;  
        }  

        tr:nth-child(even) {  
            background: #f8f9fa;  
        }  

        tr:hover {  
            background: #e3f2fd;  
        }  

        .info-tag {  
            display: inline-block;  
            padding: 5px 12px;  
            border-radius: 20px;  
            font-size: 0.85em;  
            font-weight: bold;  
            margin: 0 5px;  
        }  

        .tag-success {  
            background: #d4edda;  
            color: #155724;  
        }  

        .tag-warning {  
            background: #fff3cd;  
            color: #856404;  
        }  

        .tag-danger {  
            background: #f8d7da;  
            color: #721c24;  
        }  

        @media (max-width: 768px) {  
            .container {  
                padding: 20px;  
            }  
            
            h1 {  
                font-size: 1.8em;  
            }  
            
            .am-matrix {  
                grid-template-columns: 1fr;  
            }  

            .bit-row {  
                font-size: 10px;  
            }  

            .bit-box {  
                width: 20px;  
                height: 20px;  
                font-size: 10px;  
            }  
        }  
    </style>  
</head>  
<body>  
    <div class="container">  
        <h1>ğŸ”¢ AMç æ±‰æ˜è·ç¦»è¯¦è§£</h1>  
        <p class="subtitle">Hamming Distance in Alignment Markers - åŸç†ã€ä½œç”¨ä¸å¯è§†åŒ–æ¼”ç¤º</p>  

        <!-- ç†è®ºéƒ¨åˆ† -->  
        <div class="theory-section">  
            <h2>ğŸ“š ä»€ä¹ˆæ˜¯æ±‰æ˜è·ç¦»ï¼Ÿ</h2>  
            <p>  
                <strong>æ±‰æ˜è·ç¦»ï¼ˆHamming Distanceï¼‰</strong>æ˜¯ä¸¤ä¸ªç­‰é•¿å­—ç¬¦ä¸²å¯¹åº”ä½ç½®ä¸åŒå­—ç¬¦çš„ä¸ªæ•°ã€‚  
                åœ¨äºŒè¿›åˆ¶ç¼–ç ä¸­ï¼Œæ±‰æ˜è·ç¦»å°±æ˜¯ä¸¤ä¸ªç å­—ä¹‹é—´ä¸åŒbitä½çš„æ•°é‡ã€‚  
            </p>  
            
            <div class="formula-box">// æ±‰æ˜è·ç¦»è®¡ç®—ç¤ºä¾‹  
Code A: 10110101  
Code B: 10010001  
        ^^   ^^  â† 4ä¸ªä½ç½®ä¸åŒ  

Hamming Distance = 4</div>  

            <div class="highlight-box">  
                <strong>æ ¸å¿ƒå…¬å¼ï¼š</strong><br>  
                HD(A, B) = Î£(A[i] XOR B[i])  ï¼ˆi = 0 to n-1ï¼‰<br>  
                å³ï¼šå¯¹ä¸¤ä¸ªç å­—è¿›è¡ŒæŒ‰ä½å¼‚æˆ–ï¼Œç»Ÿè®¡ç»“æœä¸­1çš„ä¸ªæ•°  
            </div>  
        </div>  

        <div class="theory-section">  
            <h2>ğŸ¯ AMç ä¸­æ±‰æ˜è·ç¦»çš„ä½œç”¨</h2>  
            <p>  
                åœ¨800Gä»¥å¤ªç½‘çš„PCSå±‚ï¼ŒAMï¼ˆAlignment Markerï¼‰ç å¿…é¡»å…·æœ‰<strong>è¶³å¤Ÿå¤§çš„æ±‰æ˜è·ç¦»</strong>ï¼ŒåŸå› å¦‚ä¸‹ï¼š  
            </p>  
            
            <h3 style="color: #1565c0; margin: 20px 0 10px 0;">1ï¸âƒ£ æŠ—è¯¯æ£€æµ‹èƒ½åŠ›</h3>  
            <p>  
                <span class="info-tag tag-success">æ±‰æ˜è·ç¦» â‰¥ d+1</span><br>  
                å¯ä»¥æ£€æµ‹å‡º <strong>d</strong> ä½é”™è¯¯ã€‚ä¾‹å¦‚ï¼šæ±‰æ˜è·ç¦»=5ï¼Œå¯ä»¥æ£€æµ‹å‡º4ä½é”™è¯¯ã€‚  
            </p>  

            <h3 style="color: #1565c0; margin: 20px 0 10px 0;">2ï¸âƒ£ çº é”™èƒ½åŠ›</h3>  
            <p>  
                <span class="info-tag tag-warning">æ±‰æ˜è·ç¦» â‰¥ 2t+1</span><br>  
                å¯ä»¥çº æ­£ <strong>t</strong> ä½é”™è¯¯ã€‚ä¾‹å¦‚ï¼šæ±‰æ˜è·ç¦»=7ï¼Œå¯ä»¥çº æ­£3ä½é”™è¯¯ã€‚  
            </p>  

            <h3 style="color: #1565c0; margin: 20px 0 10px 0;">3ï¸âƒ£ Laneè¯†åˆ«</h3>  
            <p>  
                ä¸åŒlaneçš„AMç å¿…é¡»æœ‰<strong>è¶³å¤Ÿå¤§çš„æ±‰æ˜è·ç¦»</strong>ï¼Œé˜²æ­¢ï¼š  
            </p>  
            <ul style="margin-left: 30px; line-height: 2;">  
                <li>é”™è¯¯è¯†åˆ«laneï¼ˆLane misidentificationï¼‰</li>  
                <li>AMç è¯¯åˆ¤ä¸ºæ™®é€šæ•°æ®</li>  
                <li>å¤šbité”™è¯¯å¯¼è‡´çš„laneæ··æ·†</li>  
            </ul>  

            <div class="highlight-box">  
                <strong>IEEE 802.3bsæ ‡å‡†è¦æ±‚ï¼š</strong><br>  
                â€¢ AMç ä¹‹é—´çš„æœ€å°æ±‰æ˜è·ç¦» â‰¥ 10<br>  
                â€¢ AMç ä¸å…¶åç çš„æ±‰æ˜è·ç¦» = 64ï¼ˆå…¨éƒ¨ä¸åŒï¼‰<br>  
                â€¢ ä¸åŒlaneçš„AMç ä¹‹é—´æ±‰æ˜è·ç¦» â‰¥ 10  
            </div>  
        </div>  

        <div class="theory-section">  
            <h2>âš™ï¸ å·¥ä½œåŸç†</h2>  
            <p>  
                <strong>AMæ£€æµ‹æµç¨‹ï¼š</strong>  
            </p>  
            <div class="formula-box">Step 1: æ¥æ”¶åˆ°256-bit block  

Step 2: è®¡ç®—ä¸é¢„æœŸAMç çš„æ±‰æ˜è·ç¦»  

Step 3: åˆ¤æ–­ï¼š  
    if HD < é˜ˆå€¼(é€šå¸¸4-5):  
        è¯†åˆ«ä¸ºAMç  âœ“  
    else:  
        ä¸æ˜¯AMç  âœ—  

Step 4: å¯¹8æ¡laneåˆ†åˆ«è¿›è¡ŒAMæ£€æµ‹  

Step 5: æ ¹æ®AMä½ç½®è¿›è¡Œlaneå¯¹é½</div>  

            <h3 style="color: #1565c0; margin: 20px 0 10px 0;">ä¸ºä»€ä¹ˆéœ€è¦å¤§æ±‰æ˜è·ç¦»ï¼Ÿ</h3>  
            <table>  
                <thead>  
                    <tr>  
                        <th>åœºæ™¯</th>  
                        <th>æ±‰æ˜è·ç¦»è¦æ±‚</th>  
                        <th>åŸå› </th>  
                    </tr>  
                </thead>  
                <tbody>  
                    <tr>  
                        <td>AM vs éšæœºæ•°æ®</td>  
                        <td>â‰¥ 10</td>  
                        <td>é˜²æ­¢éšæœºæ•°æ®è¢«è¯¯åˆ¤ä¸ºAM</td>  
                    </tr>  
                    <tr>  
                        <td>ä¸åŒLaneçš„AM</td>  
                        <td>â‰¥ 10</td>  
                        <td>é˜²æ­¢Laneé”™è¯¯è¯†åˆ«</td>  
                    </tr>  
                    <tr>  
                        <td>AM vs AMåç </td>  
                        <td>64 (æœ€å¤§)</td>  
                        <td>å¢å¼ºè¯†åˆ«å¯é æ€§</td>  
                    </tr>  
                    <tr>  
                        <td>å®¹é”™èƒ½åŠ›</td>  
                        <td>â‰¥ 2t+1</td>  
                        <td>tä½é”™è¯¯ä»èƒ½æ­£ç¡®è¯†åˆ«</td>  
                    </tr>  
                </tbody>  
            </table>  
        </div>  

        <!-- æ‰‹åŠ¨è¾“å…¥128bitç¼–ç  -->  
        <div class="demo-section">  
            <div class="demo-title">âœï¸ æ‰‹åŠ¨è¾“å…¥ç¼–ç è®¡ç®—æ±‰æ˜è·ç¦»</div>  
            
            <div class="input-section">  
                <div class="input-group">  
                    <label class="input-label">ğŸ“ è¾“å…¥æ ¼å¼é€‰æ‹©ï¼š</label>  
                    <div class="input-format-select">  
                        <div class="format-option">  
                            <input type="radio" name="inputFormat" id="formatBinary" value="binary" checked>  
                            <label for="formatBinary">äºŒè¿›åˆ¶ (0/1)</label>  
                        </div>  
                        <div class="format-option">  
                            <input type="radio" name="inputFormat" id="formatHex" value="hex">  
                            <label for="formatHex">åå…­è¿›åˆ¶ (0-F)</label>  
                        </div>  
                    </div>  
                </div>  

                <div class="input-group">  
                    <label class="input-label">ğŸ”¢ è¾“å…¥ç¼–ç Aï¼ˆ128 bitsï¼‰ï¼š</label>  
                    <textarea class="input-textarea" id="inputCodeA"   
                              placeholder="è¯·è¾“å…¥128ä½äºŒè¿›åˆ¶ç ï¼ˆå¯ä»¥åŒ…å«ç©ºæ ¼æˆ–æ¢è¡Œï¼‰&#10;ä¾‹å¦‚ï¼š&#10;10010000 01110110 01000111 11001011 ...&#10;æˆ–32ä½åå…­è¿›åˆ¶ï¼š&#10;907647CB F0C4E61B C5FB659A A2793D8C"></textarea>  
                    <div class="input-hint">ğŸ’¡ æç¤ºï¼š128 bits = 32ä½åå…­è¿›åˆ¶ = 16å­—èŠ‚</div>  
                </div>  

                <div class="input-group">  
                    <label class="input-label">ğŸ”¢ è¾“å…¥ç¼–ç Bï¼ˆ128 bitsï¼‰ï¼š</label>  
                    <textarea class="input-textarea" id="inputCodeB"   
                              placeholder="è¯·è¾“å…¥ç¬¬äºŒä¸ª128ä½ç¼–ç "></textarea>  
                </div>  

                <div class="controls">  
                    <button class="btn btn-primary" onclick="calculateCustomHD()">ğŸ§® è®¡ç®—æ±‰æ˜è·ç¦»</button>  
                    <button class="btn btn-success" onclick="generateRandom128()">ğŸ² ç”Ÿæˆéšæœºç¼–ç </button>  
                    <button class="btn btn-warning" onclick="loadAMPattern()">ğŸ“‹ åŠ è½½AMæ¨¡å¼</button>  
                    <button class="btn btn-danger" onclick="clearInputs()">ğŸ—‘ï¸ æ¸…ç©º</button>  
                </div>  

                <div id="inputErrorMessage"></div>  
            </div>  

            <div id="customHDResult" style="display: none;">  
                <!-- ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->  
            </div>  
        </div>  

        <!-- äº¤äº’æ¼”ç¤º -->  
        <div class="demo-section">  
            <div class="demo-title">ğŸ”¬ é€‰æ‹©AMç è®¡ç®—æ±‰æ˜è·ç¦»</div>  
            
            <div class="controls">  
                <button class="btn btn-primary" onclick="selectRandomPair()">ğŸ² éšæœºé€‰æ‹©ä¸¤ä¸ªLane</button>  
                <button class="btn btn-success" onclick="calculateAll()">ğŸ“Š è®¡ç®—æ‰€æœ‰è·ç¦»</button>  
                <button class="btn btn-warning" onclick="simulateError()">âš ï¸ æ¨¡æ‹Ÿè¯¯ç </button>  
                <button class="btn btn-danger" onclick="resetDemo()">ğŸ”„ é‡ç½®</button>  
            </div>  

            <p style="text-align: center; color: #7f8c8d; margin: 15px 0;">  
                ğŸ‘† ç‚¹å‡»é€‰æ‹©ä»»æ„ä¸¤ä¸ªLaneè¿›è¡Œæ±‰æ˜è·ç¦»è®¡ç®—  
            </p>  

            <div class="am-matrix" id="amMatrix">  
                <!-- åŠ¨æ€ç”Ÿæˆ -->  
            </div>  

            <div class="hamming-result" id="hammingResult" style="display: none;">  
                <h3 style="color: #667eea; margin-bottom: 15px;">ğŸ“ˆ æ±‰æ˜è·ç¦»è®¡ç®—ç»“æœ</h3>  
                <div class="bit-comparison" id="bitComparison"></div>  
                <div class="stats-panel" id="statsPanel"></div>  
            </div>  
        </div>  

        <!-- æ±‰æ˜è·ç¦»çŸ©é˜µ -->  
        <div class="demo-section">  
            <div class="demo-title">ğŸ—ºï¸ 8 Lane AMç æ±‰æ˜è·ç¦»çŸ©é˜µ</div>  
            
            <div class="controls">  
                <button class="btn btn-success" onclick="showHammingMatrix()">ğŸ“Š æ˜¾ç¤ºå®Œæ•´çŸ©é˜µ</button>  
                <button class="btn btn-primary" onclick="highlightMinDistance()">ğŸ” æ ‡è®°æœ€å°è·ç¦»</button>  
            </div>  

            <div id="matrixDisplay"></div>  

            <div class="legend">  
                <div class="legend-item">  
                    <div class="legend-color hamming-high"></div>  
                    <span>é«˜è·ç¦» (HD â‰¥ 15) - ä¼˜ç§€</span>  
                </div>  
                <div class="legend-item">  
                    <div class="legend-color hamming-medium"></div>  
                    <span>ä¸­è·ç¦» (10 â‰¤ HD < 15) - åˆæ ¼</span>  
                </div>  
                <div class="legend-item">  
                    <div class="legend-color hamming-low"></div>  
                    <span>ä½è·ç¦» (HD < 10) - ä¸åˆæ ¼</span>  
                </div>  
            </div>  
        </div>  

    </div>  

    <script>  
        // 800G AM Patterns (å®é™…ä½¿ç”¨128-bitï¼Œè¿™é‡Œç”¨64-bitç¤ºä¾‹)  
        const AM_PATTERNS_64 = {  
            0: { hex: '907647CB6F89B834', name: 'Lane 0' },  
            1: { hex: 'F0C4E61B0F3B19E4', name: 'Lane 1' },  
            2: { hex: 'C5FB659A3A049A65', name: 'Lane 2' },  
            3: { hex: 'A2793D8C5D86C273', name: 'Lane 3' },  
            4: { hex: 'E15A2B671EA5D498', name: 'Lane 4' },  
            5: { hex: 'FF4908B500B6F74A', name: 'Lane 5' },  
            6: { hex: 'C86C97F337936 80C', name: 'Lane 6' },  
            7: { hex: 'D4A5F01C2B5A0FE3', name: 'Lane 7' }  
        };  

        let selectedLanes = [];  
        let hammingMatrix = [];  

        // 16è¿›åˆ¶è½¬äºŒè¿›åˆ¶ï¼ˆæ”¯æŒ128bitï¼‰  
        function hexToBinary(hex) {  
            hex = hex.replace(/\s+/g, '').replace(/0x/gi, '');  
            let binary = '';  
            for (let i = 0; i < hex.length; i++) {  
                binary += parseInt(hex[i], 16).toString(2).padStart(4, '0');  
            }  
            return binary;  
        }  

        // äºŒè¿›åˆ¶è½¬16è¿›åˆ¶  
        function binaryToHex(binary) {  
            binary = binary.replace(/\s+/g, '');  
            let hex = '';  
            for (let i = 0; i < binary.length; i += 4) {  
                hex += parseInt(binary.substr(i, 4), 2).toString(16).toUpperCase();  
            }  
            return hex;  
        }  

        // è®¡ç®—æ±‰æ˜è·ç¦»  
        function calculateHammingDistance(bin1, bin2) {  
            if (bin1.length !== bin2.length) {  
                return -1;  
            }  
            let distance = 0;  
            for (let i = 0; i < bin1.length; i++) {  
                if (bin1[i] !== bin2[i]) distance++;  
            }  
            return distance;  
        }  

        // éªŒè¯äºŒè¿›åˆ¶è¾“å…¥  
        function validateBinary(input) {  
            const clean = input.replace(/\s+/g, '');  
            return /^[01]+$/.test(clean) ? clean : null;  
        }  

        // éªŒè¯åå…­è¿›åˆ¶è¾“å…¥  
        function validateHex(input) {  
            const clean = input.replace(/\s+/g, '').replace(/0x/gi, '');  
            return /^[0-9A-Fa-f]+$/.test(clean) ? clean : null;  
        }  

        // æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯  
        function showError(message) {  
            const errorDiv = document.getElementById('inputErrorMessage');  
            errorDiv.innerHTML = `<div class="error-message">âŒ ${message}</div>`;  
            setTimeout(() => {  
                errorDiv.innerHTML = '';  
            }, 5000);  
        }  

        // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯  
        function showSuccess(message) {  
            const errorDiv = document.getElementById('inputErrorMessage');  
            errorDiv.innerHTML = `<div class="success-message">âœ… ${message}</div>`;  
        }  

        // è®¡ç®—è‡ªå®šä¹‰ç¼–ç çš„æ±‰æ˜è·ç¦»  
        function calculateCustomHD() {  
            const format = document.querySelector('input[name="inputFormat"]:checked').value;  
            const inputA = document.getElementById('inputCodeA').value.trim();  
            const inputB = document.getElementById('inputCodeB').value.trim();  

            if (!inputA || !inputB) {  
                showError('è¯·è¾“å…¥ä¸¤ä¸ªç¼–ç ï¼');  
                return;  
            }  

            let binaryA, binaryB;  

            try {  
                if (format === 'binary') {  
                    binaryA = validateBinary(inputA);  
                    binaryB = validateBinary(inputB);  
                    
                    if (!binaryA || !binaryB) {  
                        showError('äºŒè¿›åˆ¶æ ¼å¼é”™è¯¯ï¼è¯·åªè¾“å…¥0å’Œ1');  
                        return;  
                    }  
                } else {  
                    const hexA = validateHex(inputA);  
                    const hexB = validateHex(inputB);  
                    
                    if (!hexA || !hexB) {
                        showError('åå…­è¿›åˆ¶æ ¼å¼é”™è¯¯ï¼è¯·åªè¾“å…¥0-9å’ŒA-F');
                        return;
                    }
                    
                    binaryA = hexToBinary(hexA);
                    binaryB = hexToBinary(hexB);
                }

                // æ£€æŸ¥é•¿åº¦
                if (binaryA.length !== 128 || binaryB.length !== 128) {
                    showError(`ç¼–ç é•¿åº¦é”™è¯¯ï¼éœ€è¦128ä½ï¼Œå½“å‰ï¼šA=${binaryA.length}ä½, B=${binaryB.length}ä½`);
                    document.getElementById('inputCodeA').classList.add('error');
                    document.getElementById('inputCodeB').classList.add('error');
                    return;
                }

                // ç§»é™¤é”™è¯¯æ ·å¼
                document.getElementById('inputCodeA').classList.remove('error');
                document.getElementById('inputCodeB').classList.remove('error');

                // è®¡ç®—æ±‰æ˜è·ç¦»
                const distance = calculateHammingDistance(binaryA, binaryB);
                
                showSuccess(`æ±‰æ˜è·ç¦»è®¡ç®—æˆåŠŸï¼HD = ${distance}`);
                
                // æ˜¾ç¤ºè¯¦ç»†ç»“æœ
                displayCustomHDResult(binaryA, binaryB, distance, inputA, inputB);

            } catch (error) {
                showError('è®¡ç®—å‡ºé”™ï¼š' + error.message);
            }
        }

        // æ˜¾ç¤ºè‡ªå®šä¹‰ç¼–ç çš„æ±‰æ˜è·ç¦»ç»“æœ
        function displayCustomHDResult(bin1, bin2, distance, originalA, originalB) {
            const resultDiv = document.getElementById('customHDResult');
            resultDiv.style.display = 'block';
            
            const errorDetectable = distance - 1;
            const errorCorrectable = Math.floor((distance - 1) / 2);
            
            let html = `
            <div class="hamming-result">
                <h3 style="color: #667eea; margin-bottom: 20px;">ğŸ“Š è®¡ç®—ç»“æœ</h3>
                
                <div class="stats-panel">
                    <div class="stat-item">
                        <span class="stat-label">æ±‰æ˜è·ç¦» (HD):</span>
                        <span class="stat-value" style="font-size: 1.8em; color: ${
                            distance >= 10 ? '#2ecc71' : distance >= 5 ? '#f39c12' : '#e74c3c'
                        };">
                            ${distance}
                        </span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">å¯æ£€æµ‹é”™è¯¯ä½æ•°:</span>
                        <span class="stat-value">${errorDetectable} bits</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">å¯çº æ­£é”™è¯¯ä½æ•°:</span>
                        <span class="stat-value">${errorCorrectable} bits</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ç›¸ä¼¼åº¦:</span>
                        <span class="stat-value">${((128 - distance) / 128 * 100).toFixed(2)}%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">IEEE 802.3bsæ ‡å‡†:</span>
                        <span class="stat-value">
                            ${distance >= 10 ? 'âœ… ç¬¦åˆ (HD â‰¥ 10)' : 'âŒ ä¸ç¬¦åˆ'}
                        </span>
                    </div>
                </div>

                <h4 style="color: #667eea; margin: 20px 0 10px 0;">ğŸ” é€ä½å¯¹æ¯” (128 bits)</h4>
                <div class="bit-comparison">
            `;

            // åˆ†8è¡Œæ˜¾ç¤ºï¼Œæ¯è¡Œ16ä½
            for (let row = 0; row < 8; row++) {
                const start = row * 16;
                const end = start + 16;
                
                html += `<div class="bit-row">
                    <span class="bit-row-label">Bits ${start.toString().padStart(3, '0')}-${(end-1).toString().padStart(3, '0')}:</span>`;
                
                for (let i = start; i < end; i++) {
                    const className = bin1[i] === bin2[i] ? 'bit-same' : 'bit-diff';
                    html += `<div class="bit-box ${className}" title="ä½ç½®${i}">${bin1[i]}</div>`;
                }
                html += '</div>';
                
                html += `<div class="bit-row">
                    <span class="bit-row-label"></span>`;
                
                for (let i = start; i < end; i++) {
                    const className = bin1[i] === bin2[i] ? 'bit-same' : 'bit-diff';
                    html += `<div class="bit-box ${className}" title="ä½ç½®${i}">${bin2[i]}</div>`;
                }
                html += '</div>';
                
                html += '<div style="height: 10px;"></div>';
            }

            html += `</div>

                <div class="legend" style="margin-top: 20px;">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #d4edda;"></div>
                        <span>ç›¸åŒä½ (${128 - distance} ä¸ª)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #f8d7da;"></div>
                        <span>ä¸åŒä½ (${distance} ä¸ª)</span>
                    </div>
                </div>

                <h4 style="color: #667eea; margin: 20px 0 10px 0;">ğŸ“ ç¼–ç è¯¦æƒ…</h4>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <div style="margin-bottom: 15px;">
                        <strong>ç¼–ç  A:</strong><br>
                        <div class="pattern-display">${formatBinaryDisplay(bin1)}</div>
                        <div style="margin-top: 5px; color: #7f8c8d;">
                            åå…­è¿›åˆ¶: ${binaryToHex(bin1).match(/.{1,8}/g).join(' ')}
                        </div>
                    </div>
                    <div>
                        <strong>ç¼–ç  B:</strong><br>
                        <div class="pattern-display">${formatBinaryDisplay(bin2)}</div>
                        <div style="margin-top: 5px; color: #7f8c8d;">
                            åå…­è¿›åˆ¶: ${binaryToHex(bin2).match(/.{1,8}/g).join(' ')}
                        </div>
                    </div>
                </div>

                ${generateHDAnalysis(distance)}
            </div>`;

            resultDiv.innerHTML = html;
            
            // æ»šåŠ¨åˆ°ç»“æœ
            resultDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        // æ ¼å¼åŒ–äºŒè¿›åˆ¶æ˜¾ç¤º
        function formatBinaryDisplay(binary) {
            return binary.match(/.{1,8}/g).join(' ');
        }

        // ç”Ÿæˆæ±‰æ˜è·ç¦»åˆ†æ
        function generateHDAnalysis(distance) {
            let analysis = '';
            
            if (distance === 0) {
                analysis = `
                <div class="highlight-box">
                    <strong>âœ… å®Œå…¨ç›¸åŒ</strong><br>
                    ä¸¤ä¸ªç¼–ç å®Œå…¨ä¸€è‡´ï¼Œæ±‰æ˜è·ç¦»ä¸º0ã€‚
                </div>`;
            } else if (distance < 5) {
                analysis = `
                <div class="highlight-box" style="background: #f8d7da; border-left-color: #e74c3c;">
                    <strong>âš ï¸ è·ç¦»è¿‡å° (HD < 5)</strong><br>
                    â€¢ å®¹é”™èƒ½åŠ›å¼±ï¼Œä»…èƒ½çº æ­£ ${Math.floor((distance-1)/2)} ä½é”™è¯¯<br>
                    â€¢ ä¸é€‚åˆä½œä¸ºAMç ï¼ˆæ˜“è¯¯åˆ¤ï¼‰<br>
                    â€¢ å¯èƒ½å¯¼è‡´Laneè¯†åˆ«é”™è¯¯
                </div>`;
            } else if (distance < 10) {
                analysis = `
                <div class="highlight-box" style="background: #fff3cd; border-left-color: #f39c12;">
                    <strong>âš ï¸ è·ç¦»ä¸­ç­‰ (5 â‰¤ HD < 10)</strong><br>
                    â€¢ å¯çº æ­£ ${Math.floor((distance-1)/2)} ä½é”™è¯¯<br>
                    â€¢ ä¸ç¬¦åˆIEEE 802.3bsæ ‡å‡†ï¼ˆè¦æ±‚HD â‰¥ 10ï¼‰<br>
                    â€¢ å»ºè®®å¢å¤§æ±‰æ˜è·ç¦»ä»¥æé«˜å¯é æ€§
                </div>`;
            } else if (distance < 20) {
                analysis = `
                <div class="highlight-box" style="background: #d4edda; border-left-color: #28a745;">
                    <strong>âœ… è·ç¦»è‰¯å¥½ (10 â‰¤ HD < 20)</strong><br>
                    â€¢ å¯çº æ­£ ${Math.floor((distance-1)/2)} ä½é”™è¯¯<br>
                    â€¢ ç¬¦åˆIEEE 802.3bsæ ‡å‡†ï¼ˆHD â‰¥ 10ï¼‰<br>
                    â€¢ é€‚åˆç”¨ä½œAMç ï¼Œå…·æœ‰è¾ƒå¥½çš„æŠ—è¯¯ç èƒ½åŠ›
                </div>`;
            } else {
                analysis = `
                <div class="highlight-box" style="background: #d4edda; border-left-color: #28a745;">
                    <strong>âœ… è·ç¦»ä¼˜ç§€ (HD â‰¥ 20)</strong><br>
                    â€¢ å¯çº æ­£ ${Math.floor((distance-1)/2)} ä½é”™è¯¯<br>
                    â€¢ è¿œè¶…IEEE 802.3bsæ ‡å‡†è¦æ±‚<br>
                    â€¢ æå¼ºçš„æŠ—è¯¯ç èƒ½åŠ›ï¼Œå‡ ä¹ä¸ä¼šè¯¯è¯†åˆ«
                </div>`;
            }
            
            return analysis;
        }

        // ç”Ÿæˆéšæœº128ä½ç¼–ç 
        function generateRandom128() {
            const format = document.querySelector('input[name="inputFormat"]:checked').value;
            
            let randomA = '';
            let randomB = '';
            
            if (format === 'binary') {
                for (let i = 0; i < 128; i++) {
                    randomA += Math.random() > 0.5 ? '1' : '0';
                    randomB += Math.random() > 0.5 ? '1' : '0';
                    
                    // æ¯8ä½åŠ ç©ºæ ¼
                    if ((i + 1) % 8 === 0 && i < 127) {
                        randomA += ' ';
                        randomB += ' ';
                    }
                }
            } else {
                for (let i = 0; i < 32; i++) {
                    randomA += Math.floor(Math.random() * 16).toString(16).toUpperCase();
                    randomB += Math.floor(Math.random() * 16).toString(16).toUpperCase();
                    
                    // æ¯8ä½åŠ ç©ºæ ¼
                    if ((i + 1) % 8 === 0 && i < 31) {
                        randomA += ' ';
                        randomB += ' ';
                    }
                }
            }
            
            document.getElementById('inputCodeA').value = randomA;
            document.getElementById('inputCodeB').value = randomB;
            
            showSuccess('å·²ç”Ÿæˆéšæœº128ä½ç¼–ç ');
        }

        // åŠ è½½AMæ¨¡å¼
        function loadAMPattern() {
            const lane1 = Math.floor(Math.random() * 8);
            let lane2 = Math.floor(Math.random() * 8);
            while (lane2 === lane1) {
                lane2 = Math.floor(Math.random() * 8);
            }
            
            const format = document.querySelector('input[name="inputFormat"]:checked').value;
            
            const hex1 = AM_PATTERNS_64[lane1].hex.replace(/\s+/g, '');
            const hex2 = AM_PATTERNS_64[lane2].hex.replace(/\s+/g, '');
            
            if (format === 'binary') {
                const bin1 = hexToBinary(hex1);
                const bin2 = hexToBinary(hex2);
                
                document.getElementById('inputCodeA').value = formatBinaryDisplay(bin1);
                document.getElementById('inputCodeB').value = formatBinaryDisplay(bin2);
            } else {
                document.getElementById('inputCodeA').value = hex1.match(/.{1,8}/g).join(' ');
                document.getElementById('inputCodeB').value = hex2.match(/.{1,8}/g).join(' ');
            }
            
            showSuccess(`å·²åŠ è½½ ${AM_PATTERNS_64[lane1].name} å’Œ ${AM_PATTERNS_64[lane2].name} çš„AMæ¨¡å¼ï¼ˆ64-bitç¤ºä¾‹ï¼‰`);
        }

        // æ¸…ç©ºè¾“å…¥
        function clearInputs() {
            document.getElementById('inputCodeA').value = '';
            document.getElementById('inputCodeB').value = '';
            document.getElementById('inputCodeA').classList.remove('error');
            document.getElementById('inputCodeB').classList.remove('error');
            document.getElementById('customHDResult').style.display = 'none';
            document.getElementById('inputErrorMessage').innerHTML = '';
        }

        // åˆå§‹åŒ–AMå¡ç‰‡
        function initAMCards() {
            const container = document.getElementById('amMatrix');
            let html = '';
            
            for (let i = 0; i < 8; i++) {
                const pattern = AM_PATTERNS_64[i];
                const hex = pattern.hex.replace(/\s+/g, '');
                const binary = hexToBinary(hex);
                
                html += `
                <div class="am-card" id="lane-${i}" onclick="selectLane(${i})">
                    <div class="lane-label">
                        <span>ğŸ”·</span>
                        <span>${pattern.name}</span>
                    </div>
                    <div class="pattern-display">
                        ${hex.match(/.{1,8}/g).join(' ')}
                    </div>
                    <div class="binary-display">
                        ${formatBinaryDisplay(binary)}
                    </div>
                    <div style="margin-top: 10px; font-size: 0.85em; color: #7f8c8d;">
                        64 bits (AM + Inverseç¤ºä¾‹)
                    </div>
                </div>`;
            }
            
            container.innerHTML = html;
        }

        // é€‰æ‹©Lane
        function selectLane(laneId) {
            const card = document.getElementById(`lane-${laneId}`);
            
            if (selectedLanes.includes(laneId)) {
                selectedLanes = selectedLanes.filter(id => id !== laneId);
                card.classList.remove('selected');
            } else {
                if (selectedLanes.length < 2) {
                    selectedLanes.push(laneId);
                    card.classList.add('selected');
                } else {
                    // ç§»é™¤ç¬¬ä¸€ä¸ªé€‰æ‹©
                    const firstLane = selectedLanes.shift();
                    document.getElementById(`lane-${firstLane}`).classList.remove('selected');
                    selectedLanes.push(laneId);
                    card.classList.add('selected');
                }
            }
            
            if (selectedLanes.length === 2) {
                compareSelectedLanes();
            }
        }

        // æ¯”è¾ƒé€‰ä¸­çš„Lanes
        function compareSelectedLanes() {
            const [lane1, lane2] = selectedLanes;
            const hex1 = AM_PATTERNS_64[lane1].hex.replace(/\s+/g, '');
            const hex2 = AM_PATTERNS_64[lane2].hex.replace(/\s+/g, '');
            const bin1 = hexToBinary(hex1);
            const bin2 = hexToBinary(hex2);
            
            const distance = calculateHammingDistance(bin1, bin2);
            
            displayComparison(lane1, lane2, bin1, bin2, distance);
        }

        // æ˜¾ç¤ºæ¯”è¾ƒç»“æœ
        function displayComparison(lane1, lane2, bin1, bin2, distance) {
            const resultDiv = document.getElementById('hammingResult');
            const comparisonDiv = document.getElementById('bitComparison');
            const statsDiv = document.getElementById('statsPanel');
            
            resultDiv.style.display = 'block';
            
            // æ˜¾ç¤ºbitå¯¹æ¯”ï¼ˆæ¯è¡Œ16ä½ï¼‰
            let html = `
            <div style="margin-bottom: 20px;">
                <strong style="color: #667eea; font-size: 1.2em;">
                    ${AM_PATTERNS_64[lane1].name} vs ${AM_PATTERNS_64[lane2].name}
                </strong>
            </div>`;
            
            for (let row = 0; row < 4; row++) {
                const start = row * 16;
                const end = start + 16;
                
                html += `<div class="bit-row">
                    <span class="bit-row-label">${AM_PATTERNS_64[lane1].name} [${start}-${end-1}]:</span>`;
                
                for (let i = start; i < end; i++) {
                    const className = bin1[i] === bin2[i] ? 'bit-same' : 'bit-diff';
                    html += `<div class="bit-box ${className}" title="Bit ${i}">${bin1[i]}</div>`;
                }
                html += '</div>';
                
                html += `<div class="bit-row">
                    <span class="bit-row-label">${AM_PATTERNS_64[lane2].name} [${start}-${end-1}]:</span>`;
                
                for (let i = start; i < end; i++) {
                    const className = bin1[i] === bin2[i] ? 'bit-same' : 'bit-diff';
                    html += `<div class="bit-box ${className}" title="Bit ${i}">${bin2[i]}</div>`;
                }
                html += '</div>';
                
                html += '<div style="height: 10px;"></div>';
            }
            
            comparisonDiv.innerHTML = html;
            
            // æ˜¾ç¤ºç»Ÿè®¡
            const errorDetectable = distance - 1;
            const errorCorrectable = Math.floor((distance - 1) / 2);
            
            statsDiv.innerHTML = `
                <div class="stat-item">
                    <span class="stat-label">æ±‰æ˜è·ç¦»:</span>
                    <span class="stat-value" style="font-size: 1.8em; color: ${distance >= 10 ? '#2ecc71' : '#e74c3c'};">
                        ${distance}
                    </span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">å¯æ£€æµ‹é”™è¯¯ä½æ•°:</span>
                    <span class="stat-value">${errorDetectable} bits</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">å¯çº æ­£é”™è¯¯ä½æ•°:</span>
                    <span class="stat-value">${errorCorrectable} bits</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">ç›¸ä¼¼åº¦:</span>
                    <span class="stat-value">${((64 - distance) / 64 * 100).toFixed(2)}%</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">æ ‡å‡†ç¬¦åˆæ€§:</span>
                    <span class="stat-value">${distance >= 10 ? 'âœ“ ç¬¦åˆIEEE 802.3bs (HD â‰¥ 10)' : 'âœ— ä¸ç¬¦åˆæ ‡å‡†'}</span>
                </div>
            `;
            
            // æ»šåŠ¨åˆ°ç»“æœ
            resultDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        // éšæœºé€‰æ‹©ä¸¤ä¸ªLane
        function selectRandomPair() {
            // æ¸…é™¤ä¹‹å‰çš„é€‰æ‹©
            selectedLanes.forEach(id => {
                document.getElementById(`lane-${id}`).classList.remove('selected');
            });
            selectedLanes = [];
            
            // éšæœºé€‰æ‹©
            const lane1 = Math.floor(Math.random() * 8);
            let lane2 = Math.floor(Math.random() * 8);
            while (lane2 === lane1) {
                lane2 = Math.floor(Math.random() * 8);
            }
            
            selectLane(lane1);
            selectLane(lane2);
        }

        // è®¡ç®—å®Œæ•´æ±‰æ˜è·ç¦»çŸ©é˜µ
        function calculateHammingMatrix() {
            hammingMatrix = [];
            for (let i = 0; i < 8; i++) {
                hammingMatrix[i] = [];
                const hex1 = AM_PATTERNS_64[i].hex.replace(/\s+/g, '');
                const bin1 = hexToBinary(hex1);
                
                for (let j = 0; j < 8; j++) {
                    const hex2 = AM_PATTERNS_64[j].hex.replace(/\s+/g, '');
                    const bin2 = hexToBinary(hex2);
                    hammingMatrix[i][j] = calculateHammingDistance(bin1, bin2);
                }
            }
            return hammingMatrix;
        }

        // æ˜¾ç¤ºæ±‰æ˜è·ç¦»çŸ©é˜µ
        function showHammingMatrix() {
            const matrix = calculateHammingMatrix();
            const display = document.getElementById('matrixDisplay');
            
            let html = '<table><thead><tr><th>Lane</th>';
            for (let i = 0; i < 8; i++) {
                html += `<th>L${i}</th>`;
            }
            html += '</tr></thead><tbody>';
            
            for (let i = 0; i < 8; i++) {
                html += `<tr><th>L${i}</th>`;
                for (let j = 0; j < 8; j++) {
                    const distance = matrix[i][j];
                    let bgColor = '';
                    
                    if (i === j) {
                        bgColor = '#ecf0f1';
                    } else if (distance >= 15) {
                        bgColor = '#d4edda';
                    } else if (distance >= 10) {
                        bgColor = '#fff3cd';
                    } else {
                        bgColor = '#f8d7da';
                    }
                    
                    html += `<td style="background: ${bgColor}; font-weight: bold;">${distance}</td>`;
                }
                html += '</tr>';
            }
            
            html += '</tbody></table>';
            
            // æ·»åŠ ç»Ÿè®¡ä¿¡æ¯
            let minDistance = Infinity;
            let maxDistance = 0;
            let totalDistance = 0;
            let count = 0;
            
            for (let i = 0; i < 8; i++) {
                for (let j = i + 1; j < 8; j++) {
                    const dist = matrix[i][j];
                    minDistance = Math.min(minDistance, dist);
                    maxDistance = Math.max(maxDistance, dist);
                    totalDistance += dist;
                    count++;
                }
            }
            
            const avgDistance = (totalDistance / count).toFixed(2);
            
            html += `
            <div class="stats-panel" style="margin-top: 20px;">
                <div class="stat-item">
                    <span class="stat-label">æœ€å°æ±‰æ˜è·ç¦»:</span>
                    <span class="stat-value" style="color: ${minDistance >= 10 ? '#2ecc71' : '#e74c3c'};">
                        ${minDistance} ${minDistance >= 10 ? 'âœ“' : 'âœ—'}
                    </span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">æœ€å¤§æ±‰æ˜è·ç¦»:</span>
                    <span class="stat-value">${maxDistance}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">å¹³å‡æ±‰æ˜è·ç¦»:</span>
                    <span class="stat-value">${avgDistance}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">ç¬¦åˆæ ‡å‡†çš„Laneå¯¹:</span>
                    <span class="stat-value">${count} / ${count} (${minDistance >= 10 ? '100%' : '0%'})</span>
                </div>
            </div>`;
            
            display.innerHTML = html;
        }

        // é«˜äº®æœ€å°è·ç¦»
        function highlightMinDistance() {
            const matrix = calculateHammingMatrix();
            let minDist = Infinity;
            let minPairs = [];
            
            for (let i = 0; i < 8; i++) {
                for (let j = i + 1; j < 8; j++) {
                    if (matrix[i][j] < minDist) {
                        minDist = matrix[i][j];
                        minPairs = [[i, j]];
                    } else if (matrix[i][j] === minDist) {
                        minPairs.push([i, j]);
                    }
                }
            }
            
            showHammingMatrix();
            
            // æ·»åŠ é«˜äº®æç¤º
            const display = document.getElementById('matrixDisplay');
            let alertHtml = `
            <div class="highlight-box" style="margin-top: 20px;">
                <strong>âš ï¸ æœ€å°æ±‰æ˜è·ç¦»åˆ†æï¼š</strong><br>
                æœ€å°æ±‰æ˜è·ç¦» = <strong style="font-size: 1.5em; color: ${minDist >= 10 ? '#2ecc71' : '#e74c3c'};">
                    ${minDist}
                </strong><br><br>
                å‡ºç°åœ¨ä»¥ä¸‹Laneå¯¹ï¼š<br>
                ${minPairs.map(pair => `<span class="info-tag ${minDist >= 10 ? 'tag-success' : 'tag-danger'}">
                    Lane ${pair[0]} â†” Lane ${pair[1]}
                </span>`).join('')}<br><br>
                <strong>è¯„ä¼°ï¼š</strong>${minDist >= 10 ? 
                    'âœ“ ç¬¦åˆIEEE 802.3bsæ ‡å‡† (æœ€å°æ±‰æ˜è·ç¦» â‰¥ 10)' : 
                    'âœ— ä¸ç¬¦åˆæ ‡å‡†ï¼Œå­˜åœ¨è¯¯è¯†åˆ«é£é™©ï¼'}
            </div>`;
            
            display.innerHTML += alertHtml;
        }

        // è®¡ç®—æ‰€æœ‰è·ç¦»
        function calculateAll() {
            showHammingMatrix();
            highlightMinDistance();
        }

        // æ¨¡æ‹Ÿè¯¯ç 
        function simulateError() {
            if (selectedLanes.length !== 2) {
                alert('è¯·å…ˆé€‰æ‹©ä¸¤ä¸ªLaneè¿›è¡Œæ¯”è¾ƒï¼');
                return;
            }
            
            const [lane1, lane2] = selectedLanes;
            const hex1 = AM_PATTERNS_64[lane1].hex.replace(/\s+/g, '');
            const hex2 = AM_PATTERNS_64[lane2].hex.replace(/\s+/g, '');
            const bin1 = hexToBinary(hex1);
            let bin2 = hexToBinary(hex2);
            
            // éšæœºå¼•å…¥3-5ä¸ªé”™è¯¯
            const errorCount = 3 + Math.floor(Math.random() * 3);
            let bin2Array = bin2.split('');
            
            const errorPositions = [];
            for (let i = 0; i < errorCount; i++) {
                let pos;
                do {
                    pos = Math.floor(Math.random() * 64);
                } while (errorPositions.includes(pos));
                
                errorPositions.push(pos);
                bin2Array[pos] = bin2Array[pos] === '0' ? '1' : '0';
            }
            
            bin2 = bin2Array.join('');
            const newDistance = calculateHammingDistance(bin1, bin2);
            
            // æ˜¾ç¤ºç»“æœ
            displayComparison(lane1, lane2, bin1, bin2, newDistance);
            
            // æ·»åŠ é”™è¯¯æç¤º
            const statsDiv = document.getElementById('statsPanel');
            statsDiv.innerHTML += `
            <div class="stat-item" style="border-left-color: #e74c3c;">
                <span class="stat-label">âš ï¸ æ¨¡æ‹Ÿè¯¯ç :</span>
                <span class="stat-value">${errorCount} bits (ä½ç½®: ${errorPositions.sort((a,b)=>a-b).join(', ')})</span>
            </div>
            <div class="stat-item" style="border-left-color: ${newDistance >= 10 ? '#2ecc71' : '#e74c3c'};">
                <span class="stat-label">è¯¯ç åæ±‰æ˜è·ç¦»:</span>
                <span class="stat-value">${newDistance} ${newDistance >= 10 ? '(ä»å¯è¯†åˆ« âœ“)' : '(å¯èƒ½è¯¯åˆ¤ âœ—)'}</span>
            </div>`;
        }

        // é‡ç½®æ¼”ç¤º
        function resetDemo() {
            selectedLanes.forEach(id => {
                document.getElementById(`lane-${id}`).classList.remove('selected');
            });
            selectedLanes = [];
            
            document.getElementById('hammingResult').style.display = 'none';
            document.getElementById('matrixDisplay').innerHTML = '';
        }

        // é¡µé¢åŠ è½½åˆå§‹åŒ–
        window.addEventListener('load', () => {
            initAMCards();
            
            // æ·»åŠ æ·¡å…¥åŠ¨ç”»
            const sections = document.querySelectorAll('.theory-section, .demo-section');
            sections.forEach((section, index) => {
                section.style.opacity = '0';
                section.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    section.style.transition = 'all 0.6s ease';
                    section.style.opacity = '1';
                    section.style.transform = 'translateY(0)';
                }, index * 150);
            });
        });
    </script>
</body>
</html>